{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\reports\\ReportMarketplacePicker.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\reports\\ReportMarketplacePicker.vue","mtime":1639556629293},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1620898435163},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.array.find\";\nimport _defineProperty from \"C:/Project/CBPO/plat-mw-web/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _objectSpread2;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport _ from 'lodash';\nimport { mapActions, mapGetters } from 'vuex';\nimport vToasted from '@/shared/notification';\nimport VueTagsInput from '@johmun/vue-tags-input';\nimport Datepicker from 'vuejs-datepicker';\nimport * as moment from 'moment/moment';\nimport { MarketPlacesResult } from '@/constants/Report';\nimport * as TYPE from '@/actionTypes.js';\nimport PermissionsMixin from '@/components/common/PermissionsMixin';\nexport default {\n  name: 'MWReportMarketplacePicker',\n  data: function data() {\n    return {\n      MarketPlacesResult: MarketPlacesResult,\n      listUniqGoogleShoppingMarketplace: [],\n      fields: [// A column that needs custom formatting\n      {\n        key: 'marketplace',\n        label: 'Marketplace'\n      }, {\n        key: 'file_in_use',\n        label: 'File in Use'\n      }, {\n        key: 'date_started',\n        label: 'Date Started'\n      }, {\n        key: 'all_seller_mode',\n        label: 'All Seller Mode'\n      }, {\n        key: 'action',\n        label: ''\n      }],\n      allSellerModeOptions: [{\n        value: 'none',\n        text: 'None'\n      }, {\n        value: 'authorized_only',\n        text: 'Authorized Only'\n      }, {\n        value: 'rogue_only',\n        text: 'Rogue Only'\n      }, {\n        value: 'both',\n        text: 'Both'\n      }],\n      marketplaces: {\n        amazon_com: false,\n        amazon_ca: false,\n        amazon_co_uk: false,\n        amazon_de: false,\n        amazon_fr: false,\n        amazon_it: false,\n        amazon_es: false,\n        amazon_nl: false,\n        amazon_co_jp: false,\n        amazon_in: false,\n        amazon_com_au: false,\n        amazon_sg: false,\n        amazon_ae: false,\n        amazon_com_tr: false,\n        amazon_com_mx: false,\n        amazon_com_br: false,\n        google_shopping: false\n      },\n      marketplaceItems: [],\n      removedMarketplace: [],\n      parsedData: {}\n    };\n  },\n  mixins: [vToasted, PermissionsMixin],\n  props: {\n    reportDoc: Object,\n    isValidMarketplace: Boolean\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters({\n    planConfig: \"mw/\".concat(TYPE.GET_PLAN_CONFIG)\n  })), {}, {\n    listUniqAmazonMarketplace: function listUniqAmazonMarketplace() {\n      if (_.isEmpty(this.planConfig)) return [];\n      var listAmazon = this.planConfig.allowed_amazon_marketplaces.map(function (item) {\n        return {\n          value: item,\n          text: _.upperFirst(item)\n        };\n      });\n      return _.sortBy(listAmazon, ['value']);\n    },\n    listUniqAllMarketplace: function listUniqAllMarketplace() {\n      return _.concat(this.listUniqAmazonMarketplace, this.listUniqGoogleShoppingMarketplace);\n    },\n    amazonMarketPlaceList: function amazonMarketPlaceList() {\n      var _this = this;\n\n      return this.listUniqAmazonMarketplace.filter(function (item) {\n        return !_this.marketplaceItems.find(function (mkItem) {\n          return mkItem.marketplace.value === item.value;\n        });\n      });\n    },\n    googleShoppingMarketplaceList: function googleShoppingMarketplaceList() {\n      var _this2 = this;\n\n      return this.listUniqGoogleShoppingMarketplace.filter(function (item) {\n        return !_this2.marketplaceItems.find(function (mkItem) {\n          return mkItem.marketplace.value === item.value;\n        });\n      });\n    }\n  }),\n  methods: _objectSpread(_objectSpread({}, mapActions({})), {}, (_objectSpread2 = {\n    /* eslint-disable */\n    insertMarketplace: function insertMarketplace(marketplace) {\n      var alreadyExist = _.find(this.marketplaceItems, function (o) {\n        return o.marketplace.value === marketplace;\n      });\n\n      if (!alreadyExist) {\n        var marketplaceDoc = _.find(this.listUniqAllMarketplace, {\n          value: marketplace\n        });\n\n        this.marketplaceItems.push({\n          marketplace: marketplaceDoc,\n          file_in_use: '',\n          date_started: '',\n          all_seller_mode: 'none',\n          action: false\n        });\n      }\n\n      this.autoEnableWhenSelectMarketplace(marketplace, true);\n    },\n    autoEnableWhenSelectMarketplace: function autoEnableWhenSelectMarketplace(marketplace, action) {\n      this.marketplaces[marketplace.replace(/[.]/g, '_')] = action;\n    },\n    buildMarketplaceInfo: function buildMarketplaceInfo(fileInUse, dateStarted, all_seller_mode) {\n      return {\n        file_in_use: fileInUse,\n        date_started: dateStarted ? moment(dateStarted).format('MM/DD/YYYY') : '',\n        all_seller_mode: all_seller_mode\n      };\n    },\n    removeMarketplace: function removeMarketplace(marketplace) {\n      this.marketplaceItems = _.remove(this.marketplaceItems, function (o) {\n        return o.marketplace.value !== marketplace;\n      });\n      this.autoEnableWhenSelectMarketplace(marketplace, false);\n    },\n    isAmazonMarketplace: function isAmazonMarketplace(marketplace) {\n      return _.includes(marketplace, 'amazon');\n    },\n    getMarketplaceField: function getMarketplaceField(marketplace) {\n      return \"marketplace_\".concat(marketplace.replace(/[.]/g, '_'));\n    },\n    convertMarketplaceKeyToField: function convertMarketplaceKeyToField(marketplace) {\n      return marketplace.replace(/[_]/g, '.');\n    },\n    findMarketplaceFromListUnique: function findMarketplaceFromListUnique(marketplace) {\n      var _this3 = this;\n\n      return _.find(this.listUniqAllMarketplace, function (data) {\n        if (_this3.isAmazonMarketplace(marketplace)) {\n          return data.value === _this3.convertMarketplaceKeyToField(marketplace);\n        } else if (_this3.isGoogleShoppingMarketplace(marketplace)) {\n          return data.value === MarketPlacesResult.GOOGLE_SHOPPING;\n        }\n      });\n    }\n  }, _defineProperty(_objectSpread2, \"isAmazonMarketplace\", function isAmazonMarketplace(marketplace) {\n    return _.includes(marketplace, 'amazon');\n  }), _defineProperty(_objectSpread2, \"isGoogleShoppingMarketplace\", function isGoogleShoppingMarketplace(marketplace) {\n    return _.includes(marketplace, 'google');\n  }), _defineProperty(_objectSpread2, \"syncMarketplaceItems\", function syncMarketplaceItems(doc) {\n    var _this4 = this;\n\n    if (!doc.marketplaces) {\n      return;\n    }\n\n    var marketplaceKeys = _.keys(doc.marketplaces);\n\n    var values = _.values(MarketPlacesResult);\n\n    _.forEach(marketplaceKeys, function (marketplaceKey) {\n      var marketplaceField = _.includes(marketplaceKey, 'amazon') ? _this4.convertMarketplaceKeyToField(marketplaceKey) : marketplaceKey;\n\n      if (doc.marketplaces[marketplaceKey] && _.includes(values, marketplaceField)) {\n        _this4.marketplaces[marketplaceKey] = true;\n\n        var _marketplaceField = _this4.getMarketplaceField(marketplaceKey);\n\n        var marketplaceInfo = doc[_marketplaceField];\n\n        if (marketplaceInfo) {\n          var file_in_use = marketplaceInfo.file_in_use,\n              date_started = marketplaceInfo.date_started,\n              _all_seller_mode = marketplaceInfo.all_seller_mode;\n\n          _this4.marketplaceItems.push({\n            marketplace: _this4.findMarketplaceFromListUnique(marketplaceKey),\n            file_in_use: file_in_use,\n            date_started: date_started,\n            action: '',\n            all_seller_mode: _all_seller_mode || 'none'\n          });\n        } else {\n          _this4.marketplaceItems.push({\n            marketplace: _this4.findMarketplaceFromListUnique(marketplaceKey),\n            file_in_use: '',\n            date_started: '',\n            action: '',\n            all_seller_mode: all_seller_mode || 'none'\n          });\n        }\n      }\n    });\n  }), _defineProperty(_objectSpread2, \"convertData\", function convertData() {\n    var _this5 = this;\n\n    _.forEach(this.marketplaceItems, function (marketplaceItem) {\n      var marketplaceInfo = _this5.getMarketplaceField(marketplaceItem.marketplace.value);\n\n      var file_in_use = marketplaceItem.file_in_use,\n          date_started = marketplaceItem.date_started,\n          all_seller_mode = marketplaceItem.all_seller_mode;\n\n      _.assign(_this5.parsedData, _defineProperty({}, marketplaceInfo, _this5.buildMarketplaceInfo(file_in_use, date_started, all_seller_mode)));\n    });\n  }), _objectSpread2)),\n  created: function created() {\n    var _this6 = this;\n\n    var marketplaceValues = _.values(MarketPlacesResult);\n\n    _.forEach(marketplaceValues, function (marketplaceValue) {\n      if (_.includes(marketplaceValue, 'google')) {\n        _this6.listUniqGoogleShoppingMarketplace.push({\n          value: marketplaceValue,\n          text: 'Google Shopping'\n        });\n      }\n    });\n\n    if (this.reportDoc) {\n      this.syncMarketplaceItems(this.reportDoc); // this.$watch('reportDoc', (val) =>\n      //   {\n      //     this.marketplaceItems = []\n      //     this.syncMarketplaceItems(val)\n      //   }\n      // )\n    }\n  },\n  components: {\n    VueTagsInput: VueTagsInput,\n    Datepicker: Datepicker\n  },\n  watch: {\n    marketplaceItems: {\n      deep: true,\n      handler: function handler(val) {\n        this.convertData();\n        this.$emit('marketplaceChange', {\n          parsedData: this.parsedData,\n          marketplaces: this.marketplaces\n        });\n      }\n    },\n    reportDoc: {\n      handler: function handler(val) {\n        this.marketplaceItems = [];\n        this.syncMarketplaceItems(val);\n      }\n    }\n  }\n};",{"version":3,"sources":["ReportMarketplacePicker.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <b-form-group>\r\n    <b-table\r\n      class=\"table-marketplace\"\r\n      show-empty\r\n      :fields=\"fields\"\r\n      :items=\"marketplaceItems\"\r\n      striped\r\n      bordered\r\n      responsive=\"sm\"\r\n      hover\r\n      collapsed\r\n      fixed\r\n      style=\"overflow: visible !important\"\r\n    >\r\n      <!-- A custom formatted data column cell -->\r\n      <template v-slot:empty>\r\n        <div class=\"text-center\">No Marketplace</div>\r\n      </template>\r\n      <template v-slot:cell(marketplace)=\"row\" class=\"pl-0\">\r\n        <b-form-input\r\n          type=\"text\"\r\n          disabled\r\n          class=\"bg-white\"\r\n          :value=\"row.item.marketplace.text\"\r\n        ></b-form-input>\r\n      </template>\r\n      <template v-slot:cell(file_in_use)=\"row\">\r\n        <b-form-input\r\n          type=\"text\"\r\n          required\r\n          v-model.trim=\"row.item.file_in_use\"\r\n        ></b-form-input>\r\n      </template>\r\n      <template v-slot:cell(date_started)=\"row\" class=\"pr-0\">\r\n        <Datepicker\r\n          v-model=\"row.item.date_started\"\r\n          bootstrap-styling\r\n          format=\"MM/dd/yyyy\"\r\n          typeable\r\n          placeholder=\"Select a date\"\r\n        >\r\n        </Datepicker>\r\n      </template>\r\n      <template v-slot:cell(all_seller_mode)=\"row\" class=\"pr-0\">\r\n        <b-form-select\r\n          v-model=\"row.item.all_seller_mode\"\r\n          :options=\"allSellerModeOptions\"\r\n        ></b-form-select>\r\n      </template>\r\n      <template v-slot:cell(action)=\"row\">\r\n        <b-button\r\n          variant=\"danger\"\r\n          @click=\"removeMarketplace(row.item.marketplace.value)\"\r\n          size=\"md\"\r\n          class=\"white text-center w-auto text-nowrap\"\r\n          ><i class=\"fa fa-minus\"> </i> Remove</b-button\r\n        >\r\n      </template>\r\n    </b-table>\r\n    <div class=\"w-100 add-marketplace p-2 d-flex justify-content-between\">\r\n      <div class=\"mw-error\"  v-if=\"isValidMarketplace && marketplaceItems.length === 0\">\r\n        Please input at least one marketplace\r\n      </div>\r\n      <b-dropdown id=\"dropdown-1\" variant=\"primary\" size=\"md\" class=\"ml-auto\" :disabled=\"amazonMarketPlaceList.length === 0 && googleShoppingMarketplaceList.length === 0\">\r\n        <template v-slot:button-content>\r\n          <i class=\"fa fa-plus\"></i> Add\r\n        </template>\r\n        <template v-if=\"planConfig.allowed_amazon_marketplaces.length || planConfig.plan_max_of_reports_with_amazon > 0\">\r\n          <b-dropdown-item @click=\"insertMarketplace(item.value)\" v-for=\"item in amazonMarketPlaceList\"\r\n            v-bind:key=\"item.value\"\r\n            class=\"mt-2\">\r\n            {{ item.text }}\r\n          </b-dropdown-item>\r\n        </template>\r\n        <b-dropdown-divider v-if=\"planConfig.allowed_amazon_marketplaces.length && planConfig.plan_max_of_reports_with_google_shopping > 0\"></b-dropdown-divider>\r\n        <template v-if=\"planConfig.plan_max_of_reports_with_google_shopping > 0\">\r\n          <b-dropdown-item\r\n            @click=\"insertMarketplace(item.value)\"\r\n            v-for=\"item in googleShoppingMarketplaceList\"\r\n            v-bind:key=\"item.value\"\r\n            class=\"mt-2\">\r\n            {{ item.text }}\r\n          </b-dropdown-item>\r\n        </template>\r\n      </b-dropdown>\r\n    </div>\r\n  </b-form-group>\r\n</template>\r\n<script>\r\nimport _ from 'lodash'\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport vToasted from '@/shared/notification'\r\nimport VueTagsInput from '@johmun/vue-tags-input'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport * as moment from 'moment/moment'\r\nimport { MarketPlacesResult } from '@/constants/Report'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport PermissionsMixin from '@/components/common/PermissionsMixin'\r\n\r\nexport default {\r\n  name: 'MWReportMarketplacePicker',\r\n  data() {\r\n    return {\r\n      MarketPlacesResult,\r\n      listUniqGoogleShoppingMarketplace: [],\r\n      fields: [\r\n        // A column that needs custom formatting\r\n        { key: 'marketplace', label: 'Marketplace' },\r\n        { key: 'file_in_use', label: 'File in Use' },\r\n        { key: 'date_started', label: 'Date Started' },\r\n        { key: 'all_seller_mode', label: 'All Seller Mode' },\r\n        { key: 'action', label: '' }\r\n      ],\r\n      allSellerModeOptions: [\r\n        { value: 'none', text: 'None' },\r\n        { value: 'authorized_only', text: 'Authorized Only' },\r\n        { value: 'rogue_only', text: 'Rogue Only' },\r\n        { value: 'both', text: 'Both' }\r\n      ],\r\n      marketplaces: {\r\n        amazon_com: false,\r\n        amazon_ca: false,\r\n        amazon_co_uk: false,\r\n        amazon_de: false,\r\n        amazon_fr: false,\r\n        amazon_it: false,\r\n        amazon_es: false,\r\n        amazon_nl: false,\r\n        amazon_co_jp: false,\r\n        amazon_in: false,\r\n        amazon_com_au: false,\r\n        amazon_sg: false,\r\n        amazon_ae: false,\r\n        amazon_com_tr: false,\r\n        amazon_com_mx: false,\r\n        amazon_com_br: false,\r\n        google_shopping: false\r\n      },\r\n      marketplaceItems: [],\r\n      removedMarketplace: [],\r\n      parsedData: {}\r\n    }\r\n  },\r\n  mixins: [vToasted, PermissionsMixin],\r\n  props: {\r\n    reportDoc: Object,\r\n    isValidMarketplace: Boolean\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      planConfig: `mw/${TYPE.GET_PLAN_CONFIG}`\r\n    }),\r\n    listUniqAmazonMarketplace() {\r\n      if (_.isEmpty(this.planConfig)) return []\r\n      let listAmazon = this.planConfig.allowed_amazon_marketplaces.map(item => {\r\n        return {\r\n          value: item,\r\n          text: _.upperFirst(item)\r\n        }\r\n      })\r\n      return _.sortBy(listAmazon, ['value'])\r\n    },\r\n    listUniqAllMarketplace() {\r\n      return _.concat(this.listUniqAmazonMarketplace, this.listUniqGoogleShoppingMarketplace)\r\n    },\r\n    amazonMarketPlaceList() {\r\n      return this.listUniqAmazonMarketplace.filter(\r\n        (item) =>\r\n          !this.marketplaceItems.find(\r\n            (mkItem) => mkItem.marketplace.value === item.value\r\n          )\r\n      )\r\n    },\r\n    googleShoppingMarketplaceList() {\r\n      return this.listUniqGoogleShoppingMarketplace.filter(\r\n        (item) =>\r\n          !this.marketplaceItems.find(\r\n            (mkItem) => mkItem.marketplace.value === item.value\r\n          )\r\n      )\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions({}),\r\n    /* eslint-disable */\r\n    insertMarketplace(marketplace) {\r\n      const alreadyExist = _.find(this.marketplaceItems, function (o) {\r\n        return o.marketplace.value === marketplace\r\n      })\r\n      if (!alreadyExist) {\r\n        const marketplaceDoc = _.find(this.listUniqAllMarketplace, {\r\n          value: marketplace\r\n        })\r\n        this.marketplaceItems.push({\r\n          marketplace: marketplaceDoc,\r\n          file_in_use: '',\r\n          date_started: '',\r\n          all_seller_mode: 'none',\r\n          action: false\r\n        })\r\n      }\r\n      this.autoEnableWhenSelectMarketplace(marketplace, true)\r\n    },\r\n    autoEnableWhenSelectMarketplace(marketplace, action) {\r\n      this.marketplaces[marketplace.replace(/[.]/g, '_')] = action\r\n    },\r\n    buildMarketplaceInfo(fileInUse, dateStarted, all_seller_mode) {\r\n      return {\r\n        file_in_use: fileInUse,\r\n        date_started: dateStarted\r\n          ? moment(dateStarted).format('MM/DD/YYYY')\r\n          : '',\r\n        all_seller_mode: all_seller_mode\r\n      }\r\n    },\r\n    removeMarketplace(marketplace) {\r\n      this.marketplaceItems = _.remove(this.marketplaceItems, function (o) {\r\n        return o.marketplace.value !== marketplace\r\n      })\r\n      this.autoEnableWhenSelectMarketplace(marketplace, false)\r\n    },\r\n    isAmazonMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'amazon')\r\n    },\r\n    getMarketplaceField(marketplace) {\r\n      return `marketplace_${marketplace.replace(/[.]/g, '_')}`\r\n    },\r\n    convertMarketplaceKeyToField(marketplace) {\r\n      return marketplace.replace(/[_]/g, '.')\r\n    },\r\n    findMarketplaceFromListUnique(marketplace) {\r\n      return _.find(this.listUniqAllMarketplace, (data) => {\r\n        if (this.isAmazonMarketplace(marketplace)) {\r\n          return data.value === this.convertMarketplaceKeyToField(marketplace)\r\n        } else if (this.isGoogleShoppingMarketplace(marketplace)) {\r\n          return data.value === MarketPlacesResult.GOOGLE_SHOPPING\r\n        }\r\n      })\r\n    },\r\n    isAmazonMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'amazon')\r\n    },\r\n    isGoogleShoppingMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'google')\r\n    },\r\n    syncMarketplaceItems(doc) {\r\n      if (!doc.marketplaces) {\r\n        return\r\n      }\r\n      const marketplaceKeys = _.keys(doc.marketplaces)\r\n      const values = _.values(MarketPlacesResult)\r\n      _.forEach(marketplaceKeys, (marketplaceKey) => {\r\n        const marketplaceField = _.includes(marketplaceKey, 'amazon')\r\n          ? this.convertMarketplaceKeyToField(marketplaceKey)\r\n          : marketplaceKey\r\n        if (\r\n          doc.marketplaces[marketplaceKey] &&\r\n          _.includes(values, marketplaceField)\r\n        ) {\r\n          this.marketplaces[marketplaceKey] = true\r\n          const marketplaceField = this.getMarketplaceField(marketplaceKey)\r\n          const marketplaceInfo = doc[marketplaceField]\r\n          if (marketplaceInfo) {\r\n            const {\r\n              file_in_use,\r\n              date_started,\r\n              all_seller_mode\r\n            } = marketplaceInfo\r\n            this.marketplaceItems.push({\r\n              marketplace: this.findMarketplaceFromListUnique(marketplaceKey),\r\n              file_in_use: file_in_use,\r\n              date_started: date_started,\r\n              action: '',\r\n              all_seller_mode: all_seller_mode || 'none'\r\n            })\r\n          } else {\r\n            this.marketplaceItems.push({\r\n              marketplace: this.findMarketplaceFromListUnique(marketplaceKey),\r\n              file_in_use: '',\r\n              date_started: '',\r\n              action: '',\r\n              all_seller_mode: all_seller_mode || 'none'\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    convertData() {\r\n      _.forEach(this.marketplaceItems, (marketplaceItem) => {\r\n        const marketplaceInfo = this.getMarketplaceField(\r\n          marketplaceItem.marketplace.value\r\n        )\r\n        const {\r\n          file_in_use,\r\n          date_started,\r\n          all_seller_mode\r\n        } = marketplaceItem\r\n        _.assign(this.parsedData, {\r\n          [marketplaceInfo]: this.buildMarketplaceInfo(\r\n            file_in_use,\r\n            date_started,\r\n            all_seller_mode\r\n          )\r\n        })\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    const marketplaceValues = _.values(MarketPlacesResult)\r\n    _.forEach(marketplaceValues, (marketplaceValue) => {\r\n      if (_.includes(marketplaceValue, 'google')) {\r\n        this.listUniqGoogleShoppingMarketplace.push({\r\n          value: marketplaceValue,\r\n          text: 'Google Shopping'\r\n        })\r\n      }\r\n    })\r\n    if (this.reportDoc) {\r\n      this.syncMarketplaceItems(this.reportDoc)\r\n      // this.$watch('reportDoc', (val) =>\r\n      //   {\r\n      //     this.marketplaceItems = []\r\n      //     this.syncMarketplaceItems(val)\r\n      //   }\r\n      // )\r\n    }\r\n  },\r\n  components: {\r\n    VueTagsInput,\r\n    Datepicker\r\n  },\r\n  watch: {\r\n    marketplaceItems: {\r\n      deep: true,\r\n      handler(val) {\r\n        this.convertData()\r\n        this.$emit('marketplaceChange', {\r\n          parsedData: this.parsedData,\r\n          marketplaces: this.marketplaces\r\n        })\r\n      }\r\n    },\r\n    reportDoc: {\r\n      handler(val) {\r\n        this.marketplaceItems = []\r\n        this.syncMarketplaceItems(val)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.table-marketplace {\r\n  &::v-deep {\r\n    overflow: visible;\r\n    margin-bottom: 0px;\r\n    tbody tr td {\r\n      background: white;\r\n    }\r\n    tbody tr td:nth-child(5) {\r\n      text-align: center;\r\n    }\r\n    tfoot tr {\r\n      th {\r\n        &:not(:last-child) {\r\n          border-right: none !important;\r\n        }\r\n        &:not(:first-child) {\r\n          border-left: none !important;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n::v-deep .add-marketplace {\r\n  text-align: right;\r\n  border: 1px solid #c8ced3;\r\n  border-top: none;\r\n}\r\n::v-deep .vdp-datepicker__calendar {\r\n  position: absolute !important;\r\n}\r\n::v-deep ul {\r\n  max-height: 350px;\r\n  overflow: auto;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/page/reports"}]}