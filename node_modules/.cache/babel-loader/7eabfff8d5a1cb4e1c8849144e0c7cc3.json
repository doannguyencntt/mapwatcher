{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\settings\\Setting.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\settings\\Setting.vue","mtime":1639556685436},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1620898435163},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:/Project/CBPO/plat-mw-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:/Project/CBPO/plat-mw-web/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport _nav from '@/_nav';\nimport * as TYPE from '@/actionTypes.js';\nimport vToasted from '@/shared/notification';\nimport { mapActions, mapGetters } from 'vuex';\nimport PermissionsMixin from '@/components/common/PermissionsMixin';\nimport reportLogo from '@/assets/img/report-demo.jpg';\nimport PolicyNotificationModal from \"./PolicyNotificationModal.vue\";\nimport get from 'lodash/get';\nexport default {\n  components: {\n    PolicyNotificationModal: PolicyNotificationModal\n  },\n  data: function data() {\n    return {\n      reportLogo: reportLogo,\n      isLoading: false,\n      data: {\n        show_dashboard: true,\n        si_listing_brand_name: '',\n        default_brand_logo: '',\n        map_pricing_policy_document: {\n          url: '',\n          file_name: ''\n        }\n      },\n      originData: {},\n      nav: _nav,\n      policyModalID: 'policy-sending-confirmation',\n      policyUpdated: false\n    };\n  },\n  mixins: [vToasted, PermissionsMixin],\n  methods: _objectSpread(_objectSpread({}, mapActions({\n    remoteFetchSetting: \"mw/settings/\".concat(TYPE.FETCH_SETTING),\n    remoteUpdateSetting: \"mw/settings/\".concat(TYPE.REMOTE_EDIT_SETTING),\n    remoteImagesFileUpload: \"mw/images/\".concat(TYPE.REMOTE_UPLOAD_IMAGES),\n    remoteFileUpload: \"mw/settings/\".concat(TYPE.REMOTE_UPLOAD_FILES)\n  })), {}, {\n    handleImagesFileUpload: function () {\n      var _handleImagesFileUpload = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(e) {\n        var formData, res, message;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.isLoading = true;\n                formData = new FormData();\n                formData.append('file', e.target.files[0]);\n                formData.append('type', 'brand_logos');\n                _context.prev = 4;\n                _context.next = 7;\n                return this.remoteImagesFileUpload(formData);\n\n              case 7:\n                res = _context.sent;\n                this.data.default_brand_logo = res.url;\n                this.vToasted('success', \"Your file is uploaded successfully.\");\n                _context.next = 16;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](4);\n                message = get(_context.t0, 'response.data.message', null);\n\n                if (message) {\n                  this.vToasted('error', message);\n                } else {\n                  console.log(_context.t0);\n                }\n\n              case 16:\n                this.isLoading = false;\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[4, 12]]);\n      }));\n\n      function handleImagesFileUpload(_x) {\n        return _handleImagesFileUpload.apply(this, arguments);\n      }\n\n      return handleImagesFileUpload;\n    }(),\n    handleUploadMapPricingPolicyDocument: function () {\n      var _handleUploadMapPricingPolicyDocument = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(e) {\n        var formData, res, url, file_name, message;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.isLoading = true;\n                formData = new FormData();\n                formData.append('file', e.target.files[0]);\n                formData.append('type', 'map_pricing_policy_document');\n                _context2.prev = 4;\n                _context2.next = 7;\n                return this.remoteFileUpload(formData);\n\n              case 7:\n                res = _context2.sent;\n                // eslint-disable-next-line\n                url = res.url, file_name = res.file_name;\n                this.data.map_pricing_policy_document.url = url; // eslint-disable-next-line\n\n                this.data.map_pricing_policy_document.file_name = file_name;\n                this.vToasted('success', \"Your file is uploaded successfully.\");\n                _context2.next = 18;\n                break;\n\n              case 14:\n                _context2.prev = 14;\n                _context2.t0 = _context2[\"catch\"](4);\n                message = get(_context2.t0, 'response.data.message', null);\n\n                if (message) {\n                  this.vToasted('error', message);\n                } else {\n                  console.log(_context2.t0);\n                }\n\n              case 18:\n                this.isLoading = false;\n\n              case 19:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[4, 14]]);\n      }));\n\n      function handleUploadMapPricingPolicyDocument(_x2) {\n        return _handleUploadMapPricingPolicyDocument.apply(this, arguments);\n      }\n\n      return handleUploadMapPricingPolicyDocument;\n    }(),\n    removeLogo: function removeLogo() {\n      this.data.default_brand_logo = '';\n    },\n    removePolicyFile: function removePolicyFile() {\n      this.data.map_pricing_policy_document.url = '';\n      this.data.map_pricing_policy_document.file_name = '';\n      this.$refs.policyFileInput.reset();\n    },\n    downloadFile: function downloadFile() {\n      window.location.href = this.data.map_pricing_policy_document.url;\n    },\n    formatNames: function formatNames(files) {\n      var name = files[0].name;\n      return name.length > 20 ? \"\".concat(name.substr(0, 15), \"...\") : name;\n    },\n    handleUpdateSetting: function () {\n      var _handleUpdateSetting = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var client_id, message;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this.isLoading = true;\n                _context3.prev = 1;\n\n                /* eslint-disable */\n                client_id = this.$route.params.client_id;\n                _context3.next = 5;\n                return this.remoteUpdateSetting({\n                  params: this.data,\n                  client_id: client_id\n                });\n\n              case 5:\n                this.vToasted('success', \"Settings have been updated successfully.\");\n                this.policyUpdated = true;\n                _context3.next = 13;\n                break;\n\n              case 9:\n                _context3.prev = 9;\n                _context3.t0 = _context3[\"catch\"](1);\n                message = get(_context3.t0, 'response.data.message', null);\n\n                if (message) {\n                  this.vToasted('error', message);\n                } else {\n                  console.log(_context3.t0);\n                }\n\n              case 13:\n                this.isLoading = false;\n\n              case 14:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[1, 9]]);\n      }));\n\n      function handleUpdateSetting() {\n        return _handleUpdateSetting.apply(this, arguments);\n      }\n\n      return handleUpdateSetting;\n    }(),\n    handleFetchAndReloadData: function () {\n      var _handleFetchAndReloadData = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var client_id, result, message;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.isLoading = true;\n                _context4.prev = 1;\n\n                /* eslint-disable */\n                client_id = this.$route.params.client_id;\n                _context4.next = 5;\n                return this.remoteFetchSetting({\n                  client_id: client_id\n                });\n\n              case 5:\n                result = _context4.sent;\n                this.data.show_dashboard = result.show_dashboard;\n                this.data.si_listing_brand_name = result.si_listing_brand_name;\n                this.data.default_brand_logo = result.default_brand_logo;\n                this.data.map_pricing_policy_document.url = result.map_pricing_policy_document.url;\n                this.data.map_pricing_policy_document.file_name = result.map_pricing_policy_document.file_name; // backup originData\n\n                this.originData = JSON.parse(JSON.stringify(this.data));\n                _context4.next = 18;\n                break;\n\n              case 14:\n                _context4.prev = 14;\n                _context4.t0 = _context4[\"catch\"](1);\n                message = get(_context4.t0, 'response.data.message', null);\n\n                if (message) {\n                  this.vToasted('error', message);\n                } else {\n                  console.log(_context4.t0);\n                }\n\n              case 18:\n                this.isLoading = false;\n\n              case 19:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[1, 14]]);\n      }));\n\n      function handleFetchAndReloadData() {\n        return _handleFetchAndReloadData.apply(this, arguments);\n      }\n\n      return handleFetchAndReloadData;\n    }()\n  }),\n  computed: _objectSpread(_objectSpread({}, mapGetters({\n    getPermissions: \"mw/\".concat(TYPE.GET_PERMISSIONS),\n    // defaultParams: `mw/reports/${TYPE.GET_DEFAULT_PARAMS}`,\n    planConfig: \"mw/\".concat(TYPE.GET_PLAN_CONFIG)\n  })), {}, {\n    capitalize: function capitalize() {\n      return function (str) {\n        return str[0].toUpperCase() + str.slice(1);\n      };\n    },\n    // params: function() {\n    //   return {...this.defaultParams} || {}\n    // },\n    newPolicyUploaded: function newPolicyUploaded() {\n      return this.data.map_pricing_policy_document.url !== this.originData.map_pricing_policy_document.url;\n    }\n  }),\n  created: function created() {\n    this.handleFetchAndReloadData();\n  }\n};",{"version":3,"sources":["Setting.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"animated fadeIn\">\r\n    <b-row>\r\n      <b-col md=\"6\" lg=\"6\" sm=\"12\">\r\n        <b-card footer-tag=\"footer\">\r\n          <div slot=\"header\" class=\"d-flex justify-content-between align-items-center\">\r\n            <span><strong>Edit Settings</strong></span>\r\n          </div>\r\n          <b-form>\r\n            <b-row>\r\n              <b-col md=\"4\" lg=\"4\" sm=\"8\">\r\n                <b-form-group>\r\n                  <label for=\"#\">\r\n                    <b>Show dashboard</b>\r\n                  </label>\r\n                </b-form-group>\r\n              </b-col>\r\n              <b-col md=\"2\" lg=\"2\" sm=\"4\">\r\n                <div class=\"d-flex flex-row\">\r\n                  <b-form-checkbox\r\n                          v-model=\"data.show_dashboard\"\r\n                          class=\"mr-4 font-weight-light\"\r\n                          :disabled=\"getPermissions.role !== 'admin' && getPermissions.role !== 'owner'\"\r\n                          switch\r\n                  ></b-form-checkbox>\r\n                </div>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row>\r\n              <b-col md=\"12\">\r\n                <b-form-group>\r\n                  <label>\r\n                    <b>Default report logo</b>\r\n                  </label>\r\n                  <b-row class=\"align-items-center\">\r\n                    <b-col md=\"2\">\r\n                      <img\r\n                              :src=\"data.default_brand_logo ? data.default_brand_logo : reportLogo\"\r\n                              class=\"mw-img-report my-1 img-thumbnail mx-auto d-block\"\r\n                              alt=\"Left image\"\r\n                      />\r\n                      <b-button\r\n                              size=\"sm\"\r\n                              variant=\"warning\"\r\n                              v-if=\"data.default_brand_logo\"\r\n                              @click=\"removeLogo()\"\r\n                              class=\"d-block mx-auto btn-remove\"\r\n                      >\r\n                        Remove\r\n                      </b-button>\r\n                    </b-col>\r\n                    <b-col md=\"10\">\r\n                      <b-form-file ref=\"file-input\" @change=\"handleImagesFileUpload($event)\"></b-form-file>\r\n                    </b-col>\r\n                  </b-row>\r\n                </b-form-group>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row v-if=\"planConfig.seller_investigation_dashboard\" class=\"seller_investigation_dashboard\">\r\n              <b-col md=\"5\" lg=\"5\" sm=\"12\">\r\n                <b-form-group>\r\n                  <label for=\"#\">\r\n                    <b>Sellers & Investigations Listing Brand Name</b>\r\n                  </label>\r\n                </b-form-group>\r\n              </b-col>\r\n              <b-col md=\"7\" lg=\"7\" sm=\"10\">\r\n                <div class=\"d-flex flex-row\">\r\n                  <b-form-input\r\n                          v-model=\"data.si_listing_brand_name\"\r\n                          class=\"font-weight-light\"\r\n                  ></b-form-input>\r\n                </div>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row v-if=\"planConfig.seller_enforcement_enabled\" class=\"seller_enforcement_enabled\">\r\n              <b-col md=\"12\">\r\n                <b-form-group>\r\n                  <b-row>\r\n                    <b-col md=\"5\">\r\n                      <label>\r\n                        <b>Map Pricing Policy Document</b>\r\n                        <div class=\"mw-error ml-0\">This file will be attached to the Seller Enforcement violation emails.</div>\r\n                      </label>\r\n                    </b-col>\r\n                    <b-col md=\"7\">\r\n                      <b>Update new policy document</b>\r\n                      <b-form-file ref=\"policyFileInput\" class=\"mt-2\" :file-name-formatter=\"formatNames\" @change=\"handleUploadMapPricingPolicyDocument($event)\" placeholder=\"Select new file\"></b-form-file>\r\n                    </b-col>\r\n                  </b-row>\r\n                  <b-row>\r\n                    <b-col md=\"5\" class=\"mt-2\" v-if=\"data.map_pricing_policy_document && data.map_pricing_policy_document.url && data.map_pricing_policy_document.url !== ''\">\r\n                      Current file <u @click=\"downloadFile()\" class=\"pointer\">{{ data.map_pricing_policy_document.file_name }}</u>\r\n                    </b-col>\r\n                    <b-col md=\"7\" class=\"text-right\" v-if=\"data.map_pricing_policy_document && data.map_pricing_policy_document.url && data.map_pricing_policy_document.url !== ''\">\r\n                      <b-button size=\"sm\" class=\"mt-2 ml-1\" @click=\"downloadFile()\" :disabled=\"isLoading\"><i class=\"fa fa-download\" /> Download</b-button>\r\n                      <b-button size=\"sm\" class=\"mt-2 ml-1\" v-b-modal.remove-file-modal :disabled=\"isLoading\"><i class=\"fa fa-trash\" /> Remove</b-button>\r\n                      <span\r\n                        id=\"policy-control-button\"\r\n                        class=\"d-inline-block\"\r\n                        tabindex=\"0\"\r\n                        v-b-tooltip.hover=\"{disabled: policyUpdated}\"\r\n                        title=\"Please save your settings first!\"\r\n                      >\r\n                        <b-button\r\n                          v-b-modal=\"policyModalID\"\r\n                          class=\"btn-sm mt-2 ml-1\"\r\n                          target=\"_self\"\r\n                          :disabled=\"(newPolicyUploaded && !policyUpdated) || isLoading\"\r\n                          title=\"Send Email\"\r\n                        >\r\n                          <i class=\"fa fa-paper-plane\" /> Notify\r\n                        </b-button>\r\n                      </span>\r\n                    </b-col>\r\n                  </b-row>\r\n                </b-form-group>\r\n              </b-col>\r\n            </b-row>\r\n          </b-form>\r\n          <em slot=\"footer\">\r\n            <b-button class=\"mr-1\" variant=\"primary\" :disabled=\"(getPermissions.role !== 'admin' && getPermissions.role !== 'owner') || isLoading\" size=\"sm\" @click=\"handleUpdateSetting\">\r\n              <i class=\"fa fa-dot-circle-o\"></i> Save Settings\r\n            </b-button>\r\n          </em>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n    <PolicyNotificationModal :id=\"policyModalID\"/>\r\n    <b-modal id=\"remove-file-modal\"  title=\"Please confirm\" centered @ok=\"removePolicyFile()\" ok-variant=\"danger\">\r\n      Are you sure you want to remove current policy document?\r\n      <template v-slot:modal-footer=\"{ ok, cancel }\">\r\n        <b-button variant=\"warning\" @click=\"ok()\"> <i class=\"icon-check\"></i> Yes, I understand &amp; confirm! </b-button>\r\n        <b-button variant @click=\"cancel()\"> <i class=\"icon-close\"></i> No </b-button>\r\n      </template>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport _nav from '@/_nav'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport vToasted from '@/shared/notification'\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport PermissionsMixin from '@/components/common/PermissionsMixin'\r\nimport reportLogo from '@/assets/img/report-demo.jpg'\r\nimport PolicyNotificationModal from './PolicyNotificationModal.vue'\r\nimport get from 'lodash/get'\r\nexport default {\r\n  components: { PolicyNotificationModal },\r\n  data() {\r\n    return {\r\n      reportLogo,\r\n      isLoading: false,\r\n      data: {\r\n        show_dashboard: true,\r\n        si_listing_brand_name: '',\r\n        default_brand_logo: '',\r\n        map_pricing_policy_document: {\r\n          url: '',\r\n          file_name: ''\r\n        }\r\n      },\r\n      originData: {},\r\n      nav: _nav,\r\n      policyModalID: 'policy-sending-confirmation',\r\n      policyUpdated: false\r\n    }\r\n  },\r\n  mixins: [vToasted, PermissionsMixin],\r\n  methods: {\r\n    ...mapActions({\r\n      remoteFetchSetting: `mw/settings/${TYPE.FETCH_SETTING}`,\r\n      remoteUpdateSetting: `mw/settings/${TYPE.REMOTE_EDIT_SETTING}`,\r\n      remoteImagesFileUpload: `mw/images/${TYPE.REMOTE_UPLOAD_IMAGES}`,\r\n      remoteFileUpload: `mw/settings/${TYPE.REMOTE_UPLOAD_FILES}`\r\n    }),\r\n    async handleImagesFileUpload(e) {\r\n      this.isLoading = true\r\n      let formData = new FormData()\r\n      formData.append('file', e.target.files[0])\r\n      formData.append('type', 'brand_logos')\r\n      try {\r\n        const res = await this.remoteImagesFileUpload(formData)\r\n        this.data.default_brand_logo = res.url\r\n        this.vToasted('success', `Your file is uploaded successfully.`)\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    },\r\n    async handleUploadMapPricingPolicyDocument(e) {\r\n      this.isLoading = true\r\n      let formData = new FormData()\r\n      formData.append('file', e.target.files[0])\r\n      formData.append('type', 'map_pricing_policy_document')\r\n      try {\r\n        const res = await this.remoteFileUpload(formData)\r\n        // eslint-disable-next-line\r\n        const { url, file_name } = res\r\n        this.data.map_pricing_policy_document.url = url\r\n        // eslint-disable-next-line\r\n        this.data.map_pricing_policy_document.file_name = file_name\r\n        this.vToasted('success', `Your file is uploaded successfully.`)\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    },\r\n    removeLogo() {\r\n      this.data.default_brand_logo = ''\r\n    },\r\n    removePolicyFile() {\r\n      this.data.map_pricing_policy_document.url = ''\r\n      this.data.map_pricing_policy_document.file_name = ''\r\n      this.$refs.policyFileInput.reset()\r\n    },\r\n    downloadFile() {\r\n      window.location.href = this.data.map_pricing_policy_document.url\r\n    },\r\n    formatNames(files) {\r\n      const name = files[0].name\r\n      return name.length > 20 ? `${name.substr(0, 15)}...` : name\r\n    },\r\n    async handleUpdateSetting() {\r\n      this.isLoading = true\r\n      try {\r\n        /* eslint-disable */\r\n        const { client_id } = this.$route.params\r\n        await this.remoteUpdateSetting({ params: this.data, client_id })\r\n        this.vToasted('success', `Settings have been updated successfully.`)\r\n        this.policyUpdated = true\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    },\r\n    async handleFetchAndReloadData() {\r\n      this.isLoading = true\r\n      try {\r\n        /* eslint-disable */\r\n        const { client_id } = this.$route.params\r\n        const result = await this.remoteFetchSetting({ client_id })\r\n        this.data.show_dashboard = result.show_dashboard\r\n        this.data.si_listing_brand_name = result.si_listing_brand_name\r\n        this.data.default_brand_logo = result.default_brand_logo\r\n        this.data.map_pricing_policy_document.url = result.map_pricing_policy_document.url\r\n        this.data.map_pricing_policy_document.file_name = result.map_pricing_policy_document.file_name\r\n        // backup originData\r\n        this.originData = JSON.parse(JSON.stringify(this.data))\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      getPermissions: `mw/${TYPE.GET_PERMISSIONS}`,\r\n      // defaultParams: `mw/reports/${TYPE.GET_DEFAULT_PARAMS}`,\r\n      planConfig: `mw/${TYPE.GET_PLAN_CONFIG}`\r\n    }),\r\n    capitalize: function() {\r\n      return (str) => str[0].toUpperCase() + str.slice(1)\r\n    },\r\n    // params: function() {\r\n    //   return {...this.defaultParams} || {}\r\n    // },\r\n    newPolicyUploaded() {\r\n      return (\r\n        this.data.map_pricing_policy_document.url !==\r\n        this.originData.map_pricing_policy_document.url\r\n      )\r\n    }\r\n  },\r\n  created() {\r\n    this.handleFetchAndReloadData()\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n  input[type=file] {\r\n    color: white;\r\n  }\r\n\r\n  .pointer {\r\n    cursor: pointer;\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/components/page/settings"}]}