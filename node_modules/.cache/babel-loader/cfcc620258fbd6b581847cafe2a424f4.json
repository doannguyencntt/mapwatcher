{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\dashboard\\DashboardHistorical.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\dashboard\\DashboardHistorical.vue","mtime":1639556629140},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1620898435163},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["import \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.find\";\nimport _slicedToArray from \"C:/Project/CBPO/plat-mw-web/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:/Project/CBPO/plat-mw-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.function.name\";\nimport _defineProperty from \"C:/Project/CBPO/plat-mw-web/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters, mapActions } from 'vuex';\nimport * as TYPE from '@/actionTypes.js';\nimport $ from 'jquery';\nimport { Promise } from 'q';\nimport _ from 'lodash';\nimport { DashboardFilterSourceType } from '@/constants/Report';\nimport { DashboardViolatorTitle, DashboardAllSellerTitle, DashboardWidgetId } from '@/constants/Dashboard';\nimport configHistoricalDataTable from '@/store/modules/page/dashboard/configs/historical-data-table';\nexport default {\n  props: ['selected'],\n  data: function data() {\n    return {\n      dashboardFilterSourceType: _.cloneDeep(DashboardFilterSourceType),\n      dashboardAllSellerTitle: _.cloneDeep(DashboardAllSellerTitle),\n      dashboardViolatorTitle: _.cloneDeep(DashboardViolatorTitle),\n      dashboardWidgetId: _.cloneDeep(DashboardWidgetId),\n      dates: [],\n      loader: false,\n      selectedDate: null,\n      sdkConfigInitialized: false,\n      sdkConfigForceReload: 0,\n      violationDataSourceConnection: {\n        type: 'vio',\n        ds_external_id: null\n      }\n    };\n  },\n  name: 'MWDashboardHistorical',\n  computed: _objectSpread({}, mapGetters({\n    dataHistoricalTable: \"mw/dashboard/\".concat(TYPE.GET_DATA_HISTORICAL),\n    dataDateHistorical: \"mw/dashboard/\".concat(TYPE.GET_DATE_HISTORICAL),\n    dataNumberViolations: \"mw/dashboard/\".concat(TYPE.GET_DATA_NUMBER_OF_VIOLATIONS),\n    dataNumberViolationsViolators: \"mw/dashboard/\".concat(TYPE.GET_DATA_NUMBER_OF_VIOLATIONS_VIOLATORS),\n    mainConfig: \"mw/dashboard/\".concat(TYPE.GET_DATA_CONFIG_HISTORICAL)\n  })),\n  methods: _objectSpread(_objectSpread({}, mapActions({\n    fetchDataHistoricalTable: \"mw/dashboard/\".concat(TYPE.FETCH_DATA_HISTORICAL),\n    fetchDataDateHistorical: \"mw/dashboard/\".concat(TYPE.FETCH_DATE_HISTORICAL),\n    fetchDataNumberViolations: \"mw/dashboard/\".concat(TYPE.FETCH_DATA_NUMBER_OF_VIOLATIONS),\n    fetchDataNumberViolationsViolators: \"mw/dashboard/\".concat(TYPE.FETCH_DATA_NUMBER_OF_VIOLATIONS_VIOLATORS),\n    downloadDailyViolations: \"mw/dashboard/\".concat(TYPE.FETCH_DOWNLOAD_DAILY_VIOLATIONS),\n    setSelectedDate: \"mw/dashboard/\".concat(TYPE.SET_SELECTED_DATE),\n    getDsMaps: \"mw/dashboard/\".concat(TYPE.GET_DS_MAPS)\n  })), {}, {\n    handleDataHistorical: function handleDataHistorical(marketplace) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.fetchDataHistoricalTable(_this.useShareTokenIfNeed({\n          date: _this.selectedDate ? _this.$moment(_this.selectedDate).format('YYYY-MM-DD') : null,\n          marketplace: marketplace,\n          report_id: _this.selected.report._id,\n          seller_type: _this.selected.seller_type,\n          show_upc_in_dashboard: _this.selected.report.show_upc_in_dashboard\n        })).then(function () {\n          var fakeHistorical = _objectSpread({}, _this.dataHistoricalTable);\n\n          fakeHistorical = _this.emptyRowData(fakeHistorical, _this.getIgnoredColumnsHistorical(_this.selected.report));\n\n          if (_this.selected.report && !_this.selected.report.show_upc_in_dashboard) {\n            fakeHistorical = _this.removeColumnData(fakeHistorical, ['upc/ean']);\n          }\n\n          window.mw_historical_data_table = fakeHistorical;\n          resolve();\n        });\n      });\n    },\n    // remove column from table data\n    removeColumnData: function removeColumnData(data) {\n      var cols = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      if (!cols.length || !data || !data.cols || !data.rows) return data;\n      var names = data.cols.map(function (d) {\n        return d.name;\n      });\n      var indexs = cols.reduce(function (a, c) {\n        if (names.includes(c)) a.push(names.indexOf(c));\n        return a;\n      }, []).filter(function (e) {\n        return e >= 0;\n      });\n      indexs.forEach(function (i) {\n        data.rows = data.rows.map(function (r) {\n          r[i] = null;\n          return r;\n        });\n      });\n      return data;\n    },\n    findWidgetByLabel: function findWidgetByLabel(widgetArray, label) {\n      var _this2 = this;\n\n      var flag;\n      widgetArray.forEach(function (widget) {\n        if (widget.config.widgets && widget.config.widgets.length > 0) {\n          var result = _this2.findWidgetByLabel(widget.config.widgets, label); // eslint-disable-next-line no-unused-expressions\n\n\n          result ? flag = result : '';\n        } else if (label === widget.config.widget.title.text) {\n          flag = widget;\n        }\n      });\n      return flag;\n    },\n    handleCaseRemoveColumn: function handleCaseRemoveColumn(widgetName, arrayLabel) {\n      var widget = this.findWidgetByLabel(window.mw_dashboard_main_config.widgetLayout.widgets, widgetName);\n      widget.config.elements[0].config.columns = this.removeColumnByLabel(widget.config.elements[0].config.columns, arrayLabel);\n    },\n    removeColumnByLabel: function removeColumnByLabel(arrayColumn, arrayLabel) {\n      return arrayColumn.filter(function (column) {\n        return !arrayLabel.includes(column.name);\n      });\n    },\n    useShareTokenIfNeed: function useShareTokenIfNeed(object) {\n      if (this.selected.share_token) {\n        _.assign(object, {\n          share_token: this.selected.share_token\n        });\n      }\n\n      _.assign(object, {\n        source: this.selected.source\n      });\n\n      _.assign(object, {\n        is_true_map: !!this.selected.report.true_map_report\n      });\n\n      return object;\n    },\n    getIgnoredColumnsHistorical: function getIgnoredColumnsHistorical(report) {\n      var ignoredColumns = [];\n\n      if (report && report.ignore_price_tracking) {\n        ignoredColumns.push('map_price', 'diff', 'diff_percent');\n      }\n\n      return ignoredColumns;\n    },\n    handleDataNumberOfViolationsViolators: function handleDataNumberOfViolationsViolators(marketplace) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this3.fetchDataNumberViolationsViolators(_this3.useShareTokenIfNeed({\n          marketplace: marketplace,\n          report_id: _this3.selected.report._id,\n          seller_type: _this3.selected.seller_type\n        })).then(function () {\n          window.mw_historical_number_of_violation_violator = _this3.dataNumberViolationsViolators;\n          resolve();\n        });\n      });\n    },\n    handleDataNumberViolations: function handleDataNumberViolations(marketplace) {\n      var _this4 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this4.fetchDataNumberViolations(_this4.useShareTokenIfNeed({\n          marketplace: marketplace,\n          report_id: _this4.selected.report._id,\n          seller_type: _this4.selected.seller_type\n        })).then(function () {\n          window.mw_historical_number_of_violations = _this4.dataNumberViolations;\n          resolve();\n        });\n      });\n    },\n    emptyRowData: function emptyRowData(data) {\n      var cols = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      if (!cols.length || !data || !data.cols || !data.rows) return data;\n      var names = data.cols.map(function (d) {\n        return d.name;\n      });\n      var indexs = cols.reduce(function (a, c) {\n        if (names.includes(c)) a.push(names.indexOf(c));\n        return a;\n      }, []).filter(function (e) {\n        return e >= 0;\n      });\n      indexs.forEach(function (i) {\n        data.rows = data.rows.map(function (r) {\n          r[i] = null;\n          return r;\n        });\n      });\n      return data;\n    },\n    syncMarketplaceParams: function syncMarketplaceParams(marketplace) {\n      return _.includes(marketplace, 'amazon') ? marketplace.replace(/[_]/g, '.') : marketplace;\n    },\n    _fetchDashboardWidgetData: function () {\n      var _fetchDashboardWidgetData2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this5 = this;\n\n        var marketplace, isTrueMap, promises;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                marketplace = this.syncMarketplaceParams(this.selected.marketplace);\n                isTrueMap = !!this.selected.report.true_map_report; // const isTrueMap = false\n                // const promises = [this.handleDataHistorical(marketplace)]\n\n                promises = []; // GET data from data source VIOLATION\n\n                if (isTrueMap) {\n                  promises.push(this.handleDataNumberOfViolationsViolators(marketplace));\n                  promises.push(this.handleDataNumberViolations(marketplace));\n                }\n\n                _context.next = 6;\n                return Promise.all(promises).then(function () {\n                  var cloneObj = $.extend(true, {}, _this5.mainConfig);\n                  cloneObj.widgetLayout.widgets.unshift(_this5.buildConfigWidgetHistoricalData(marketplace));\n\n                  var _iterator = _createForOfIteratorHelper(cloneObj.widgetLayout.widgets.entries()),\n                      _step;\n\n                  try {\n                    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                      var _step$value = _slicedToArray(_step.value, 2),\n                          index = _step$value[0],\n                          widget = _step$value[1];\n\n                      var widgetId = widget.config.widget_id;\n\n                      if (widgetId) {\n                        var text = _this5.selected.source === _this5.dashboardFilterSourceType.ALL_SELLERS ? _this5.dashboardAllSellerTitle[widgetId] : _this5.dashboardViolatorTitle[widgetId];\n                        cloneObj.widgetLayout.widgets[index].config.widget.title.text = text;\n                      }\n                    }\n                  } catch (err) {\n                    _iterator.e(err);\n                  } finally {\n                    _iterator.f();\n                  }\n\n                  if (!isTrueMap) {\n                    // const cloneWidgets = _.clone(widgets)\n                    cloneObj.widgetLayout.widgets = _.filter(cloneObj.widgetLayout.widgets, function (item) {\n                      return !_.includes([_this5.dashboardWidgetId.number_of_violations_per_seller, _this5.dashboardWidgetId.number_of_violations_violators], item.config.widget_id);\n                    });\n                  }\n\n                  window.mw_dashboard_main_config = cloneObj;\n\n                  if (!_this5.sdkConfigInitialized) {\n                    // for first time\n                    _this5.sdkConfigInitialized = true;\n                  } else {\n                    // change dataSource effect to sdk\n                    _this5.sdkConfigForceReload++;\n                  }\n                });\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _fetchDashboardWidgetData() {\n        return _fetchDashboardWidgetData2.apply(this, arguments);\n      }\n\n      return _fetchDashboardWidgetData;\n    }(),\n    buildConfigWidgetHistoricalData: function buildConfigWidgetHistoricalData(marketplace) {\n      var ignoreColumnNames = [];\n\n      if (this.selected.report && !this.selected.report.show_upc_in_dashboard) {\n        ignoreColumnNames.push('upc');\n      }\n\n      var emptyDataColumnNames = [];\n\n      if (this.selected.report && this.selected.report.ignore_price_tracking) {\n        emptyDataColumnNames.push.apply(emptyDataColumnNames, ['map_price', 'diff', 'diff_percent']);\n      }\n\n      return {\n        type: 'cbpo-widget',\n        config: configHistoricalDataTable(this.violationDataSourceConnection.ds_external_id, this.buildFilterHistoricalData(marketplace), ignoreColumnNames, emptyDataColumnNames)\n      };\n    },\n    buildFilterHistoricalData: function buildFilterHistoricalData(marketplace) {\n      var conditions = [{\n        column: 'marketplace',\n        operator: '==',\n        value: 'amazon.com'\n      }, {\n        column: 'report_id',\n        operator: '==',\n        value: this.selected.report._id\n      }];\n\n      if (!_.isEmpty(this.selected.fulfillment)) {\n        var operator = this.selected.fulfillment === 'FBA' ? 'is_true' : 'is_false';\n        conditions.push({\n          column: 'fba',\n          value: '',\n          operator: operator\n        });\n      }\n\n      conditions.push({\n        column: 'violation_date_string',\n        operator: '==',\n        value: this.selectedDate\n      });\n\n      if (_.isEqual(this.selected.seller_type, 'authorized_sellers')) {\n        conditions.push({\n          column: 'is_authorized_seller',\n          operator: 'is_true',\n          value: ''\n        });\n      }\n\n      return {\n        type: 'AND',\n        conditions: conditions\n      };\n    },\n    _renderDashboardWidgets: function _renderDashboardWidgets() {\n      // if (this.selected.report && !this.selected.report.show_upc_in_dashboard) {\n      //   this.handleCaseRemoveColumn('Historical Data Table', ['upc/ean'])\n      // }\n      // const isTrueMap = !!this.selected.report.true_map_report\n      // if (!isTrueMap) {\n      //   this.handleCaseRemoveColumn('Historical Data Table', ['map_price', 'diff', 'diff_percent'])\n      // }\n      // let el = $(this.$el).find('.widgets-container:eq(0)')\n      // el.html(\n      //   '<cbpo-dashboard config-ref=\"mw_dashboard_main_config\" class=\"mw-sdk-styled\" />'\n      // )\n      // this.$CBPO.wgManager().init('.widgets-container')\n      // this.$forceUpdate()\n      this.sdkConfigForceReload++;\n    },\n    fetchAndRenderDashboardWidgets: function () {\n      var _fetchAndRenderDashboardWidgets = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this._fetchDashboardWidgetData();\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function fetchAndRenderDashboardWidgets() {\n        return _fetchAndRenderDashboardWidgets.apply(this, arguments);\n      }\n\n      return fetchAndRenderDashboardWidgets;\n    }(),\n    fetchDate: function () {\n      var _fetchDate = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var marketplace;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                marketplace = this.syncMarketplaceParams(this.selected.marketplace);\n                _context3.next = 3;\n                return this.fetchDataDateHistorical(this.useShareTokenIfNeed({\n                  marketplace: marketplace,\n                  report_id: this.selected.report._id,\n                  seller_type: this.selected.seller_type,\n                  fulfillment: this.selected.fulfillment\n                }));\n\n              case 3:\n                this.dates = this.dataDateHistorical.dates;\n\n                if (this.dates.length > 0) {\n                  this.selectedDate = this.dates[0];\n                } else {\n                  this.selectedDate = null;\n                }\n\n                this.setSelectedDate(this.selectedDate);\n                this.fetchAndRenderDashboardWidgets();\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function fetchDate() {\n        return _fetchDate.apply(this, arguments);\n      }\n\n      return fetchDate;\n    }(),\n    dateChange: function dateChange(e) {\n      this.selectedDate = e.target.value;\n      this.setSelectedDate(this.selectedDate);\n      this.fetchAndRenderDashboardWidgets();\n    },\n    _fetchDs: function () {\n      var _fetchDs2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return this.getDsMaps();\n\n              case 3:\n                return _context4.abrupt(\"return\", _context4.sent);\n\n              case 6:\n                _context4.prev = 6;\n                _context4.t0 = _context4[\"catch\"](0);\n                console.log(_context4.t0);\n\n              case 9:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 6]]);\n      }));\n\n      function _fetchDs() {\n        return _fetchDs2.apply(this, arguments);\n      }\n\n      return _fetchDs;\n    }()\n  }),\n  created: function () {\n    var _created = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n      var allDataSources;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return this._fetchDs();\n\n            case 2:\n              allDataSources = _context5.sent;\n              this.violationDataSourceConnection = _.find(allDataSources, function (ele) {\n                return ele.type === 'vio';\n              });\n              this.fetchDate();\n\n            case 5:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    function created() {\n      return _created.apply(this, arguments);\n    }\n\n    return created;\n  }(),\n  watch: {\n    '$route.query': function $routeQuery(val) {\n      this.fetchDate();\n    }\n  },\n  destroyed: function destroyed() {\n    this.$CBPO.$bus.$off(\"trigger_button_history_\".concat(TYPE.DOWNLOAD_DAILY_VIOLATIONS));\n  }\n};",{"version":3,"sources":["DashboardHistorical.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n   <div class=\"animated fadeIn\">\r\n     <div class=\"align-middle d-flex justify-content-center align-items-center spinner-container\" v-if=\"!sdkConfigInitialized\">\r\n        <div class=\"spinner-border thin-spinner spinner-border-sm thin-spinner\"></div>&nbsp;Loading...\r\n      </div>\r\n    <div class=\"cbpo-s form-group mw-historical-control-select mb-0\" :class=\"{ 'pt-0': sdkConfigInitialized }\" v-if=\"sdkConfigInitialized\">\r\n      <label>Date:</label>\r\n      <select v-model=\"selectedDate\" @change=\"dateChange($event)\" class=\"form-control\">\r\n        <template v-for=\"(date, i) in dates\">\r\n          <option :value=\"date\" :key=\"i\">{{date}}</option>\r\n        </template>\r\n      </select>\r\n    </div>\r\n    <div v-if=\"sdkConfigInitialized\" class=\"widgets-container\">\r\n      <!--dashboard sdk will be rendered where, DON'T change the class-->\r\n        <cbpo-dashboard :key=\"sdkConfigForceReload\" config-ref=\"mw_dashboard_main_config\" class=\"mw-sdk-styled\"/>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport $ from 'jquery'\r\nimport { Promise } from 'q'\r\nimport _ from 'lodash'\r\nimport { DashboardFilterSourceType } from '@/constants/Report'\r\nimport { DashboardViolatorTitle, DashboardAllSellerTitle, DashboardWidgetId } from '@/constants/Dashboard'\r\nimport configHistoricalDataTable from '@/store/modules/page/dashboard/configs/historical-data-table'\r\n\r\nexport default {\r\n  props: ['selected'],\r\n  data: () => ({\r\n    dashboardFilterSourceType: _.cloneDeep(DashboardFilterSourceType),\r\n    dashboardAllSellerTitle: _.cloneDeep(DashboardAllSellerTitle),\r\n    dashboardViolatorTitle: _.cloneDeep(DashboardViolatorTitle),\r\n    dashboardWidgetId: _.cloneDeep(DashboardWidgetId),\r\n    dates: [],\r\n    loader: false,\r\n    selectedDate: null,\r\n    sdkConfigInitialized: false,\r\n    sdkConfigForceReload: 0,\r\n    violationDataSourceConnection: {\r\n      type: 'vio',\r\n      ds_external_id: null\r\n    }\r\n  }),\r\n  name: 'MWDashboardHistorical',\r\n  computed: {\r\n    ...mapGetters({\r\n      dataHistoricalTable: `mw/dashboard/${TYPE.GET_DATA_HISTORICAL}`,\r\n      dataDateHistorical: `mw/dashboard/${TYPE.GET_DATE_HISTORICAL}`,\r\n      dataNumberViolations: `mw/dashboard/${TYPE.GET_DATA_NUMBER_OF_VIOLATIONS}`,\r\n      dataNumberViolationsViolators: `mw/dashboard/${TYPE.GET_DATA_NUMBER_OF_VIOLATIONS_VIOLATORS}`,\r\n      mainConfig: `mw/dashboard/${TYPE.GET_DATA_CONFIG_HISTORICAL}`\r\n    })\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      fetchDataHistoricalTable: `mw/dashboard/${TYPE.FETCH_DATA_HISTORICAL}`,\r\n      fetchDataDateHistorical: `mw/dashboard/${TYPE.FETCH_DATE_HISTORICAL}`,\r\n      fetchDataNumberViolations: `mw/dashboard/${TYPE.FETCH_DATA_NUMBER_OF_VIOLATIONS}`,\r\n      fetchDataNumberViolationsViolators: `mw/dashboard/${TYPE.FETCH_DATA_NUMBER_OF_VIOLATIONS_VIOLATORS}`,\r\n      downloadDailyViolations: `mw/dashboard/${TYPE.FETCH_DOWNLOAD_DAILY_VIOLATIONS}`,\r\n      setSelectedDate: `mw/dashboard/${TYPE.SET_SELECTED_DATE}`,\r\n      getDsMaps: `mw/dashboard/${TYPE.GET_DS_MAPS}`\r\n    }),\r\n    handleDataHistorical(marketplace) {\r\n      return new Promise((resolve, reject) => {\r\n        this.fetchDataHistoricalTable(this.useShareTokenIfNeed({\r\n          date: this.selectedDate ? this.$moment(this.selectedDate).format('YYYY-MM-DD') : null,\r\n          marketplace: marketplace,\r\n          report_id: this.selected.report._id,\r\n          seller_type: this.selected.seller_type,\r\n          show_upc_in_dashboard: this.selected.report.show_upc_in_dashboard\r\n        })).then(() => {\r\n          let fakeHistorical = {...this.dataHistoricalTable}\r\n          fakeHistorical = this.emptyRowData(fakeHistorical, this.getIgnoredColumnsHistorical(this.selected.report))\r\n          if (this.selected.report && !this.selected.report.show_upc_in_dashboard) {\r\n            fakeHistorical = this.removeColumnData(fakeHistorical, ['upc/ean'])\r\n          }\r\n          window.mw_historical_data_table = fakeHistorical\r\n          resolve()\r\n        })\r\n      })\r\n    },\r\n    // remove column from table data\r\n    removeColumnData(data, cols = []) {\r\n      if (!cols.length || !data || !data.cols || !data.rows) return data\r\n      let names = data.cols.map(d => d.name)\r\n      let indexs = cols.reduce((a, c) => { if (names.includes(c)) a.push(names.indexOf(c)); return a }, []).filter(e => e >= 0)\r\n      indexs.forEach(i => { data.rows = data.rows.map(r => { r[i] = null; return r }) })\r\n      return data\r\n    },\r\n    findWidgetByLabel(widgetArray, label) {\r\n      let flag\r\n      widgetArray.forEach(widget => {\r\n        if (widget.config.widgets && widget.config.widgets.length > 0) {\r\n          let result = this.findWidgetByLabel(widget.config.widgets, label)\r\n          // eslint-disable-next-line no-unused-expressions\r\n          result ? flag = result : ''\r\n        } else if (label === widget.config.widget.title.text) {\r\n          flag = widget\r\n        }\r\n      })\r\n      return flag\r\n    },\r\n    handleCaseRemoveColumn(widgetName, arrayLabel) {\r\n      let widget = this.findWidgetByLabel(window.mw_dashboard_main_config.widgetLayout.widgets, widgetName)\r\n      widget.config.elements[0].config.columns = this.removeColumnByLabel(widget.config.elements[0].config.columns, arrayLabel)\r\n    },\r\n    removeColumnByLabel(arrayColumn, arrayLabel) {\r\n      return arrayColumn.filter(column => !arrayLabel.includes(column.name))\r\n    },\r\n    useShareTokenIfNeed(object) {\r\n      if (this.selected.share_token) {\r\n        _.assign(object, { share_token: this.selected.share_token })\r\n      }\r\n      _.assign(object, { source: this.selected.source })\r\n      _.assign(object, { is_true_map: !!this.selected.report.true_map_report })\r\n      return object\r\n    },\r\n    getIgnoredColumnsHistorical(report) {\r\n      let ignoredColumns = []\r\n      if (report && report.ignore_price_tracking) {\r\n        ignoredColumns.push('map_price', 'diff', 'diff_percent')\r\n      }\r\n      return ignoredColumns\r\n    },\r\n    handleDataNumberOfViolationsViolators(marketplace) {\r\n      return new Promise((resolve, reject) => {\r\n        this.fetchDataNumberViolationsViolators(this.useShareTokenIfNeed({\r\n          marketplace: marketplace,\r\n          report_id: this.selected.report._id,\r\n          seller_type: this.selected.seller_type\r\n        })).then(() => {\r\n          window.mw_historical_number_of_violation_violator = this.dataNumberViolationsViolators\r\n          resolve()\r\n        })\r\n      })\r\n    },\r\n    handleDataNumberViolations(marketplace) {\r\n      return new Promise((resolve, reject) => {\r\n        this.fetchDataNumberViolations(this.useShareTokenIfNeed({\r\n          marketplace: marketplace,\r\n          report_id: this.selected.report._id,\r\n          seller_type: this.selected.seller_type\r\n        })).then(() => {\r\n          window.mw_historical_number_of_violations = this.dataNumberViolations\r\n          resolve()\r\n        })\r\n      })\r\n    },\r\n    emptyRowData(data, cols = []) {\r\n      if (!cols.length || !data || !data.cols || !data.rows) return data\r\n      let names = data.cols.map(d => d.name)\r\n      let indexs = cols.reduce((a, c) => { if (names.includes(c)) a.push(names.indexOf(c)); return a }, []).filter(e => e >= 0)\r\n      indexs.forEach(i => { data.rows = data.rows.map(r => { r[i] = null; return r }) })\r\n      return data\r\n    },\r\n    syncMarketplaceParams (marketplace) {\r\n      return _.includes(marketplace, 'amazon') ? marketplace.replace(/[_]/g, '.') : marketplace\r\n    },\r\n    async _fetchDashboardWidgetData() {\r\n      let marketplace = this.syncMarketplaceParams(this.selected.marketplace)\r\n      const isTrueMap = !!this.selected.report.true_map_report\r\n      // const isTrueMap = false\r\n      // const promises = [this.handleDataHistorical(marketplace)]\r\n      const promises = [] // GET data from data source VIOLATION\r\n      if (isTrueMap) {\r\n        promises.push(this.handleDataNumberOfViolationsViolators(marketplace))\r\n        promises.push(this.handleDataNumberViolations(marketplace))\r\n      }\r\n\r\n      await Promise.all(promises).then(() => {\r\n        let cloneObj = $.extend(true, {}, this.mainConfig)\r\n\r\n        cloneObj.widgetLayout.widgets.unshift(this.buildConfigWidgetHistoricalData(marketplace))\r\n\r\n        for (const [index, widget] of cloneObj.widgetLayout.widgets.entries()) {\r\n          const widgetId = widget.config.widget_id\r\n          if (widgetId) {\r\n            const text = this.selected.source === this.dashboardFilterSourceType.ALL_SELLERS ? this.dashboardAllSellerTitle[widgetId] : this.dashboardViolatorTitle[widgetId]\r\n            cloneObj.widgetLayout.widgets[index].config.widget.title.text = text\r\n          }\r\n        }\r\n        if (!isTrueMap) {\r\n          // const cloneWidgets = _.clone(widgets)\r\n          cloneObj.widgetLayout.widgets = _.filter(cloneObj.widgetLayout.widgets, (item) => {\r\n            return !_.includes([this.dashboardWidgetId.number_of_violations_per_seller, this.dashboardWidgetId.number_of_violations_violators], item.config.widget_id)\r\n          })\r\n        }\r\n\r\n        window.mw_dashboard_main_config = cloneObj\r\n        if (!this.sdkConfigInitialized) {\r\n          // for first time\r\n          this.sdkConfigInitialized = true\r\n        } else {\r\n          // change dataSource effect to sdk\r\n          this.sdkConfigForceReload++\r\n        }\r\n      })\r\n    },\r\n    buildConfigWidgetHistoricalData(marketplace) {\r\n      const ignoreColumnNames = []\r\n      if (this.selected.report && !this.selected.report.show_upc_in_dashboard) {\r\n        ignoreColumnNames.push('upc')\r\n      }\r\n      const emptyDataColumnNames = []\r\n      if (this.selected.report && this.selected.report.ignore_price_tracking) {\r\n        emptyDataColumnNames.push(...['map_price', 'diff', 'diff_percent'])\r\n      }\r\n\r\n      return {\r\n        type: 'cbpo-widget',\r\n        config: configHistoricalDataTable(\r\n          this.violationDataSourceConnection.ds_external_id,\r\n          this.buildFilterHistoricalData(marketplace),\r\n          ignoreColumnNames,\r\n          emptyDataColumnNames)\r\n      }\r\n    },\r\n    buildFilterHistoricalData(marketplace) {\r\n      const conditions = [\r\n        {\r\n          column: 'marketplace',\r\n          operator: '==',\r\n          value: 'amazon.com'\r\n        },\r\n        {\r\n          column: 'report_id',\r\n          operator: '==',\r\n          value: this.selected.report._id\r\n        }\r\n      ]\r\n      if (!_.isEmpty(this.selected.fulfillment)) {\r\n        const operator = this.selected.fulfillment === 'FBA' ? 'is_true' : 'is_false'\r\n        conditions.push({\r\n          column: 'fba',\r\n          value: '',\r\n          operator\r\n        })\r\n      }\r\n      conditions.push({\r\n        column: 'violation_date_string',\r\n        operator: '==',\r\n        value: this.selectedDate\r\n      })\r\n      if (_.isEqual(this.selected.seller_type, 'authorized_sellers')) {\r\n        conditions.push({\r\n          column: 'is_authorized_seller',\r\n          operator: 'is_true',\r\n          value: ''\r\n        })\r\n      }\r\n      return {\r\n        type: 'AND',\r\n        conditions\r\n      }\r\n    },\r\n    _renderDashboardWidgets() {\r\n      // if (this.selected.report && !this.selected.report.show_upc_in_dashboard) {\r\n      //   this.handleCaseRemoveColumn('Historical Data Table', ['upc/ean'])\r\n      // }\r\n      // const isTrueMap = !!this.selected.report.true_map_report\r\n      // if (!isTrueMap) {\r\n      //   this.handleCaseRemoveColumn('Historical Data Table', ['map_price', 'diff', 'diff_percent'])\r\n      // }\r\n      // let el = $(this.$el).find('.widgets-container:eq(0)')\r\n      // el.html(\r\n      //   '<cbpo-dashboard config-ref=\"mw_dashboard_main_config\" class=\"mw-sdk-styled\" />'\r\n      // )\r\n      // this.$CBPO.wgManager().init('.widgets-container')\r\n      // this.$forceUpdate()\r\n      this.sdkConfigForceReload++\r\n    },\r\n    async fetchAndRenderDashboardWidgets() {\r\n      await this._fetchDashboardWidgetData()\r\n      // this._renderDashboardWidgets()\r\n    },\r\n    async fetchDate() {\r\n      let marketplace = this.syncMarketplaceParams(this.selected.marketplace)\r\n      await this.fetchDataDateHistorical(this.useShareTokenIfNeed({\r\n        marketplace: marketplace,\r\n        report_id: this.selected.report._id,\r\n        seller_type: this.selected.seller_type,\r\n        fulfillment: this.selected.fulfillment\r\n      }))\r\n      this.dates = this.dataDateHistorical.dates\r\n      if (this.dates.length > 0) {\r\n        this.selectedDate = this.dates[0]\r\n      } else {\r\n        this.selectedDate = null\r\n      }\r\n      this.setSelectedDate(this.selectedDate)\r\n      this.fetchAndRenderDashboardWidgets()\r\n    },\r\n    dateChange(e) {\r\n      this.selectedDate = e.target.value\r\n      this.setSelectedDate(this.selectedDate)\r\n      this.fetchAndRenderDashboardWidgets()\r\n    },\r\n    async _fetchDs() {\r\n      try {\r\n        return await this.getDsMaps()\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n    }\r\n  },\r\n  async created() {\r\n    const allDataSources = await this._fetchDs()\r\n    this.violationDataSourceConnection = _.find(allDataSources, ele => ele.type === 'vio')\r\n    this.fetchDate()\r\n  },\r\n\r\n  watch: {\r\n    '$route.query'(val) {\r\n      this.fetchDate()\r\n    }\r\n  },\r\n  destroyed() {\r\n    this.$CBPO.$bus.$off(`trigger_button_history_${TYPE.DOWNLOAD_DAILY_VIOLATIONS}`)\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.pl-05 {\r\n  padding-left: 0.5rem !important;\r\n}\r\n\r\n.mb-0 {\r\n  margin-bottom: 0 !important;\r\n}\r\n\r\n.mw-historical-control-select {\r\n  padding: 0.5rem;\r\n  label {\r\n    margin: 0;\r\n    padding: 5px 10px 5px 9px;\r\n    display: inline-block;\r\n  }\r\n  select {\r\n    padding: .2rem .5rem;\r\n    width: auto;\r\n    height: auto;\r\n    display: inline-block;\r\n    font-size: 11.5px;\r\n    border-radius: 0;\r\n  }\r\n}\r\n.mw-sdk-styled {\r\n  &.cbpo-dashboard {\r\n    border: none;\r\n  }\r\n  /deep/ {\r\n    .cbpo-dashboard-container{\r\n      border: none;\r\n      padding: 0\r\n    }\r\n    .cbpo-wrapper-action{\r\n      margin-left: auto;\r\n    }\r\n    .cbpo-btn {\r\n      display: flex;\r\n      justify-content: center;\r\n    }\r\n    .cbpo-btn .spinner-border {\r\n      width: 10px;\r\n      height: 10px;\r\n      border-width: 1px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/page/dashboard"}]}