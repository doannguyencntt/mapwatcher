{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\reports\\InventoryScheduleScrapingModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\reports\\InventoryScheduleScrapingModal.vue","mtime":1639556629249},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1620898435163},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _defineProperty from \"C:/Project/CBPO/plat-mw-web/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters, mapActions } from 'vuex';\nimport Datepicker from 'vuejs-datepicker';\nimport vToasted from '@/shared/notification';\nimport { GET_INVENTORY_SCHEDULES, FETCH_INVENTORY_SCHEDULES, ADD_INVENTORY_SCHEDULES, REMOVE_INVENTORY_SCHEDULES, REMOVE_INVENTORY_SCHEDULE } from '@/actionTypes.js';\nimport moment from 'moment';\nimport { required } from 'vuelidate/lib/validators';\nexport default {\n  name: 'InventoryScheduleScrapingModal',\n  components: {\n    Datepicker: Datepicker\n  },\n  props: {\n    visible: {\n      type: Boolean,\n      require: true\n    },\n    info: {\n      type: Object\n    },\n    marketplace: {\n      type: String\n    }\n  },\n  mixins: [vToasted],\n  data: function data() {\n    return {\n      date: {\n        from: null,\n        to: null\n      },\n      disabledDates: {\n        to: null\n      },\n      fields: [{\n        key: 'date',\n        label: 'Date'\n      }, {\n        key: 'action',\n        label: '',\n        thClass: 'w-110',\n        tdClass: 'text-center'\n      }],\n      isBusy: false,\n      params: {\n        limit: 4,\n        page: 1\n      },\n      dialog: {\n        removeMany: false,\n        removeOne: false\n      },\n      selectedSchedule: null\n    };\n  },\n  validations: {\n    date: {\n      from: {\n        required: required,\n        minValue: function minValue(value) {\n          return value >= this.today;\n        }\n      },\n      to: {\n        required: required,\n        minValue: function minValue(value) {\n          return value >= this.today;\n        }\n      }\n    }\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters({\n    listInventorySchedules: \"mw/reports/\".concat(GET_INVENTORY_SCHEDULES)\n  })), {}, {\n    today: function today() {\n      var ESTDateString = new Date().toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      var today = new Date(ESTDateString);\n      today.setHours(0, 0, 0, 0);\n      return today;\n    },\n    getItems: function getItems() {\n      return this.listInventorySchedules.items;\n    }\n  }),\n  methods: _objectSpread(_objectSpread({}, mapActions({\n    fetchInventorySchedules: \"mw/reports/\".concat(FETCH_INVENTORY_SCHEDULES),\n    addInventorySchedules: \"mw/reports/\".concat(ADD_INVENTORY_SCHEDULES),\n    removeInventorySchedules: \"mw/reports/\".concat(REMOVE_INVENTORY_SCHEDULES),\n    removeOneInventorySchedule: \"mw/reports/\".concat(REMOVE_INVENTORY_SCHEDULE)\n  })), {}, {\n    initInventoryDatePicker: function initInventoryDatePicker() {\n      this.date.from = this.today;\n      this.date.to = this.today;\n      this.disabledDates.to = this.today;\n    },\n    pickFromDate: function pickFromDate() {\n      this.$refs.dateFrom.$el.querySelector('input').focus();\n      this.$refs.dateFrom.showCalendar();\n    },\n    pickToDate: function pickToDate() {\n      this.$refs.dateTo.$el.querySelector('input').focus();\n      this.$refs.dateTo.showCalendar();\n    },\n    fetchSchedule: function fetchSchedule() {\n      var _this = this;\n\n      this.isBusy = true;\n      this.fetchInventorySchedules({\n        report_id: this.info._id,\n        marketplace: this.marketplace,\n        limit: this.params.limit,\n        page: this.params.page\n      }).finally(function () {\n        _this.isBusy = false;\n      });\n    },\n    handleInputDateFrom: function handleInputDateFrom(input) {\n      if (input.srcElement.value === '') {\n        this.date.from = null;\n      }\n\n      this.$v.date.from.$touch();\n    },\n    handleInputDateTo: function handleInputDateTo(input) {\n      if (input.srcElement.value === '') {\n        this.date.to = null;\n      }\n\n      this.$v.date.to.$touch();\n    },\n    addSchedules: function addSchedules() {\n      var _this2 = this;\n\n      this.isBusy = true;\n      this.addInventorySchedules({\n        report_id: this.info._id,\n        marketplace: this.marketplace,\n        from: moment(this.date.from).format('YYYY-MM-DD'),\n        to: moment(this.date.to).format('YYYY-MM-DD')\n      }).then(function () {\n        _this2.vToasted('success', 'Add inventory schedules successfully.');\n\n        _this2.fetchSchedule();\n      }).catch(function (err) {\n        _this2.isBusy = false;\n\n        if (err.response.data.message.includes('Inventory schedule is existed')) {\n          _this2.vToasted('error', err.response.data.message);\n        } else {\n          _this2.vToasted('error', 'Could not add inventory schedules.');\n        }\n      });\n    },\n    handleRemoveSchedule: function handleRemoveSchedule(isRemoveOne, schedule) {\n      if (isRemoveOne) {\n        this.dialog.removeOne = true;\n        this.selectedSchedule = schedule;\n      } else {\n        this.dialog.removeMany = true;\n      }\n    },\n    removeSchedules: function removeSchedules() {\n      var _this3 = this;\n\n      this.isBusy = true;\n      this.removeInventorySchedules({\n        report_id: this.info._id,\n        marketplace: this.marketplace,\n        from: moment(this.date.from).format('YYYY-MM-DD'),\n        to: moment(this.date.to).format('YYYY-MM-DD')\n      }).then(function () {\n        _this3.vToasted('success', 'Remove inventory schedules successfully.');\n\n        _this3.fetchSchedule();\n      }).catch(function () {\n        _this3.isBusy = false;\n\n        _this3.vToasted('error', 'Could not remove inventory schedules.');\n      });\n    },\n    removeOneSchedule: function removeOneSchedule() {\n      var _this4 = this;\n\n      this.isBusy = true;\n      this.removeOneInventorySchedule({\n        report_id: this.info._id,\n        marketplace: this.marketplace,\n        id: this.selectedSchedule._id\n      }).then(function () {\n        _this4.selectedSchedule = null;\n\n        _this4.vToasted('success', 'Remove inventory schedule successfully.');\n\n        _this4.fetchSchedule();\n      }).catch(function () {\n        _this4.isBusy = false;\n\n        _this4.vToasted('error', 'Could not remove inventory schedule.');\n      });\n    }\n  }),\n  created: function created() {\n    this.initInventoryDatePicker();\n    this.info && this.fetchSchedule();\n  },\n  filters: {\n    formatDate: function formatDate(dateTime) {\n      return moment(dateTime).format('MM/DD/YYYY');\n    }\n  }\n};",{"version":3,"sources":["InventoryScheduleScrapingModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <b-modal\r\n    static\r\n    :visible=\"visible\"\r\n    title=\"Inventory investigation modal (scheduler)\"\r\n    centered\r\n    size=\"lg\"\r\n    @hidden=\"$emit('hidden')\"\r\n  >\r\n    <strong>Altra - Inventory investigation scheduler</strong>\r\n    <br />\r\n    <br />\r\n    Please schedule an inventory investigation for this marketplace.\r\n    <br />\r\n    <!-- <br />\r\n    Inventory investigation is more expensive than the other activities. It's about 40 credits per ASIN per seller.\r\n    <br /> -->\r\n    <br />\r\n    <b-row>\r\n      <b-col md=\"7\" lg=\"7\" sm=\"13\">\r\n        <b-row>\r\n          <b-col md=\"6\" lg=\"6\" sm=\"6\"\r\n            ><b>From</b>\r\n            <b-button-group class=\"w-100\">\r\n              <b-button\r\n                class=\"col-md-2\"\r\n                id=\"btnDateFrom\"\r\n                size=\"sm\"\r\n                @click=\"pickFromDate()\"\r\n              >\r\n                <i class=\"icons icon-calendar\"></i>\r\n              </b-button>\r\n              <Datepicker\r\n                v-model=\"date.from\"\r\n                :disabled-dates=\"disabledDates\"\r\n                bootstrap-styling\r\n                format=\"MM/dd/yyyy\"\r\n                typeable\r\n                ref=\"dateFrom\"\r\n                @input.native=\"handleInputDateFrom\"\r\n                id=\"fromPicker\"\r\n                placeholder=\"Select a date\"\r\n                class=\"optimize-dp col-md-10 p-0 custom-datepicker-fromto\"\r\n              >\r\n              </Datepicker>\r\n            </b-button-group>\r\n             <div class=\"mw-error\" v-if=\"$v.date.from.$error && $v.date.from.$dirty && !$v.date.from.required\">\r\n              Date From is required.\r\n            </div>\r\n            <div class=\"mw-error\" v-else-if=\"$v.date.from.$error && $v.date.from.$dirty && !$v.date.from.minValue\">\r\n              Date From is invalid.\r\n            </div>\r\n          </b-col>\r\n          <b-col md=\"6\" lg=\"6\" sm=\"6\"\r\n            ><b>To</b>\r\n            <b-button-group class=\"w-100\">\r\n              <b-button\r\n                class=\"col-md-2\"\r\n                id=\"btnDateTo\"\r\n                size=\"sm\"\r\n                @click=\"pickToDate()\"\r\n              >\r\n                <i class=\"icons icon-calendar\"></i>\r\n              </b-button>\r\n              <Datepicker\r\n                v-model=\"date.to\"\r\n                :disabled-dates=\"disabledDates\"\r\n                bootstrap-styling\r\n                format=\"MM/dd/yyyy\"\r\n                typeable\r\n                ref=\"dateTo\"\r\n                @input.native=\"handleInputDateTo\"\r\n                id=\"toPicker\"\r\n                placeholder=\"Select a date\"\r\n                class=\"optimize-dp col-md-10 p-0 custom-datepicker-fromto\"\r\n              >\r\n              </Datepicker>\r\n            </b-button-group>\r\n            <div class=\"mw-error\" v-if=\"$v.date.to.$error && $v.date.to.$dirty && !$v.date.to.required\">\r\n              Date To is required.\r\n            </div>\r\n            <div class=\"mw-error\" v-else-if=\"$v.date.to.$error && $v.date.to.$dirty && !$v.date.to.minValue\">\r\n              Date To is invalid.\r\n            </div>\r\n          </b-col>\r\n        </b-row>\r\n        <b-row class=\"mt-4\">\r\n          <b-col md=\"6\" lg=\"6\" sm=\"6\">\r\n            <b-button\r\n              size=\"md\"\r\n              variant=\"danger\"\r\n              :disabled=\"$v.date.from.$error || $v.date.to.$error || isBusy\"\r\n              @click=\"handleRemoveSchedule(false)\"\r\n            >\r\n              <i class=\"icon-minus icons\"></i> Remove\r\n            </b-button>\r\n          </b-col>\r\n          <b-col md=\"6\" lg=\"6\" sm=\"6\" class=\"text-right\">\r\n            <b-button\r\n              size=\"md\"\r\n              variant=\"primary\"\r\n              :disabled=\"$v.date.from.$error || $v.date.to.$error || isBusy\"\r\n              @click=\"addSchedules()\"\r\n            >\r\n              <i class=\"icon-plus\"></i> Add\r\n            </b-button>\r\n          </b-col>\r\n        </b-row>\r\n      </b-col>\r\n      <b-col md=\"5\" lg=\"5\" sm=\"9\">\r\n        <b>Scheduled</b> ({{ listInventorySchedules.total || 0 }})\r\n        <b-table\r\n          bordered\r\n          striped\r\n          :hover=\"true\"\r\n          :busy=\"isBusy\"\r\n          outlined\r\n          responsive=\"sm\"\r\n          thead-class=\"thead-light text-nowrap\"\r\n          :items=\"getItems\"\r\n          :fields=\"fields\"\r\n          show-empty\r\n          class=\"overflow-auto\"\r\n        >\r\n          <template v-slot:empty>\r\n            <div class=\"empty\">No Inventory Scheduled</div>\r\n          </template>\r\n          <template v-slot:cell(date)=\"row\">{{\r\n            row.item.date_string | formatDate\r\n          }}</template>\r\n          <template v-slot:cell(action)=\"row\">\r\n            <b-button\r\n              size=\"md\"\r\n              variant=\"link\"\r\n              v-text=\"'<Remove>'\"\r\n              class=\"p-0\"\r\n              @click=\"handleRemoveSchedule(true, row.item)\"\r\n            ></b-button>\r\n          </template>\r\n          <template #table-busy>\r\n            <div\r\n              class=\"align-middle d-flex justify-content-center align-items-center spinner-container\"\r\n            >\r\n              <div class=\"spinner-border thin-spinner spinner-border-sm\"></div>\r\n              &nbsp;Loading...\r\n            </div>\r\n          </template>\r\n        </b-table>\r\n        <nav\r\n          class=\"d-flex justify-content-center\"\r\n          v-if=\"\r\n            listInventorySchedules.total > listInventorySchedules.page_size &&\r\n              listInventorySchedules.items.length > 0\r\n          \"\r\n        >\r\n          <b-pagination\r\n            :total-rows=\"listInventorySchedules.total\"\r\n            :per-page=\"params.limit\"\r\n            v-model=\"params.page\"\r\n            prev-text=\"Prev\"\r\n            next-text=\"Next\"\r\n            hide-goto-end-buttons\r\n            @change=\"\r\n              params.page = $event\r\n              fetchSchedule()\r\n            \"\r\n            hide-ellipsis\r\n          />\r\n        </nav>\r\n      </b-col>\r\n    </b-row>\r\n    <template v-slot:modal-footer=\"{ cancel }\">\r\n      <b-button size=\"md\" variant=\"secondary\" @click=\"cancel()\">\r\n        <i class=\"icon-close icons\"></i> Close\r\n      </b-button>\r\n    </template>\r\n    <b-modal title=\"Please confirm\" centered v-model=\"dialog.removeMany\" @ok=\"removeSchedules()\" ok-variant=\"danger\">\r\n      <span v-if=\"date.from.getTime() === date.to.getTime()\">Are you sure you want to remove the schedule on {{ date.from | formatDate }}</span>\r\n      <span v-else>Are you sure you want to unschedule the inventory investigation from {{ date.from | formatDate }} to {{ date.to | formatDate }}?</span>\r\n      <template v-slot:modal-footer=\"{ ok, cancel }\">\r\n        <b-button variant=\"warning\" @click=\"ok()\"> <i class=\"icon-check\"></i> Yes, I understand &amp; confirm! </b-button>\r\n        <b-button variant @click=\"cancel()\"> <i class=\"icon-close\"></i> No </b-button>\r\n      </template>\r\n    </b-modal>\r\n    <b-modal title=\"Please confirm\" centered v-model=\"dialog.removeOne\" @ok=\"removeOneSchedule()\" ok-variant=\"danger\">\r\n      Are you sure you want to remove the schedule on {{ selectedSchedule && selectedSchedule.date_string | formatDate }}?\r\n      <template v-slot:modal-footer=\"{ ok, cancel }\">\r\n        <b-button variant=\"warning\" @click=\"ok()\"> <i class=\"icon-check\"></i> Yes, I understand &amp; confirm! </b-button>\r\n        <b-button variant @click=\"cancel()\"> <i class=\"icon-close\"></i> No </b-button>\r\n      </template>\r\n    </b-modal>\r\n  </b-modal>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport vToasted from '@/shared/notification'\r\nimport {\r\n  GET_INVENTORY_SCHEDULES,\r\n  FETCH_INVENTORY_SCHEDULES,\r\n  ADD_INVENTORY_SCHEDULES,\r\n  REMOVE_INVENTORY_SCHEDULES,\r\n  REMOVE_INVENTORY_SCHEDULE\r\n} from '@/actionTypes.js'\r\nimport moment from 'moment'\r\nimport { required } from 'vuelidate/lib/validators'\r\n\r\nexport default {\r\n  name: 'InventoryScheduleScrapingModal',\r\n  components: {\r\n    Datepicker\r\n  },\r\n  props: {\r\n    visible: {\r\n      type: Boolean,\r\n      require: true\r\n    },\r\n    info: {\r\n      type: Object\r\n    },\r\n    marketplace: {\r\n      type: String\r\n    }\r\n  },\r\n  mixins: [vToasted],\r\n  data: () => {\r\n    return {\r\n      date: {\r\n        from: null,\r\n        to: null\r\n      },\r\n      disabledDates: {\r\n        to: null\r\n      },\r\n      fields: [{\r\n        key: 'date',\r\n        label: 'Date'\r\n      }, {\r\n        key: 'action',\r\n        label: '',\r\n        thClass: 'w-110',\r\n        tdClass: 'text-center'\r\n      }],\r\n      isBusy: false,\r\n      params: {\r\n        limit: 4,\r\n        page: 1\r\n      },\r\n      dialog: {\r\n        removeMany: false,\r\n        removeOne: false\r\n      },\r\n      selectedSchedule: null\r\n    }\r\n  },\r\n  validations: {\r\n    date: {\r\n      from: {\r\n        required,\r\n        minValue(value) {\r\n          return value >= this.today\r\n        }\r\n      },\r\n      to: {\r\n        required,\r\n        minValue(value) {\r\n          return value >= this.today\r\n        }\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      listInventorySchedules: `mw/reports/${GET_INVENTORY_SCHEDULES}`\r\n    }),\r\n    today() {\r\n      const ESTDateString = new Date().toLocaleString('en-US', { timeZone: 'EST' })\r\n      const today = new Date(ESTDateString)\r\n      today.setHours(0, 0, 0, 0)\r\n      return today\r\n    },\r\n    getItems: function() {\r\n      return this.listInventorySchedules.items\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      fetchInventorySchedules: `mw/reports/${FETCH_INVENTORY_SCHEDULES}`,\r\n      addInventorySchedules: `mw/reports/${ADD_INVENTORY_SCHEDULES}`,\r\n      removeInventorySchedules: `mw/reports/${REMOVE_INVENTORY_SCHEDULES}`,\r\n      removeOneInventorySchedule: `mw/reports/${REMOVE_INVENTORY_SCHEDULE}`\r\n    }),\r\n    initInventoryDatePicker() {\r\n      this.date.from = this.today\r\n      this.date.to = this.today\r\n      this.disabledDates.to = this.today\r\n    },\r\n    pickFromDate() {\r\n      this.$refs.dateFrom.$el.querySelector('input').focus()\r\n      this.$refs.dateFrom.showCalendar()\r\n    },\r\n    pickToDate() {\r\n      this.$refs.dateTo.$el.querySelector('input').focus()\r\n      this.$refs.dateTo.showCalendar()\r\n    },\r\n    fetchSchedule() {\r\n      this.isBusy = true\r\n      this.fetchInventorySchedules({\r\n        report_id: this.info._id,\r\n        marketplace: this.marketplace,\r\n        limit: this.params.limit,\r\n        page: this.params.page\r\n      }).finally(() => {\r\n        this.isBusy = false\r\n      })\r\n    },\r\n    handleInputDateFrom(input) {\r\n      if (input.srcElement.value === '') {\r\n        this.date.from = null\r\n      }\r\n      this.$v.date.from.$touch()\r\n    },\r\n    handleInputDateTo(input) {\r\n      if (input.srcElement.value === '') {\r\n        this.date.to = null\r\n      }\r\n      this.$v.date.to.$touch()\r\n    },\r\n    addSchedules() {\r\n      this.isBusy = true\r\n      this.addInventorySchedules({\r\n        report_id: this.info._id,\r\n        marketplace: this.marketplace,\r\n        from: moment(this.date.from).format('YYYY-MM-DD'),\r\n        to: moment(this.date.to).format('YYYY-MM-DD')\r\n      }).then(() => {\r\n        this.vToasted('success', 'Add inventory schedules successfully.')\r\n        this.fetchSchedule()\r\n      }).catch((err) => {\r\n        this.isBusy = false\r\n        if (err.response.data.message.includes('Inventory schedule is existed')) {\r\n          this.vToasted('error', err.response.data.message)\r\n        } else {\r\n          this.vToasted('error', 'Could not add inventory schedules.')\r\n        }\r\n      })\r\n    },\r\n    handleRemoveSchedule(isRemoveOne, schedule) {\r\n      if (isRemoveOne) {\r\n        this.dialog.removeOne = true\r\n        this.selectedSchedule = schedule\r\n      } else {\r\n        this.dialog.removeMany = true\r\n      }\r\n    },\r\n    removeSchedules() {\r\n      this.isBusy = true\r\n      this.removeInventorySchedules({\r\n        report_id: this.info._id,\r\n        marketplace: this.marketplace,\r\n        from: moment(this.date.from).format('YYYY-MM-DD'),\r\n        to: moment(this.date.to).format('YYYY-MM-DD')\r\n      }).then(() => {\r\n        this.vToasted('success', 'Remove inventory schedules successfully.')\r\n        this.fetchSchedule()\r\n      }).catch(() => {\r\n        this.isBusy = false\r\n        this.vToasted('error', 'Could not remove inventory schedules.')\r\n      })\r\n    },\r\n    removeOneSchedule() {\r\n      this.isBusy = true\r\n      this.removeOneInventorySchedule({\r\n        report_id: this.info._id,\r\n        marketplace: this.marketplace,\r\n        id: this.selectedSchedule._id\r\n      }).then(() => {\r\n        this.selectedSchedule = null\r\n        this.vToasted('success', 'Remove inventory schedule successfully.')\r\n        this.fetchSchedule()\r\n      }).catch(() => {\r\n        this.isBusy = false\r\n        this.vToasted('error', 'Could not remove inventory schedule.')\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.initInventoryDatePicker()\r\n    this.info && this.fetchSchedule()\r\n  },\r\n  filters: {\r\n    formatDate(dateTime) {\r\n      return moment(dateTime).format('MM/DD/YYYY')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.spinner-container {\r\n  height: 50px;\r\n\r\n  .thin-spinner {\r\n    border-width: 1px;\r\n  }\r\n}\r\n.w-110 {\r\n  width: 110px;\r\n}\r\n\r\n.custom-datepicker-fromto ::v-deep {\r\n  .form-control {\r\n    border-top-left-radius: 0;\r\n    border-bottom-left-radius: 0;\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/page/reports"}]}