{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\dashboard\\DashboardIndex.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\dashboard\\DashboardIndex.vue","mtime":1638862950808},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1620898435163},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport _nav from '@/_nav'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport _ from 'lodash'\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport { allSellers, sellersTypeFields } from './configOptions'\r\nimport HeaderComponent from './Header'\r\nimport { ReportMarketplaces, MarketPlacesResult, AllSellerMode, DashboardFilterSourceType } from '@/constants/Report'\r\nimport { getMarketplaceLabelByType } from '@/shared/utils'\r\nimport vToasted from '@/shared/notification'\r\nexport default {\r\n  name: 'MWDashboardIndex',\r\n  components: {\r\n    HeaderComponent\r\n  },\r\n  mixins: [vToasted],\r\n  data: () => ({\r\n    MarketPlacesResult,\r\n    ReportMarketplaces,\r\n    AllSellerMode,\r\n    DashboardFilterSourceType,\r\n    sourceAllSellerOptions: [\r\n      { value: DashboardFilterSourceType.VIOLATIONS, text: 'Violations' },\r\n      { value: DashboardFilterSourceType.ALL_SELLERS, text: 'All Items' }\r\n    ],\r\n    sourceAuthorizedOnlyOptions: [\r\n      { value: DashboardFilterSourceType.VIOLATIONS, text: 'Violations' },\r\n      { value: DashboardFilterSourceType.ALL_SELLERS, text: 'All Authorized Items' }\r\n    ],\r\n    sourceRogueOnlyOptions: [\r\n      { value: DashboardFilterSourceType.VIOLATIONS, text: 'Violations' },\r\n      { value: DashboardFilterSourceType.ALL_SELLERS, text: 'All Rogue Items' }\r\n    ],\r\n    queryOptions: {\r\n      active: true\r\n    },\r\n    settings: {\r\n      show_dashboard: true\r\n    },\r\n    routeDashboardMain: 'MWDashboardMain',\r\n    routeDashboardHistorical: 'MWDashboardHistorical',\r\n    selected: {\r\n      report: null,\r\n      marketplace: null,\r\n      marketplace_string_prefix: 'marketplace_',\r\n      seller_type: null,\r\n      fulfillment: '',\r\n      share_token: null,\r\n      source: DashboardFilterSourceType.VIOLATIONS,\r\n      options: {\r\n        marketplaces: [],\r\n        seller_type: [],\r\n        fulfillment: [\r\n          { label: 'All', value: '' },\r\n          { label: 'FBA', value: 'FBA' },\r\n          { label: 'MFN', value: 'MFN' }\r\n        ]\r\n      }\r\n    },\r\n    nav: _nav,\r\n    isLoading: true\r\n  }),\r\n  methods: {\r\n    ...mapActions({\r\n      fetchReports: `mw/dashboard/${TYPE.FETCH_LIST_REPORTS}`,\r\n      mainConfig: `mw/dashboard/${TYPE.GET_DATA_CONFIG_VIOLATOR}`,\r\n      remoteFetchSetting: `mw/settings/${TYPE.FETCH_SETTING}`\r\n    }),\r\n    keepShareTokenForQuery() {\r\n      let query = {\r\n        report: this.selected.report.name_in_dashboard,\r\n        marketplace: this.selected.marketplace,\r\n        seller_type: this.selected.seller_type,\r\n        fulfillment: this.selected.fulfillment,\r\n        source: this.selected.source\r\n      }\r\n      if (this.selected.share_token) {\r\n        _.assign(query, { share_token: this.selected.share_token })\r\n      }\r\n      return query\r\n    },\r\n    hanldeChangeReportName() {\r\n      const val = this.selected.marketplace\r\n      this.selected.options.seller_type = []\r\n      if (val === ReportMarketplaces.google_shopping) {\r\n        this.selected.seller_type = allSellers.value\r\n        this.selected.options.seller_type.push(allSellers)\r\n      } else if (_.includes(_.values(MarketPlacesResult), val.replace(/[_]/g, '.'))) {\r\n        if ((!this.selected.report.separate_mfn_fba_authorized_seller && this.selected.report.list_authorized_seller_names.length === 0) || (this.selected.report.separate_mfn_fba_authorized_seller &&\r\n          this.selected.report.mfn_authorized_seller_names.length === 0 &&\r\n          this.selected.report.fba_authorized_seller_names.length === 0)) {\r\n          this.selected.seller_type = allSellers.value\r\n          this.selected.options.seller_type.push(allSellers)\r\n        } else {\r\n          this.selected.options.seller_type = _.cloneDeep(sellersTypeFields)\r\n          if (this.selected.options.seller_type.length) {\r\n            this.selected.seller_type = this.selected.options.seller_type[0].value\r\n          }\r\n        }\r\n      }\r\n      const query = this.keepShareTokenForQuery()\r\n\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    handleChangeSource() {\r\n      const query = this.keepShareTokenForQuery()\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    handleChangeSellerType() {\r\n      const query = this.keepShareTokenForQuery()\r\n\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    needToHideSourceTypeFilter() {\r\n      const allSellerMode = this.getMarketplaceInfoDoc(this.selected.report, this.selected.marketplace).all_seller_mode || AllSellerMode.NONE\r\n      if (allSellerMode === AllSellerMode.NONE) {\r\n        this.selected.source = DashboardFilterSourceType.VIOLATIONS\r\n        return true\r\n      }\r\n      return false\r\n    },\r\n    getMarketplaceInfoDoc(report, marketplace) {\r\n      return report[`${this.getMarketplaceInfoKey(marketplace)}`]\r\n    },\r\n    getMarketplaceInfoKey(marketplace) {\r\n      marketplace = this.convertMarketplaceEnumToMarketplaceStringInfo(marketplace)\r\n      return `${this.selected.marketplace_string_prefix}${marketplace}`\r\n    },\r\n    convertMarketplaceEnumToMarketplaceStringInfo(marketplace) {\r\n      if (_.includes(marketplace, 'amazon')) {\r\n        return marketplace.replace(/[.]/g, '_')\r\n      }\r\n      return marketplace\r\n    },\r\n    getCurrentSourceOption() {\r\n      const allSellerMode = this.getMarketplaceInfoDoc(this.selected.report, this.selected.marketplace).all_seller_mode || AllSellerMode.NONE\r\n      switch (allSellerMode) {\r\n        case AllSellerMode.AUTHORIZED_ONLY:\r\n          return this.sourceAuthorizedOnlyOptions\r\n        case AllSellerMode.ROGUE_ONLY:\r\n          return this.sourceRogueOnlyOptions\r\n        case AllSellerMode.NONE:\r\n        case AllSellerMode.BOTH:\r\n          return this.sourceAllSellerOptions\r\n      }\r\n    },\r\n    async fetchSettings() {\r\n      const existShareToken = _.has(this.$route.query, 'token')\r\n      if (!existShareToken) {\r\n        const { id } = this.$route.params\r\n        try {\r\n          const result = await this.remoteFetchSetting({ id })\r\n          return result.show_dashboard\r\n        } catch (error) {\r\n          let message = _.get(error, 'response.data.message', null)\r\n          if (message) {\r\n            this.vToasted('error', message)\r\n          } else {\r\n            console.log(error)\r\n          }\r\n        }\r\n      }\r\n      return true\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      reports: `mw/dashboard/${TYPE.GET_LIST_REPORTS}`\r\n    }),\r\n    filterReports() {\r\n      return this.reports\r\n    },\r\n    queryParams() {\r\n      return this.$route.query || {}\r\n    },\r\n    sharableRoute () {\r\n      const routeRegrex = /\\/share\\//\r\n      return routeRegrex.test(this.$route.path) ? 'Share' : ''\r\n    }\r\n  },\r\n  async created() {\r\n    const existShareToken = _.has(this.$route.query, 'share_token')\r\n    let params = {\r\n      active_only: this.queryOptions.active,\r\n      limit: 99,\r\n      // must keep this order\r\n      sort_by: 'order',\r\n      sort_dir: 'asc'\r\n    }\r\n    this.selected.source = DashboardFilterSourceType.VIOLATIONS\r\n    this.settings.show_dashboard = true\r\n    if (existShareToken) {\r\n      this.routeDashboardHistorical = 'MWShareDashboardHistorical'\r\n      this.routeDashboardMain = 'MWShareDashboardMain'\r\n      const shareToken = this.$route.query.share_token\r\n      _.assign(params, { share_token: shareToken })\r\n      this.selected.share_token = shareToken\r\n    } else {\r\n      this.settings.show_dashboard = await this.fetchSettings()\r\n    }\r\n    if (this.settings.show_dashboard) {\r\n      this.fetchReports(params).then(res => {\r\n        this.isLoading = false\r\n      }).catch(res => {\r\n        this.isLoading = false\r\n      })\r\n    }\r\n  },\r\n  async syncedReportName() {\r\n    this.hanldeChangeReportName()\r\n  },\r\n  watch: {\r\n    filterReports(val) {\r\n      if (val.items.length) {\r\n        this.selected.report = val.items[0]\r\n        const existReportName = _.has(this.$route.query, 'report')\r\n        if (existReportName) {\r\n          const reportName = this.$route.query.report\r\n          const index = _.findIndex(val.items, function(value) { return reportName.toLowerCase() === value.name_in_dashboard.toLowerCase() })\r\n          if (index > 0) {\r\n            this.selected.report = val.items[index]\r\n          }\r\n        }\r\n      }\r\n    },\r\n    'selected.report'(val) {\r\n      this.selected.marketplace = null\r\n      this.selected.options.marketplace = []\r\n      this.selected.seller_type = null\r\n      this.selected.options.seller_type = []\r\n      _.forEach(val.marketplaces, (v, k) => {\r\n        if (v) {\r\n          this.selected.options.marketplace.push({\r\n            label: getMarketplaceLabelByType(k),\r\n            value: k\r\n          })\r\n        }\r\n      })\r\n      if (!_.isEmpty(this.selected.options.marketplace)) {\r\n        const existMarketplace = _.has(this.$route.query, 'marketplace')\r\n        if (existMarketplace && _.find(this.selected.options.marketplace, { value: this.$route.query.marketplace })) {\r\n          this.selected.marketplace = this.$route.query.marketplace\r\n        } else {\r\n          this.selected.marketplace = this.selected.options.marketplace[0].value\r\n        }\r\n        this.hanldeChangeReportName()\r\n      }\r\n      let query = this.keepShareTokenForQuery()\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    'selected.marketplace'(val) {\r\n      this.hanldeChangeReportName()\r\n    },\r\n    'selected.seller_type'(val) {\r\n      this.handleChangeSellerType()\r\n    },\r\n    'selected.fulfillment'(val) {\r\n      this.handleChangeSellerType()\r\n    },\r\n    'selected.source'(val) {\r\n      this.handleChangeSource()\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["DashboardIndex.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DashboardIndex.vue","sourceRoot":"src/components/page/dashboard","sourcesContent":["<template>\r\n    <div v-if=\"filterReports.items.length > 0 && settings.show_dashboard && !isLoading\">\r\n      <div class=\"card mw-header__bg\">\r\n        <header-component :needToHideSourceTypeFilter=\"needToHideSourceTypeFilter\" :getCurrentSourceOption=\"getCurrentSourceOption\" v-model=\"selected\" :reports=\"filterReports\"></header-component>\r\n      </div>\r\n      <div class=\"mw-main card\">\r\n        <div class=\"animated fadeIn\">\r\n          <div class=\"main-board pb-0\">\r\n            <ul class=\"widgets-nav nav nav-tabs\">\r\n              <li class=\"nav-item\">\r\n                <router-link\r\n                  class=\"nav-link\"\r\n                  active-class=\"active\"\r\n                  :to=\"{name: `MW${sharableRoute}DashboardMain`, params: {client_id: nav.clientId}, query: queryParams}\"\r\n                >Dashboard</router-link>\r\n              </li>\r\n              <li class=\"nav-item\">\r\n                <router-link\r\n                  class=\"nav-link\"\r\n                  active-class=\"active\"\r\n                  :to=\"{name: `MW${sharableRoute}DashboardHistorical`, params: {client_id: nav.clientId}, query: queryParams}\"\r\n                >Historical</router-link>\r\n              </li>\r\n            </ul>\r\n            <router-view :selected=\"selected\" v-if=\"selected.report\"></router-view>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div v-else-if=\"!settings.show_dashboard\">\r\n      <div class=\"card bg-secondary\">\r\n        <div class=\"card-body\">\r\n          <p class=\"mb-0 text-center\">\r\n            Your dashboard has been disabled temporarily.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div v-else>\r\n      <div v-if=\"!isLoading\" class=\"card bg-secondary\">\r\n        <div class=\"card-body\">\r\n          <p class=\"mb-0 text-center\">\r\n            This workspace does not have any active reports.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport _nav from '@/_nav'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport _ from 'lodash'\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport { allSellers, sellersTypeFields } from './configOptions'\r\nimport HeaderComponent from './Header'\r\nimport { ReportMarketplaces, MarketPlacesResult, AllSellerMode, DashboardFilterSourceType } from '@/constants/Report'\r\nimport { getMarketplaceLabelByType } from '@/shared/utils'\r\nimport vToasted from '@/shared/notification'\r\nexport default {\r\n  name: 'MWDashboardIndex',\r\n  components: {\r\n    HeaderComponent\r\n  },\r\n  mixins: [vToasted],\r\n  data: () => ({\r\n    MarketPlacesResult,\r\n    ReportMarketplaces,\r\n    AllSellerMode,\r\n    DashboardFilterSourceType,\r\n    sourceAllSellerOptions: [\r\n      { value: DashboardFilterSourceType.VIOLATIONS, text: 'Violations' },\r\n      { value: DashboardFilterSourceType.ALL_SELLERS, text: 'All Items' }\r\n    ],\r\n    sourceAuthorizedOnlyOptions: [\r\n      { value: DashboardFilterSourceType.VIOLATIONS, text: 'Violations' },\r\n      { value: DashboardFilterSourceType.ALL_SELLERS, text: 'All Authorized Items' }\r\n    ],\r\n    sourceRogueOnlyOptions: [\r\n      { value: DashboardFilterSourceType.VIOLATIONS, text: 'Violations' },\r\n      { value: DashboardFilterSourceType.ALL_SELLERS, text: 'All Rogue Items' }\r\n    ],\r\n    queryOptions: {\r\n      active: true\r\n    },\r\n    settings: {\r\n      show_dashboard: true\r\n    },\r\n    routeDashboardMain: 'MWDashboardMain',\r\n    routeDashboardHistorical: 'MWDashboardHistorical',\r\n    selected: {\r\n      report: null,\r\n      marketplace: null,\r\n      marketplace_string_prefix: 'marketplace_',\r\n      seller_type: null,\r\n      fulfillment: '',\r\n      share_token: null,\r\n      source: DashboardFilterSourceType.VIOLATIONS,\r\n      options: {\r\n        marketplaces: [],\r\n        seller_type: [],\r\n        fulfillment: [\r\n          { label: 'All', value: '' },\r\n          { label: 'FBA', value: 'FBA' },\r\n          { label: 'MFN', value: 'MFN' }\r\n        ]\r\n      }\r\n    },\r\n    nav: _nav,\r\n    isLoading: true\r\n  }),\r\n  methods: {\r\n    ...mapActions({\r\n      fetchReports: `mw/dashboard/${TYPE.FETCH_LIST_REPORTS}`,\r\n      mainConfig: `mw/dashboard/${TYPE.GET_DATA_CONFIG_VIOLATOR}`,\r\n      remoteFetchSetting: `mw/settings/${TYPE.FETCH_SETTING}`\r\n    }),\r\n    keepShareTokenForQuery() {\r\n      let query = {\r\n        report: this.selected.report.name_in_dashboard,\r\n        marketplace: this.selected.marketplace,\r\n        seller_type: this.selected.seller_type,\r\n        fulfillment: this.selected.fulfillment,\r\n        source: this.selected.source\r\n      }\r\n      if (this.selected.share_token) {\r\n        _.assign(query, { share_token: this.selected.share_token })\r\n      }\r\n      return query\r\n    },\r\n    hanldeChangeReportName() {\r\n      const val = this.selected.marketplace\r\n      this.selected.options.seller_type = []\r\n      if (val === ReportMarketplaces.google_shopping) {\r\n        this.selected.seller_type = allSellers.value\r\n        this.selected.options.seller_type.push(allSellers)\r\n      } else if (_.includes(_.values(MarketPlacesResult), val.replace(/[_]/g, '.'))) {\r\n        if ((!this.selected.report.separate_mfn_fba_authorized_seller && this.selected.report.list_authorized_seller_names.length === 0) || (this.selected.report.separate_mfn_fba_authorized_seller &&\r\n          this.selected.report.mfn_authorized_seller_names.length === 0 &&\r\n          this.selected.report.fba_authorized_seller_names.length === 0)) {\r\n          this.selected.seller_type = allSellers.value\r\n          this.selected.options.seller_type.push(allSellers)\r\n        } else {\r\n          this.selected.options.seller_type = _.cloneDeep(sellersTypeFields)\r\n          if (this.selected.options.seller_type.length) {\r\n            this.selected.seller_type = this.selected.options.seller_type[0].value\r\n          }\r\n        }\r\n      }\r\n      const query = this.keepShareTokenForQuery()\r\n\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    handleChangeSource() {\r\n      const query = this.keepShareTokenForQuery()\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    handleChangeSellerType() {\r\n      const query = this.keepShareTokenForQuery()\r\n\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    needToHideSourceTypeFilter() {\r\n      const allSellerMode = this.getMarketplaceInfoDoc(this.selected.report, this.selected.marketplace).all_seller_mode || AllSellerMode.NONE\r\n      if (allSellerMode === AllSellerMode.NONE) {\r\n        this.selected.source = DashboardFilterSourceType.VIOLATIONS\r\n        return true\r\n      }\r\n      return false\r\n    },\r\n    getMarketplaceInfoDoc(report, marketplace) {\r\n      return report[`${this.getMarketplaceInfoKey(marketplace)}`]\r\n    },\r\n    getMarketplaceInfoKey(marketplace) {\r\n      marketplace = this.convertMarketplaceEnumToMarketplaceStringInfo(marketplace)\r\n      return `${this.selected.marketplace_string_prefix}${marketplace}`\r\n    },\r\n    convertMarketplaceEnumToMarketplaceStringInfo(marketplace) {\r\n      if (_.includes(marketplace, 'amazon')) {\r\n        return marketplace.replace(/[.]/g, '_')\r\n      }\r\n      return marketplace\r\n    },\r\n    getCurrentSourceOption() {\r\n      const allSellerMode = this.getMarketplaceInfoDoc(this.selected.report, this.selected.marketplace).all_seller_mode || AllSellerMode.NONE\r\n      switch (allSellerMode) {\r\n        case AllSellerMode.AUTHORIZED_ONLY:\r\n          return this.sourceAuthorizedOnlyOptions\r\n        case AllSellerMode.ROGUE_ONLY:\r\n          return this.sourceRogueOnlyOptions\r\n        case AllSellerMode.NONE:\r\n        case AllSellerMode.BOTH:\r\n          return this.sourceAllSellerOptions\r\n      }\r\n    },\r\n    async fetchSettings() {\r\n      const existShareToken = _.has(this.$route.query, 'token')\r\n      if (!existShareToken) {\r\n        const { id } = this.$route.params\r\n        try {\r\n          const result = await this.remoteFetchSetting({ id })\r\n          return result.show_dashboard\r\n        } catch (error) {\r\n          let message = _.get(error, 'response.data.message', null)\r\n          if (message) {\r\n            this.vToasted('error', message)\r\n          } else {\r\n            console.log(error)\r\n          }\r\n        }\r\n      }\r\n      return true\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      reports: `mw/dashboard/${TYPE.GET_LIST_REPORTS}`\r\n    }),\r\n    filterReports() {\r\n      return this.reports\r\n    },\r\n    queryParams() {\r\n      return this.$route.query || {}\r\n    },\r\n    sharableRoute () {\r\n      const routeRegrex = /\\/share\\//\r\n      return routeRegrex.test(this.$route.path) ? 'Share' : ''\r\n    }\r\n  },\r\n  async created() {\r\n    const existShareToken = _.has(this.$route.query, 'share_token')\r\n    let params = {\r\n      active_only: this.queryOptions.active,\r\n      limit: 99,\r\n      // must keep this order\r\n      sort_by: 'order',\r\n      sort_dir: 'asc'\r\n    }\r\n    this.selected.source = DashboardFilterSourceType.VIOLATIONS\r\n    this.settings.show_dashboard = true\r\n    if (existShareToken) {\r\n      this.routeDashboardHistorical = 'MWShareDashboardHistorical'\r\n      this.routeDashboardMain = 'MWShareDashboardMain'\r\n      const shareToken = this.$route.query.share_token\r\n      _.assign(params, { share_token: shareToken })\r\n      this.selected.share_token = shareToken\r\n    } else {\r\n      this.settings.show_dashboard = await this.fetchSettings()\r\n    }\r\n    if (this.settings.show_dashboard) {\r\n      this.fetchReports(params).then(res => {\r\n        this.isLoading = false\r\n      }).catch(res => {\r\n        this.isLoading = false\r\n      })\r\n    }\r\n  },\r\n  async syncedReportName() {\r\n    this.hanldeChangeReportName()\r\n  },\r\n  watch: {\r\n    filterReports(val) {\r\n      if (val.items.length) {\r\n        this.selected.report = val.items[0]\r\n        const existReportName = _.has(this.$route.query, 'report')\r\n        if (existReportName) {\r\n          const reportName = this.$route.query.report\r\n          const index = _.findIndex(val.items, function(value) { return reportName.toLowerCase() === value.name_in_dashboard.toLowerCase() })\r\n          if (index > 0) {\r\n            this.selected.report = val.items[index]\r\n          }\r\n        }\r\n      }\r\n    },\r\n    'selected.report'(val) {\r\n      this.selected.marketplace = null\r\n      this.selected.options.marketplace = []\r\n      this.selected.seller_type = null\r\n      this.selected.options.seller_type = []\r\n      _.forEach(val.marketplaces, (v, k) => {\r\n        if (v) {\r\n          this.selected.options.marketplace.push({\r\n            label: getMarketplaceLabelByType(k),\r\n            value: k\r\n          })\r\n        }\r\n      })\r\n      if (!_.isEmpty(this.selected.options.marketplace)) {\r\n        const existMarketplace = _.has(this.$route.query, 'marketplace')\r\n        if (existMarketplace && _.find(this.selected.options.marketplace, { value: this.$route.query.marketplace })) {\r\n          this.selected.marketplace = this.$route.query.marketplace\r\n        } else {\r\n          this.selected.marketplace = this.selected.options.marketplace[0].value\r\n        }\r\n        this.hanldeChangeReportName()\r\n      }\r\n      let query = this.keepShareTokenForQuery()\r\n      this.$router.push({\r\n        params: {\r\n          client_id: this.nav.clientId\r\n        },\r\n        query: query\r\n      })\r\n    },\r\n    'selected.marketplace'(val) {\r\n      this.hanldeChangeReportName()\r\n    },\r\n    'selected.seller_type'(val) {\r\n      this.handleChangeSellerType()\r\n    },\r\n    'selected.fulfillment'(val) {\r\n      this.handleChangeSellerType()\r\n    },\r\n    'selected.source'(val) {\r\n      this.handleChangeSource()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.main-board {\r\n  padding-bottom: 10px;\r\n}\r\n.mw-main {\r\n  overflow: hidden;\r\n  .cbpo-pagination button.current{\r\n    background-color: #57719b !important;\r\n  }\r\n}\r\n.widgets-nav {\r\n  .nav-item:first-child {\r\n    .nav-link {\r\n      border-left: 0;\r\n    }\r\n  }\r\n  .nav-link {\r\n    border-top: 0!important;\r\n    border-radius: 0!important;\r\n    &.active {\r\n      position: relative;\r\n      &:before {\r\n        content: '';\r\n        position: absolute;\r\n        width: 100%;\r\n        top: 0;\r\n        left: 0;\r\n        height: 4px;\r\n        background: #50a3a2;\r\n        border: 1px solid #50a3a2;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}