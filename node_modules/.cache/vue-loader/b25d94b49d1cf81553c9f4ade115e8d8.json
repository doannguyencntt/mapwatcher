{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\settings\\Setting.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\settings\\Setting.vue","mtime":1639556685436},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\index.js","mtime":1620898435762},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1620898436811},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\postcss-loader\\src\\index.js","mtime":1620898436496},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\sass-loader\\lib\\loader.js","mtime":1626076778407},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ninput[type=file] {\n  color: white;\n}\n\n.pointer {\n  cursor: pointer;\n}\n",{"version":3,"sources":["Setting.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4SA;AACA;AACA;;AAEA;AACA;AACA","file":"Setting.vue","sourceRoot":"src/components/page/settings","sourcesContent":["<template>\r\n  <div class=\"animated fadeIn\">\r\n    <b-row>\r\n      <b-col md=\"6\" lg=\"6\" sm=\"12\">\r\n        <b-card footer-tag=\"footer\">\r\n          <div slot=\"header\" class=\"d-flex justify-content-between align-items-center\">\r\n            <span><strong>Edit Settings</strong></span>\r\n          </div>\r\n          <b-form>\r\n            <b-row>\r\n              <b-col md=\"4\" lg=\"4\" sm=\"8\">\r\n                <b-form-group>\r\n                  <label for=\"#\">\r\n                    <b>Show dashboard</b>\r\n                  </label>\r\n                </b-form-group>\r\n              </b-col>\r\n              <b-col md=\"2\" lg=\"2\" sm=\"4\">\r\n                <div class=\"d-flex flex-row\">\r\n                  <b-form-checkbox\r\n                          v-model=\"data.show_dashboard\"\r\n                          class=\"mr-4 font-weight-light\"\r\n                          :disabled=\"getPermissions.role !== 'admin' && getPermissions.role !== 'owner'\"\r\n                          switch\r\n                  ></b-form-checkbox>\r\n                </div>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row>\r\n              <b-col md=\"12\">\r\n                <b-form-group>\r\n                  <label>\r\n                    <b>Default report logo</b>\r\n                  </label>\r\n                  <b-row class=\"align-items-center\">\r\n                    <b-col md=\"2\">\r\n                      <img\r\n                              :src=\"data.default_brand_logo ? data.default_brand_logo : reportLogo\"\r\n                              class=\"mw-img-report my-1 img-thumbnail mx-auto d-block\"\r\n                              alt=\"Left image\"\r\n                      />\r\n                      <b-button\r\n                              size=\"sm\"\r\n                              variant=\"warning\"\r\n                              v-if=\"data.default_brand_logo\"\r\n                              @click=\"removeLogo()\"\r\n                              class=\"d-block mx-auto btn-remove\"\r\n                      >\r\n                        Remove\r\n                      </b-button>\r\n                    </b-col>\r\n                    <b-col md=\"10\">\r\n                      <b-form-file ref=\"file-input\" @change=\"handleImagesFileUpload($event)\"></b-form-file>\r\n                    </b-col>\r\n                  </b-row>\r\n                </b-form-group>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row v-if=\"planConfig.seller_investigation_dashboard\" class=\"seller_investigation_dashboard\">\r\n              <b-col md=\"5\" lg=\"5\" sm=\"12\">\r\n                <b-form-group>\r\n                  <label for=\"#\">\r\n                    <b>Sellers & Investigations Listing Brand Name</b>\r\n                  </label>\r\n                </b-form-group>\r\n              </b-col>\r\n              <b-col md=\"7\" lg=\"7\" sm=\"10\">\r\n                <div class=\"d-flex flex-row\">\r\n                  <b-form-input\r\n                          v-model=\"data.si_listing_brand_name\"\r\n                          class=\"font-weight-light\"\r\n                  ></b-form-input>\r\n                </div>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row v-if=\"planConfig.seller_enforcement_enabled\" class=\"seller_enforcement_enabled\">\r\n              <b-col md=\"12\">\r\n                <b-form-group>\r\n                  <b-row>\r\n                    <b-col md=\"5\">\r\n                      <label>\r\n                        <b>Map Pricing Policy Document</b>\r\n                        <div class=\"mw-error ml-0\">This file will be attached to the Seller Enforcement violation emails.</div>\r\n                      </label>\r\n                    </b-col>\r\n                    <b-col md=\"7\">\r\n                      <b>Update new policy document</b>\r\n                      <b-form-file ref=\"policyFileInput\" class=\"mt-2\" :file-name-formatter=\"formatNames\" @change=\"handleUploadMapPricingPolicyDocument($event)\" placeholder=\"Select new file\"></b-form-file>\r\n                    </b-col>\r\n                  </b-row>\r\n                  <b-row>\r\n                    <b-col md=\"5\" class=\"mt-2\" v-if=\"data.map_pricing_policy_document && data.map_pricing_policy_document.url && data.map_pricing_policy_document.url !== ''\">\r\n                      Current file <u @click=\"downloadFile()\" class=\"pointer\">{{ data.map_pricing_policy_document.file_name }}</u>\r\n                    </b-col>\r\n                    <b-col md=\"7\" class=\"text-right\" v-if=\"data.map_pricing_policy_document && data.map_pricing_policy_document.url && data.map_pricing_policy_document.url !== ''\">\r\n                      <b-button size=\"sm\" class=\"mt-2 ml-1\" @click=\"downloadFile()\" :disabled=\"isLoading\"><i class=\"fa fa-download\" /> Download</b-button>\r\n                      <b-button size=\"sm\" class=\"mt-2 ml-1\" v-b-modal.remove-file-modal :disabled=\"isLoading\"><i class=\"fa fa-trash\" /> Remove</b-button>\r\n                      <span\r\n                        id=\"policy-control-button\"\r\n                        class=\"d-inline-block\"\r\n                        tabindex=\"0\"\r\n                        v-b-tooltip.hover=\"{disabled: policyUpdated}\"\r\n                        title=\"Please save your settings first!\"\r\n                      >\r\n                        <b-button\r\n                          v-b-modal=\"policyModalID\"\r\n                          class=\"btn-sm mt-2 ml-1\"\r\n                          target=\"_self\"\r\n                          :disabled=\"(newPolicyUploaded && !policyUpdated) || isLoading\"\r\n                          title=\"Send Email\"\r\n                        >\r\n                          <i class=\"fa fa-paper-plane\" /> Notify\r\n                        </b-button>\r\n                      </span>\r\n                    </b-col>\r\n                  </b-row>\r\n                </b-form-group>\r\n              </b-col>\r\n            </b-row>\r\n          </b-form>\r\n          <em slot=\"footer\">\r\n            <b-button class=\"mr-1\" variant=\"primary\" :disabled=\"(getPermissions.role !== 'admin' && getPermissions.role !== 'owner') || isLoading\" size=\"sm\" @click=\"handleUpdateSetting\">\r\n              <i class=\"fa fa-dot-circle-o\"></i> Save Settings\r\n            </b-button>\r\n          </em>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n    <PolicyNotificationModal :id=\"policyModalID\"/>\r\n    <b-modal id=\"remove-file-modal\"  title=\"Please confirm\" centered @ok=\"removePolicyFile()\" ok-variant=\"danger\">\r\n      Are you sure you want to remove current policy document?\r\n      <template v-slot:modal-footer=\"{ ok, cancel }\">\r\n        <b-button variant=\"warning\" @click=\"ok()\"> <i class=\"icon-check\"></i> Yes, I understand &amp; confirm! </b-button>\r\n        <b-button variant @click=\"cancel()\"> <i class=\"icon-close\"></i> No </b-button>\r\n      </template>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport _nav from '@/_nav'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport vToasted from '@/shared/notification'\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport PermissionsMixin from '@/components/common/PermissionsMixin'\r\nimport reportLogo from '@/assets/img/report-demo.jpg'\r\nimport PolicyNotificationModal from './PolicyNotificationModal.vue'\r\nimport get from 'lodash/get'\r\nexport default {\r\n  components: { PolicyNotificationModal },\r\n  data() {\r\n    return {\r\n      reportLogo,\r\n      isLoading: false,\r\n      data: {\r\n        show_dashboard: true,\r\n        si_listing_brand_name: '',\r\n        default_brand_logo: '',\r\n        map_pricing_policy_document: {\r\n          url: '',\r\n          file_name: ''\r\n        }\r\n      },\r\n      originData: {},\r\n      nav: _nav,\r\n      policyModalID: 'policy-sending-confirmation',\r\n      policyUpdated: false\r\n    }\r\n  },\r\n  mixins: [vToasted, PermissionsMixin],\r\n  methods: {\r\n    ...mapActions({\r\n      remoteFetchSetting: `mw/settings/${TYPE.FETCH_SETTING}`,\r\n      remoteUpdateSetting: `mw/settings/${TYPE.REMOTE_EDIT_SETTING}`,\r\n      remoteImagesFileUpload: `mw/images/${TYPE.REMOTE_UPLOAD_IMAGES}`,\r\n      remoteFileUpload: `mw/settings/${TYPE.REMOTE_UPLOAD_FILES}`\r\n    }),\r\n    async handleImagesFileUpload(e) {\r\n      this.isLoading = true\r\n      let formData = new FormData()\r\n      formData.append('file', e.target.files[0])\r\n      formData.append('type', 'brand_logos')\r\n      try {\r\n        const res = await this.remoteImagesFileUpload(formData)\r\n        this.data.default_brand_logo = res.url\r\n        this.vToasted('success', `Your file is uploaded successfully.`)\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    },\r\n    async handleUploadMapPricingPolicyDocument(e) {\r\n      this.isLoading = true\r\n      let formData = new FormData()\r\n      formData.append('file', e.target.files[0])\r\n      formData.append('type', 'map_pricing_policy_document')\r\n      try {\r\n        const res = await this.remoteFileUpload(formData)\r\n        // eslint-disable-next-line\r\n        const { url, file_name } = res\r\n        this.data.map_pricing_policy_document.url = url\r\n        // eslint-disable-next-line\r\n        this.data.map_pricing_policy_document.file_name = file_name\r\n        this.vToasted('success', `Your file is uploaded successfully.`)\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    },\r\n    removeLogo() {\r\n      this.data.default_brand_logo = ''\r\n    },\r\n    removePolicyFile() {\r\n      this.data.map_pricing_policy_document.url = ''\r\n      this.data.map_pricing_policy_document.file_name = ''\r\n      this.$refs.policyFileInput.reset()\r\n    },\r\n    downloadFile() {\r\n      window.location.href = this.data.map_pricing_policy_document.url\r\n    },\r\n    formatNames(files) {\r\n      const name = files[0].name\r\n      return name.length > 20 ? `${name.substr(0, 15)}...` : name\r\n    },\r\n    async handleUpdateSetting() {\r\n      this.isLoading = true\r\n      try {\r\n        /* eslint-disable */\r\n        const { client_id } = this.$route.params\r\n        await this.remoteUpdateSetting({ params: this.data, client_id })\r\n        this.vToasted('success', `Settings have been updated successfully.`)\r\n        this.policyUpdated = true\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    },\r\n    async handleFetchAndReloadData() {\r\n      this.isLoading = true\r\n      try {\r\n        /* eslint-disable */\r\n        const { client_id } = this.$route.params\r\n        const result = await this.remoteFetchSetting({ client_id })\r\n        this.data.show_dashboard = result.show_dashboard\r\n        this.data.si_listing_brand_name = result.si_listing_brand_name\r\n        this.data.default_brand_logo = result.default_brand_logo\r\n        this.data.map_pricing_policy_document.url = result.map_pricing_policy_document.url\r\n        this.data.map_pricing_policy_document.file_name = result.map_pricing_policy_document.file_name\r\n        // backup originData\r\n        this.originData = JSON.parse(JSON.stringify(this.data))\r\n      } catch (error) {\r\n        let message = get(error, 'response.data.message', null)\r\n        if (message) {\r\n          this.vToasted('error', message)\r\n        } else {\r\n          console.log(error)\r\n        }\r\n      }\r\n      this.isLoading = false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      getPermissions: `mw/${TYPE.GET_PERMISSIONS}`,\r\n      // defaultParams: `mw/reports/${TYPE.GET_DEFAULT_PARAMS}`,\r\n      planConfig: `mw/${TYPE.GET_PLAN_CONFIG}`\r\n    }),\r\n    capitalize: function() {\r\n      return (str) => str[0].toUpperCase() + str.slice(1)\r\n    },\r\n    // params: function() {\r\n    //   return {...this.defaultParams} || {}\r\n    // },\r\n    newPolicyUploaded() {\r\n      return (\r\n        this.data.map_pricing_policy_document.url !==\r\n        this.originData.map_pricing_policy_document.url\r\n      )\r\n    }\r\n  },\r\n  created() {\r\n    this.handleFetchAndReloadData()\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n  input[type=file] {\r\n    color: white;\r\n  }\r\n\r\n  .pointer {\r\n    cursor: pointer;\r\n  }\r\n</style>\r\n"]}]}