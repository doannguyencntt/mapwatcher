{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\brands\\TableContent.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\brands\\TableContent.vue","mtime":1630397415259},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1620898435163},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapGetters } from 'vuex'\r\nimport { GET_PERMISSIONS, GET_DEFAULT_PARAMS } from '@/actionTypes.js'\r\nimport moment from 'moment'\r\n\r\nexport default {\r\n  name: 'c-table',\r\n  inheritAttrs: false,\r\n  props: {\r\n    caption: {\r\n      type: String,\r\n      default: 'Table'\r\n    },\r\n    hover: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    striped: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    bordered: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    small: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    fixed: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    tableData: {\r\n      type: [Array, Function],\r\n      default: () => []\r\n    },\r\n    fields: {\r\n      type: [Array, Object],\r\n      default: () => []\r\n    },\r\n    dark: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    removeBrands: {\r\n      type: [Function]\r\n    },\r\n    handleEditBrand: {\r\n      type: [Function]\r\n    },\r\n    handleRun: {\r\n      type: [Function]\r\n    },\r\n    totalRows: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    dataSet: {\r\n      type: [Array, Object]\r\n    },\r\n    handleExportForJob: {\r\n      type: [Function]\r\n    }\r\n  },\r\n  data: () => {\r\n    return {\r\n      dialog: {\r\n        remove: false,\r\n        run: false,\r\n        cancel: false\r\n      },\r\n      selected: {\r\n        remove: null,\r\n        run: null\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({ getPermissions: `mw/${GET_PERMISSIONS}`, defaultParams: `mw/brands/${GET_DEFAULT_PARAMS}` }),\r\n    captions: function() {\r\n      const { getPermissions, fields } = this\r\n      if ((getPermissions.module_enabled && getPermissions.permissions.braman) && (getPermissions.module_enabled && getPermissions.permissions.braexe)) {\r\n        return fields\r\n      } else if ((getPermissions.module_enabled && getPermissions.permissions.braman) && (getPermissions.module_enabled && !getPermissions.permissions.braexe)) {\r\n        return fields.filter((f) => f.key !== 'status')\r\n      } else if ((getPermissions.module_enabled && !getPermissions.permissions.braman) && (getPermissions.module_enabled && getPermissions.permissions.braexe)) {\r\n        return fields.filter((f) => f.key !== 'actions' && f.key !== 'progress_today')\r\n      } else {\r\n        return fields.filter((f) => f.key !== 'actions' && f.key !== 'status' && f.key !== 'progress_today')\r\n      }\r\n    },\r\n    capitalize: function() {\r\n      return (str) => str[0].toUpperCase() + str.slice(1)\r\n    },\r\n    params: function() {\r\n      return {...this.defaultParams} || {}\r\n    }\r\n  },\r\n  methods: {\r\n    handleRemoveItems(item) {\r\n      this.dialog.remove = true\r\n      this.selected.remove = {\r\n        id: item.id,\r\n        name: item.name\r\n      }\r\n    },\r\n    paramsChange() {\r\n      this.$emit('paramsChange', this.params)\r\n    },\r\n    sortChange(event) {\r\n      console.log(event)\r\n      this.params.sort_by = event.sortBy\r\n      if (event.sortBy) {\r\n        this.params.sort_dir = event.sortDesc ? 'desc' : 'asc'\r\n      } else {\r\n        this.params.sort_dir = null\r\n      }\r\n      this.paramsChange()\r\n    },\r\n    handleRunItem(item) {\r\n      if (item.marketplaces.amazon_us) {\r\n        this.dialog.run = true\r\n        this.selected.run = item\r\n      }\r\n    }\r\n  },\r\n  filters: {\r\n    formatTime: function(time) {\r\n      return moment(time).format()\r\n    }\r\n  },\r\n  mounted() {\r\n    console.log(this.dataSet, this.params)\r\n  }\r\n}\r\n",{"version":3,"sources":["TableContent.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiNA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TableContent.vue","sourceRoot":"src/components/page/brands","sourcesContent":["<template>\r\n  <b-card :header=\"caption\">\r\n    <template slot=\"header\">\r\n      <p class=\"my-0 pull-left align-middle brand-list-title\">\r\n        <i class=\"icons cui-tags\"></i>\r\n        <strong> {{ caption }}</strong>\r\n      </p>\r\n      <div\r\n        v-if=\"getPermissions.module_enabled && getPermissions.permissions.braman\"\r\n        class=\"pull-right align-middle\"\r\n      >\r\n        <b-button-group>\r\n          <router-link :to=\"{name: 'addBrands'}\" tag=\"button\" class=\"btn btn-primary btn-sm\">\r\n            <i class=\"icons icon-plus\"></i> Add\r\n          </router-link>\r\n        </b-button-group>\r\n      </div>\r\n    </template>\r\n    <b-row>\r\n      <b-col md=\"4\" offset-md=\"4\" class=\"my-0 mb-4\">\r\n        <b-form-group class=\"mb-0\">\r\n          <b-input-group class=\"search cancel-action\">\r\n            <b-form-input\r\n              placeholder=\"Enter report name\"\r\n              ref=\"inputSearch\"\r\n              v-model=\"params.s\"\r\n              @keyup.enter=\"params.page = 1; paramsChange()\"\r\n            ></b-form-input>\r\n            <i v-show=\"params.s\" @click=\"params.s = ''; params.page = 1; paramsChange()\" class=\"icon-close cancel-icon\"></i>\r\n            <b-input-group-append>\r\n              <b-button @click=\"params.page = 1; paramsChange()\">\r\n                <i class=\"icons icon-magnifier\"></i>\r\n              </b-button>\r\n            </b-input-group-append>\r\n          </b-input-group>\r\n        </b-form-group>\r\n      </b-col>\r\n    </b-row>\r\n    <b-table\r\n      :dark=\"dark\"\r\n      :hover=\"hover\"\r\n      :striped=\"striped\"\r\n      :bordered=\"bordered\"\r\n      :small=\"small\"\r\n      outlined\r\n      responsive=\"sm\"\r\n      :items=\"dataSet.items\"\r\n      :fields=\"captions\"\r\n      show-empty\r\n      thead-class=\"thead-light\"\r\n      :no-local-sorting=\"true\"\r\n      @sort-changed=\"sortChange($event)\"\r\n    >\r\n      <template slot=\"empty\">\r\n        <div class=\"empty\">There is no data</div>\r\n      </template>\r\n      <template slot=\"name_in_dashboard\" slot-scope=\"data\">\r\n        <p class=\"mb-0\">{{data.item.name_in_dashboard}}</p>\r\n        <p v-show=\"data.item.name\" class=\"mb-0 small\">Brand: {{data.item.name}}</p>\r\n        <p v-show=\"data.item.name_google_shopping && data.item.name !== data.item.name_google_shopping\" class=\"mb-0 small\">Google Shopping: {{data.item.name_google_shopping}}</p>\r\n      </template>\r\n      <template slot=\"marketplaces\" slot-scope=\"data\">\r\n        <ul class=\"ml-0 pl-4 mb-0\">\r\n          <li v-if=\"data.item.marketplaces && data.item.marketplaces.amazon_us\">Amazon</li>\r\n          <li\r\n            v-if=\"data.item.marketplaces && data.item.marketplaces.google_shopping\"\r\n          >Google Shopping</li>\r\n        </ul>\r\n      </template>\r\n      <template slot=\"active\" slot-scope=\"row\">\r\n        <b-form-checkbox v-model=\"row.item.active\" :disabled=\"true\" switch></b-form-checkbox>\r\n      </template>\r\n      <template slot=\"updated\" slot-scope=\"row\">\r\n        <div class=\"d-flex flex-column d-flex justify-content-center\">\r\n          <span>{{row.item.updated | formatTime | moment('from')}}</span>\r\n        </div>\r\n      </template>\r\n      <template\r\n        slot=\"actions\"\r\n        slot-scope=\"row\"\r\n        v-if=\"getPermissions.module_enabled && getPermissions.permissions.braman\"\r\n      >\r\n        <b-button-group class=\"d-flex flex-row\">\r\n          <b-button :disabled=\"row.item.last_job.status === 'running'\" variant=\"primary\" size=\"sm\" @click=\"handleEditBrand(row.item)\">\r\n            <i class=\"icon-note\"></i> Edit\r\n          </b-button>\r\n          <b-button :disabled=\"row.item.last_job.status === 'running'\" variant=\"danger\" size=\"sm\" @click=\"handleRemoveItems(row.item, row.name)\">\r\n            <i class=\"icon-close\"></i> Remove\r\n          </b-button>\r\n        </b-button-group>\r\n      </template>\r\n      <template slot=\"status\" slot-scope=\"row\">\r\n        <div class=\"d-flex justify-content-between align-items-center\">\r\n          <b-button-group>\r\n            <b-button\r\n              size=\"sm\"\r\n              :variant=\"row.item.active && row.item.last_job.status !== 'running' && row.item.marketplaces.amazon_us ? 'warning':'secondary' \"\r\n              :disabled=\"!row.item.active || row.item.last_job.status === 'running'\r\n              || !getPermissions.module_enabled || !getPermissions.permissions.braexe || !row.item.marketplaces.amazon_us\"\r\n              @click=\"handleRunItem(row.item)\"\r\n            >\r\n              <i class=\"icon-control-play icons\"></i> Run\r\n            </b-button>\r\n          </b-button-group>\r\n          <div class=\"d-flex align-items-center\" v-if=\"row.item.last_job.status === 'running'\">\r\n            <b-spinner small class=\"custom_icon\" style=\"border-width: 1px;\"></b-spinner>\r\n            <span class=\"ml-1 small\">{{row.item.last_job.progress}}%</span>\r\n          </div>\r\n          <div class=\"d-flex align-items-center\" v-else>\r\n            <i class=\"icon-info icons custom_icon\" v-if=\"!row.item.last_job.status\"></i>\r\n            <i\r\n              class=\"icon-check icons rounded-circle bg-success custom_icon\"\r\n              v-if=\"row.item.last_job.status === 'success'\"\r\n            ></i>\r\n            <i\r\n              class=\"icon-close icons text-danger custom_icon\"\r\n              v-if=\"row.item.last_job.status === 'cancelled'\"\r\n            ></i>\r\n            <i\r\n              class=\"icon-ghost icons text-danger custom_icon\"\r\n              v-if=\"row.item.last_job.status === 'dead'\"\r\n            ></i>\r\n            <i\r\n              class=\"fa fa-frown-o text-danger custom_icon\"\r\n              v-if=\"row.item.last_job.status === 'error'\"\r\n            ></i>\r\n            <span class=\"ml-1 small\">\r\n              {{\r\n              !row.item.last_job.status ? 'No report'\r\n              : capitalize(row.item.last_job.status)\r\n              }}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <template slot=\"progress_today\" slot-scope=\"row\">\r\n        <div class=\"small\" v-if=\"typeof(row.item.number_processed_map) === 'number'\">\r\n          {{row.item.number_processed_map}} / {{row.item.number_total_map}}\r\n        </div>\r\n        <div class=\"small\" v-else>\r\n          N/A\r\n        </div>\r\n        <b-button\r\n                size=\"sm\"\r\n                :variant=\"'primary'\"\r\n                @click=\"handleExportForJob(row.item)\"\r\n                :disabled=\"row.item.isLoad\"\r\n                v-if=\"row.item.last_job.status === 'success' && row.item.number_processed_map && row.item.number_processed_map > 0\"\r\n        >\r\n          <i class=\"icon-cloud-download icons\"></i> Download\r\n          <b-spinner v-if=\"row.item.isLoad\" label=\"Spinning\" class=\"icon- btn-loader\"></b-spinner>\r\n        </b-button>\r\n      </template>\r\n    </b-table>\r\n    <nav\r\n      class=\"d-flex justify-content-center\"\r\n      v-if=\"dataSet.total > dataSet.page_size && dataSet.items.length > 0\"\r\n    >\r\n      <b-pagination\r\n        :total-rows=\"dataSet.total\"\r\n        :per-page=\"params.limit\"\r\n        v-model=\"params.page\"\r\n        prev-text=\"Prev\"\r\n        next-text=\"Next\"\r\n        hide-goto-end-buttons\r\n        @change=\"params.page = $event; paramsChange()\"\r\n      />\r\n    </nav>\r\n    <b-modal title=\"Please confirm\" centered v-model=\"dialog.run\" @ok=\"handleRun(selected.run)\">\r\n      Are you sure you want to start running the job to get a report?\r\n      <template slot=\"modal-footer\" slot-scope=\"{ ok, cancel }\">\r\n        <b-button size=\"md\" variant=\"warning\" @click=\"ok()\">\r\n          <i class=\"icon-check icons\"></i> Yes, I understand & confirm!\r\n        </b-button>\r\n        <b-button size=\"md\" variant=\"secondary\" @click=\"cancel()\">\r\n          <i class=\"icon-close icons\"></i> No\r\n        </b-button>\r\n      </template>\r\n    </b-modal>\r\n    <b-modal\r\n      title=\"Please confirm\"\r\n      centered\r\n      v-model=\"dialog.remove\"\r\n      @ok=\"removeBrands(selected.remove)\"\r\n      ok-variant=\"danger\"\r\n    >\r\n      Are you sure you want to delete this report?\r\n      <template slot=\"modal-footer\" slot-scope=\"{ok, cancel}\">\r\n        <b-button variant=\"warning\" @click=\"ok()\">\r\n          <i class=\"icon-check\"></i> Yes, I understand &amp; confirm!\r\n        </b-button>\r\n        <b-button variant @click=\"cancel()\">\r\n          <i class=\"icon-close\"></i> No\r\n        </b-button>\r\n      </template>\r\n    </b-modal>\r\n    <b-modal\r\n      title\r\n      modal-class=\"modal-primary mw-modal-custom\"\r\n      ok-title=\"YES\"\r\n      cancel-title=\"NO\"\r\n      v-model=\"dialog.cancel\"\r\n      @ok=\"handleRun(selected.run)\"\r\n      ok-variant=\"primary\"\r\n    >Are you sure you want to run data processing for this report?</b-modal>\r\n  </b-card>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport { GET_PERMISSIONS, GET_DEFAULT_PARAMS } from '@/actionTypes.js'\r\nimport moment from 'moment'\r\n\r\nexport default {\r\n  name: 'c-table',\r\n  inheritAttrs: false,\r\n  props: {\r\n    caption: {\r\n      type: String,\r\n      default: 'Table'\r\n    },\r\n    hover: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    striped: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    bordered: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    small: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    fixed: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    tableData: {\r\n      type: [Array, Function],\r\n      default: () => []\r\n    },\r\n    fields: {\r\n      type: [Array, Object],\r\n      default: () => []\r\n    },\r\n    dark: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    removeBrands: {\r\n      type: [Function]\r\n    },\r\n    handleEditBrand: {\r\n      type: [Function]\r\n    },\r\n    handleRun: {\r\n      type: [Function]\r\n    },\r\n    totalRows: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    dataSet: {\r\n      type: [Array, Object]\r\n    },\r\n    handleExportForJob: {\r\n      type: [Function]\r\n    }\r\n  },\r\n  data: () => {\r\n    return {\r\n      dialog: {\r\n        remove: false,\r\n        run: false,\r\n        cancel: false\r\n      },\r\n      selected: {\r\n        remove: null,\r\n        run: null\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({ getPermissions: `mw/${GET_PERMISSIONS}`, defaultParams: `mw/brands/${GET_DEFAULT_PARAMS}` }),\r\n    captions: function() {\r\n      const { getPermissions, fields } = this\r\n      if ((getPermissions.module_enabled && getPermissions.permissions.braman) && (getPermissions.module_enabled && getPermissions.permissions.braexe)) {\r\n        return fields\r\n      } else if ((getPermissions.module_enabled && getPermissions.permissions.braman) && (getPermissions.module_enabled && !getPermissions.permissions.braexe)) {\r\n        return fields.filter((f) => f.key !== 'status')\r\n      } else if ((getPermissions.module_enabled && !getPermissions.permissions.braman) && (getPermissions.module_enabled && getPermissions.permissions.braexe)) {\r\n        return fields.filter((f) => f.key !== 'actions' && f.key !== 'progress_today')\r\n      } else {\r\n        return fields.filter((f) => f.key !== 'actions' && f.key !== 'status' && f.key !== 'progress_today')\r\n      }\r\n    },\r\n    capitalize: function() {\r\n      return (str) => str[0].toUpperCase() + str.slice(1)\r\n    },\r\n    params: function() {\r\n      return {...this.defaultParams} || {}\r\n    }\r\n  },\r\n  methods: {\r\n    handleRemoveItems(item) {\r\n      this.dialog.remove = true\r\n      this.selected.remove = {\r\n        id: item.id,\r\n        name: item.name\r\n      }\r\n    },\r\n    paramsChange() {\r\n      this.$emit('paramsChange', this.params)\r\n    },\r\n    sortChange(event) {\r\n      console.log(event)\r\n      this.params.sort_by = event.sortBy\r\n      if (event.sortBy) {\r\n        this.params.sort_dir = event.sortDesc ? 'desc' : 'asc'\r\n      } else {\r\n        this.params.sort_dir = null\r\n      }\r\n      this.paramsChange()\r\n    },\r\n    handleRunItem(item) {\r\n      if (item.marketplaces.amazon_us) {\r\n        this.dialog.run = true\r\n        this.selected.run = item\r\n      }\r\n    }\r\n  },\r\n  filters: {\r\n    formatTime: function(time) {\r\n      return moment(time).format()\r\n    }\r\n  },\r\n  mounted() {\r\n    console.log(this.dataSet, this.params)\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  .brand-list-title{\r\n    position: relative;\r\n    top: 4px;\r\n  }\r\n</style>\r\n"]}]}