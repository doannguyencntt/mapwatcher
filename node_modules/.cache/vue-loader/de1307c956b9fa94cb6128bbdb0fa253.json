{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\sellerEnforcements\\Content.vue?vue&type=style&index=0&id=4521bc3c&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\sellerEnforcements\\Content.vue","mtime":1639556685420},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\index.js","mtime":1620898435762},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1620898436811},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\postcss-loader\\src\\index.js","mtime":1620898436496},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\sass-loader\\lib\\loader.js","mtime":1626076778407},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.map-list-title{\n  position: relative;\n  top: 4px;\n}\n.dropdown-action {\n  margin: 0 !important;\n}\n.max-width-300{\n  max-width: 300px;\n}\n.w-10{\n  width: 10%!important;\n}\nul {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n}\n\nli {\n  float: left;\n}\n\nli a {\n  display: block;\n  color: white;\n  text-align: center;\n  padding: 16px;\n  text-decoration: none;\n}\nol, ul, dl {\n   margin-top: 0px!important;\n   margin-bottom: 0px!important;\n}\n::v-deep .sender-td {\n  max-width: 250px;\n}\n.disabled-icon {\n  pointer-events: none;\n  cursor: not-allowed;\n\n  .fa {\n    color: #6c757d;\n    opacity: 0.5;\n  }\n}\n\n::v-deep .small-dropdown {\n  ul {\n    min-width: 10px!important;\n    li {\n      width: 100%;\n      .dropdown-divider {\n        margin: 0;\n      }\n      .dropdown-item {\n        font-size: 0.76563rem;\n        line-height: 1.5;\n        padding: 8px 20px;\n      }\n    }\n  }\n}\n.drp-actions ::v-deep {\n  .dropdown-menu {\n    min-width: 50%;\n    height: auto;\n    .cls-icon-trash {\n      color: #DC3545;\n      margin-right: 5px;\n    }\n    .dropdown-item {\n      padding: 6px 15px;\n      font-size: 12px;\n    }\n  }\n}\n",{"version":3,"sources":["Content.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAudA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Content.vue","sourceRoot":"src/components/page/sellerEnforcements","sourcesContent":["<template>\r\n  <b-card :header=\"caption\" v-if=\"getPermissions.permissions\">\r\n    <template v-slot:header>\r\n      <p class=\"po-list-title my-0 pull-left align-middle map-list-title\">\r\n        <strong><i class=\"fa fa-user-circle-o\"></i>\r\n        {{ caption }}</strong>\r\n      </p>\r\n      <div v-if=\"getPermissions.module_enabled && getPermissions.permissions.seview && getPermissions.permissions.secreate\" class=\"pull-right align-middle\">\r\n        <b-button-group>\r\n          <router-link :to=\"{ name: 'MWAddSellerEnforcements', params: { client_id: nav.clientId } }\" tag=\"button\" class=\"btn btn-primary btn-sm\">\r\n            <i class=\"icons icon-plus\"></i> Add\r\n          </router-link>\r\n        </b-button-group>\r\n      </div>\r\n    </template>\r\n    <b-row>\r\n      <b-col md=\"4\" offset-md=\"4\" class=\"my-0 mb-4\">\r\n        <b-form-group class=\"mb-0\" v-if=\"getPermissions.permissions.seview\">\r\n          <b-input-group class=\"search cancel-action\">\r\n            <b-form-input\r\n                    placeholder=\"Enter seller name\"\r\n                    ref=\"inputSearch\"\r\n                    v-model.trim=\"params.s\"\r\n                    @keyup.enter=\"\r\n                params.page = 1\r\n                paramsChange()\r\n              \"\r\n            ></b-form-input>\r\n            <i\r\n                    v-show=\"params.s\"\r\n                    @click=\"\r\n                params.s = ''\r\n                params.page = 1\r\n                paramsChange()\r\n              \"\r\n                    class=\"icon-close cancel-icon\"\r\n            ></i>\r\n            <b-input-group-append>\r\n              <b-button\r\n                      @click=\"\r\n                  params.page = 1\r\n                  paramsChange()\r\n                \"\r\n              >\r\n                <i class=\"icons icon-magnifier\"></i>\r\n              </b-button>\r\n            </b-input-group-append>\r\n          </b-input-group>\r\n        </b-form-group>\r\n      </b-col>\r\n    </b-row>\r\n    <b-table\r\n      :dark=\"dark\"\r\n      :hover=\"hover\"\r\n      striped\r\n      :small=\"small\"\r\n      outlined\r\n      responsive=\"sm\"\r\n      thead-class=\"thead-light text-nowrap\"\r\n      :items=\"getItems\"\r\n      :fields=\"captions\"\r\n      show-empty\r\n      class=\"overflow-auto\"\r\n      :class=\"'text-left'\"\r\n    >\r\n      <template v-slot:empty>\r\n        <LoadingSpinner :isLoading=\"sellerEnforcementLoading\" v-if=\"sellerEnforcementLoading\"/>\r\n        <div class=\"align-middle d-flex justify-content-center align-items-center\" v-else>No Sellers</div>\r\n      </template>\r\n      <template v-slot:cell(name)=\"data\">\r\n        <div>\r\n          {{ data.item.name }}\r\n        </div>\r\n      </template>\r\n      <template v-slot:cell(letter)=\"data\">\r\n        <button class=\"btn btn-primary btn-sm\" @click=\"handleEditLetter(data.item)\" :disabled=\"!getPermissions.module_enabled || !getPermissions.permissions.seedit\"><i class=\"fa fa-envelope\" aria-hidden=\"true\"></i><span class=\"ml-1\">Edit</span></button>\r\n      </template>\r\n      <template v-slot:cell(log)=\"data\">\r\n        <button v-if=\"getPermissions.module_enabled && getPermissions.permissions.seview\" class=\"btn btn-primary btn-sm\" @click=\"handleGotoHistories(data.item)\"><i class=\"fa fa-history\" aria-hidden=\"true\"></i><span class=\"ml-1\">View</span></button>\r\n      </template>\r\n      <template v-slot:cell(frequency)=\"data\">\r\n        <button v-if=\"getPermissions.module_enabled && getPermissions.permissions.seview && data.item.frequency === 'daily'\" @click=\"handleChangeFrequency(data.item)\" class=\"btn btn-primary btn-sm\" :disabled=\"!getPermissions.permissions.seedit\">Daily</button>\r\n        <button v-if=\"getPermissions.module_enabled && getPermissions.permissions.seview && data.item.frequency === 'manual'\" class=\"btn bg-secondary btn-sm\" @click=\"handleChangeFrequency(data.item)\" :disabled=\"!getPermissions.permissions.seedit\">Manual</button>\r\n        <a href=\"javascript:void(0);\" v-if=\"getPermissions.module_enabled && getPermissions.permissions.seview\" @click=\"handleSendMail(data.item)\" :class=\"{'disabled-icon': !getPermissions.permissions.sesend}\"><i class=\"fa fa-paper-plane pl-1\"></i></a>\r\n      </template>\r\n      <template v-slot:cell(sender)=\"data\">\r\n        <div v-if=\"data.item.sender_name || data.item.sender_email\" class=\"text-truncate\" :id=\"`sender-${data.item.name}`\">\r\n          <strong v-if=\"data.item.sender_name\">{{ data.item.sender_name }} </strong>\r\n          <span v-if=\"data.item.sender_email\">&lt;{{ data.item.sender_email }}&gt;</span>\r\n        </div>\r\n        <div v-else>\r\n          <b-badge variant=\"secondary\">empty</b-badge>\r\n        </div>\r\n        <b-popover\r\n          :target=\"`sender-${data.item.name}`\"\r\n          triggers=\"hover\"\r\n          placement=\"top\"\r\n          v-if=\"data.item.sender_email\"\r\n        >\r\n          <template v-slot:title>Email</template>\r\n          <div>\r\n            <a href=\"javascript:void(0);\"><i class=\"fa fa-envelope\" /></a>\r\n            {{ data.item.sender_email }}\r\n          </div>\r\n        </b-popover>\r\n      </template>\r\n      <template v-slot:cell(contacts)=\"data\">\r\n        <button v-if=\"getPermissions.module_enabled && getPermissions.permissions.seview\" @click=\"handleGotoEditContacts(data.item)\" class=\"btn btn-primary btn-sm text-nowrap\">({{data.item.contacts.length}}) <i class=\"fa fa-user-o\" aria-hidden=\"true\"></i><span class=\"ml-1\">View</span></button>\r\n      </template>\r\n      <template v-slot:cell(actions)=\"data\">\r\n        <!-- <b-dropdown variant=\"primary\" class=\"mr-1 small-dropdown\" size=\"sm\"\r\n          :disabled=\"!getPermissions.module_enabled || (!getPermissions.permissions.seedit && !getPermissions.permissions.sedelete)\">\r\n          <template v-slot:button-content>\r\n            <i class=\"icon-settings\"></i> Manage\r\n          </template>\r\n          <b-dropdown-item-button\r\n            v-if=\"getPermissions.permissions.seedit\"\r\n            @click=\"handleEditItem(data.item)\"\r\n          >\r\n            <i class=\"icon-note text-primary\"></i> Edit\r\n          </b-dropdown-item-button>\r\n          <b-dropdown-divider></b-dropdown-divider>\r\n          <b-dropdown-item-button\r\n            v-if=\"getPermissions.permissions.sedelete\"\r\n            @click=\"handleRemoveItem(data.item)\"\r\n          >\r\n            <i class=\"icon-close text-danger\"></i> Delete\r\n          </b-dropdown-item-button>\r\n        </b-dropdown> -->\r\n        <b-dropdown v-if=\"getPermissions.permissions.seedit\" variant=\"primary\" size=\"sm\" split text=\"Edit\" @click=\"handleEditItem(data.item)\" class=\"drp-actions\" :disabled=\"!getPermissions.module_enabled || (!getPermissions.permissions.seedit && !getPermissions.permissions.sedelete)\">\r\n          <b-dropdown-item v-if=\"getPermissions.permissions.sedelete\" variant=\"danger\" @click=\"handleRemoveItem(data.item)\">\r\n            <i class=\"icon-trash cls-icon-trash\"></i>Remove\r\n          </b-dropdown-item>\r\n        </b-dropdown>\r\n      </template>\r\n    </b-table>\r\n    <b-modal hide-footer size=\"lg\" title=\"Edit Email Template\" centered v-model=\"dialog.letter\" ok-variant=\"danger\">\r\n      <b-row>\r\n        <b-col md=\"2\">\r\n          <div>Send To </div>\r\n        </b-col>\r\n        <b-col md=\"10\" >\r\n          <b-col class=\"border\" v-if=\"selected.item && selected.item.contacts && selected.item.contacts.length > 0\">\r\n            <ul>\r\n              <li v-for=\"(item, _i) in selected.item.contacts\" v-bind:key=\"_i\">\r\n                {{item.contact_name}} &lt;{{item.email}}&gt; <div class=\"d-inline mr-1\" v-if=\"_i < (selected.item.contacts.length - 1)\">, </div>\r\n              </li>\r\n            </ul>\r\n          </b-col>\r\n        </b-col>\r\n      </b-row>\r\n      <br>\r\n      <b-row>\r\n        <b-col md=\"2\">\r\n          <div>Email Body </div>\r\n        </b-col>\r\n        <b-col md=\"10\">\r\n          <vue-editor :editorToolbar=\"vueEditorCustomToolbar\" v-model=\"selected.letter.body\"></vue-editor>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row class=\"mt-3\">\r\n        <b-col md=\"2\">\r\n        </b-col>\r\n        <b-col md=\"5\">\r\n          <b-form-checkbox v-model=\"selected.letter.include_document\" class=\"mb-2 basicText font-weight-bold\" switch>Include MAP Pricing Policy Document</b-form-checkbox>\r\n        </b-col>\r\n        <b-col md=\"5\" class=\"text-right\">\r\n          <b-button variant=\"warning\" @click=\"handleUpdateLetter()\"> <i class=\"icon-check\"></i> Save</b-button>\r\n        </b-col>\r\n      </b-row>\r\n    </b-modal>\r\n    <b-modal title=\"Please confirm\" centered v-model=\"dialog.switch\" @ok=\"changeFrequencyMode()\" ok-variant=\"danger\">\r\n      Are you sure you want to change Frequency Mode of this seller?\r\n      <template v-slot:modal-footer=\"{ ok, cancel }\">\r\n        <b-button variant=\"warning\" @click=\"ok()\"> <i class=\"icon-check\"></i> Yes, I understand &amp; confirm! </b-button>\r\n        <b-button variant @click=\"cancel()\"> <i class=\"icon-close\"></i> No </b-button>\r\n      </template>\r\n    </b-modal>\r\n    <b-modal title=\"Please confirm\" centered v-model=\"dialog.remove\" @ok=\"removeItem()\" ok-variant=\"danger\">\r\n      Are you sure you want to delete this seller?\r\n      <template v-slot:modal-footer=\"{ ok, cancel }\">\r\n        <b-button variant=\"warning\" @click=\"ok()\"> <i class=\"icon-check\"></i> Yes, I understand &amp; confirm! </b-button>\r\n        <b-button variant @click=\"cancel()\"> <i class=\"icon-close\"></i> No </b-button>\r\n      </template>\r\n    </b-modal>\r\n    <b-modal hide-header centered v-model=\"dialog.update_sender\">\r\n      <strong class=\"d-block my-2\">Please update sender first to send the email.</strong>\r\n      <template v-slot:modal-footer=\"{ cancel }\">\r\n        <b-button variant=\"primary\" @click=\"cancel()\"> <i class=\"icon-check\"></i> OK </b-button>\r\n      </template>\r\n    </b-modal>\r\n    <b-modal title=\"Please confirm\" centered v-model=\"dialog.send_mail\" @ok=\"handleManualSendMail()\" ok-variant=\"danger\">\r\n      Are you sure you want to send violation report to this contact list:\r\n      <div v-if=\"selected.item && selected.item.contacts\" class=\"overflow-hidden\">\r\n        <div v-for=\"(item, index) in selected.item.contacts\" v-bind:key=\"index\"  class=\"float-left\" :class=\"index > 0 ? 'ml-1' : ''\">\r\n          {{item.contact_name}} &lt;{{item.email}}&gt;<span v-if=\"index < (selected.send_mail.total_contact - 1)\">, </span></div>\r\n      </div>\r\n      <p v-if=\"selected.item\" class=\"d-block mt-2 mb-0\">With the sender is:&nbsp;\r\n        <strong>{{ selected.item.sender_name || 'Channel Precision' }}</strong>\r\n        <strong>&nbsp;&lt;{{ selected.item.sender_email }}&gt;</strong>\r\n      </p>\r\n      <p v-if=\"selected.item\">Violation date:\r\n        <v-select class=\"w-50 ml-2 mt-2 d-inline-block\" :clearable=\"false\" v-model=\"selected.send_mail.date\" :options=\"selected.history_dates\">\r\n          <span slot=\"no-options\">No violation date.</span>\r\n        </v-select>\r\n      </p>\r\n      <template v-slot:modal-footer=\"{ ok, cancel }\">\r\n        <b-button variant=\"warning\" @click=\"ok()\"> <i class=\"icon-check\"></i> Yes, I understand &amp; confirm! </b-button>\r\n        <b-button variant @click=\"cancel()\"> <i class=\"icon-close\"></i> No </b-button>\r\n      </template>\r\n    </b-modal>\r\n    <nav\r\n      class=\"d-flex justify-content-center\"\r\n      v-if=\"listSellers.total > listSellers.page_size && listSellers.items.length > 0\"\r\n    >\r\n      <b-pagination\r\n              :total-rows=\"listSellers.total\"\r\n              :per-page=\"params.limit\"\r\n              v-model=\"params.page\"\r\n              prev-text=\"Prev\"\r\n              next-text=\"Next\"\r\n              hide-goto-end-buttons\r\n              @change=\"params.page = $event, paramsChange()\"\r\n              hide-ellipsis\r\n      />\r\n    </nav>\r\n  </b-card>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport vToasted from '@/shared/notification'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport _ from 'lodash'\r\nimport _nav from '@/_nav'\r\nimport { SellerEnforcementFrequencyType } from '@/constants/SellerEnforcement'\r\nimport { VueEditor } from 'vue2-editor'\r\nimport vSelect from 'vue-select'\r\nimport moment from 'moment'\r\nimport LoadingSpinner from '@/components/common/LoadingSpinner'\r\n\r\nexport default {\r\n  name: 'c-table',\r\n  inheritAttrs: false,\r\n  mixins: [vToasted],\r\n  props: {\r\n    caption: {\r\n      type: String,\r\n      default: 'Table'\r\n    },\r\n    hover: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    striped: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    bordered: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    small: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    fixed: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    tableData: {\r\n      type: [Array, Function],\r\n      default: () => []\r\n    },\r\n    fields: {\r\n      type: [Array, Object],\r\n      default: () => []\r\n    },\r\n    dark: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    totalRows: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    handleChangePage: {\r\n      type: [Function]\r\n    },\r\n    sellerEnforcementLoading: {\r\n      type: Boolean\r\n    }\r\n  },\r\n  data: () => {\r\n    return {\r\n      sellerEnforcementFrequencyType: _.cloneDeep(SellerEnforcementFrequencyType),\r\n      dialog: {\r\n        remove: false,\r\n        letter: false,\r\n        switch: false,\r\n        update_sender: false,\r\n        send_mail: false\r\n      },\r\n      selected: {\r\n        remove: null,\r\n        switch: null,\r\n        item: null,\r\n        history_dates: [],\r\n        send_mail: {\r\n          total_contact: 0,\r\n          date: null\r\n        },\r\n        letter: {\r\n          body: {},\r\n          include_document: false\r\n        }\r\n      },\r\n      vueEditorCustomToolbar: [\r\n        [ { 'font': [] } ],\r\n        [{ 'header': [ false, 1, 2, 3, 4, 5, 6 ] }],\r\n        [{ 'size': ['small', false, 'large', 'huge'] }],\r\n        ['bold', 'italic', 'underline'],\r\n        [{'align': ''}, {'align': 'center'}, {'align': 'right'}, {'align': 'justify'}],\r\n        [{ 'header': 1 }, { 'header': 2 }],\r\n        [{'list': 'ordered'}, { 'list': 'bullet' }],\r\n        [{'script': 'sub'}, { 'script': 'super' }],\r\n        [{'indent': '-1'}, { 'indent': '+1' }],\r\n        [{ 'color': [] }, { 'background': [] }],\r\n        ['link', 'formula'],\r\n        [{ 'direction': 'rtl' }],\r\n        ['clean']\r\n      ],\r\n      defaultLetterContent: '<p>Dear {{ contact-name }},</p>' +\r\n              '<p>We would like to inform that you have violation .Total number of violation is {{ violation-count }}.</p>' +\r\n              '<p>Please see the attached file.</p>' +\r\n              '<p>Regards,</p>' +\r\n              '<p>Investigate Team</p>',\r\n      nav: _nav\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      getPermissions: `mw/${TYPE.GET_PERMISSIONS}`,\r\n      defaultParams: `mw/sellerEnforcements/${TYPE.GET_DEFAULT_SELLER_ENFORCEMENT_PARAMS}`,\r\n      listSellers: `mw/sellerEnforcements/${TYPE.GET_LIST_SELLER_ENFORCEMENT}`\r\n    }),\r\n    params: function() {\r\n      console.log(this.defaultParams)\r\n      return { ...this.defaultParams } || {}\r\n    },\r\n    getItems: function() {\r\n      return this.listSellers.items\r\n    },\r\n    captions: function() {\r\n      const { fields } = this\r\n      return fields\r\n    }\r\n  },\r\n  components: {\r\n    VueEditor,\r\n    vSelect,\r\n    LoadingSpinner\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      removeSeller: `mw/sellerEnforcements/${TYPE.REMOVE_SELLER_ENFORCEMENT}`,\r\n      changeFrequency: `mw/sellerEnforcements/${TYPE.CHANGE_FREQUENCY_SELLER_ENFORCEMENT}`,\r\n      remoteEditSeller: `mw/sellerEnforcements/${TYPE.REMOTE_EDIT_SELLER_ENFORCEMENT}`,\r\n      manualSendMail: `mw/sellerEnforcements/${TYPE.REMOTE_MANUAL_SEND_MAIL_SELLER_ENFORCEMENT}`,\r\n      getHistoryDates: `mw/sellerEnforcements/${TYPE.GET_SELLER_ENFORCEMENT_HISTORY_DATES}`\r\n    }),\r\n    paramsChange() {\r\n      this.$emit('paramsChange', this.params)\r\n    },\r\n    handleEditItem(seller) {\r\n      this.$router.push({ name: 'MWEditSellerEnforcements', params: { client_id: this.nav.clientId, id: seller.id }, query: { seller: seller } })\r\n    },\r\n    async handleManualSendMail() {\r\n      const { id, contacts, name } = this.selected.item\r\n      if (_.isEmpty(contacts)) {\r\n        return this.vToasted('error', `${name} seller has empty contact list.`)\r\n      }\r\n      try {\r\n        await this.manualSendMail({ id: id, date: this.selected.send_mail.date })\r\n        this.vToasted('success', `${name} seller's violations on ${this.selected.send_mail.date} have been successfully sent to all contacts.`)\r\n        this.dialog.send_mail = false\r\n      } catch (e) {\r\n        this.vToasted('error', e.message)\r\n      }\r\n    },\r\n    handleRemoveItem(item) {\r\n      this.dialog.remove = true\r\n      this.selected.remove = {\r\n        id: item.id,\r\n        name: item.name\r\n      }\r\n    },\r\n    async handleUpdateLetter() {\r\n      try {\r\n        const { name } = this.selected.item\r\n        const { id } = this.selected.item\r\n        await this.remoteEditSeller({ params: { letter: this.selected.letter }, id })\r\n        this.vToasted('success', `Letter of seller ${name} has been updated successfully.`)\r\n        this.paramsChange()\r\n        this.dialog.letter = false\r\n      } catch (error) {\r\n        this.vToasted('error', error.data.message)\r\n      }\r\n    },\r\n    handleEditLetter(item) {\r\n      this.selected.item = item\r\n      if (!_.isEmpty(item.letter.body)) {\r\n        this.selected.letter.body = item.letter.body\r\n      } else {\r\n        this.selected.letter.body = this.defaultLetterContent\r\n      }\r\n      this.selected.letter.include_document = item.letter.include_document\r\n      this.dialog.letter = true\r\n    },\r\n    handleChangeFrequency(seller) {\r\n      this.dialog.switch = true\r\n      this.selected.switch = {\r\n        id: seller.id,\r\n        frequency: seller.frequency,\r\n        name: seller.name\r\n      }\r\n    },\r\n    handleGotoEditContacts(seller) {\r\n      const { id } = seller\r\n      this.$router.push({ name: 'MWSellerEnforcementContacts', params: { client_id: this.nav.clientId, id: id } })\r\n    },\r\n    async handleSendMail(seller) {\r\n      if (seller.sender_email) {\r\n        this.selected.item = seller\r\n        this.selected.send_mail.total_contact = _.size(seller.contacts)\r\n        this.dialog.send_mail = true\r\n        const histories = await this.getHistoryDates(seller.id)\r\n        this.selected.history_dates = _.map(histories, (history) => moment(history.date_string, 'YYYYMMDD').format('MM-DD-YYYY'))\r\n        if (!_.isEmpty(this.selected.history_dates)) {\r\n          this.selected.send_mail.date = this.selected.history_dates[0]\r\n        } else {\r\n          this.selected.send_mail.date = moment().format('MM-DD-YYYY')\r\n        }\r\n      } else {\r\n        this.dialog.update_sender = true\r\n      }\r\n    },\r\n    handleGotoHistories(seller) {\r\n      const { id } = seller\r\n      this.$router.push({ name: 'MWSellerEnforcementHistories', params: { client_id: this.nav.clientId, id: id } })\r\n    },\r\n    changeFrequencyMode() {\r\n      const { id, frequency, name } = this.selected.switch\r\n      const updatedFrequency = frequency === this.sellerEnforcementFrequencyType.MANUAL ? this.sellerEnforcementFrequencyType.DAILY : this.sellerEnforcementFrequencyType.MANUAL\r\n      this.changeFrequency({ id: id, frequency: updatedFrequency })\r\n      this.vToasted('success', `Seller ${name} has been change frequency mode to ${updatedFrequency} successfully`)\r\n    },\r\n    async removeItem() {\r\n      try {\r\n        const id = this.selected.remove.id\r\n        await this.removeSeller(id)\r\n        this.vToasted('success', `Seller ${this.selected.remove.name} has been deleted successfully`)\r\n      } catch (error) {\r\n        this.vToasted('error', error.data.message)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .map-list-title{\r\n    position: relative;\r\n    top: 4px;\r\n  }\r\n  .dropdown-action {\r\n    margin: 0 !important;\r\n  }\r\n  .max-width-300{\r\n    max-width: 300px;\r\n  }\r\n  .w-10{\r\n    width: 10%!important;\r\n  }\r\n  ul {\r\n    list-style-type: none;\r\n    margin: 0;\r\n    padding: 0;\r\n    overflow: hidden;\r\n  }\r\n\r\n  li {\r\n    float: left;\r\n  }\r\n\r\n  li a {\r\n    display: block;\r\n    color: white;\r\n    text-align: center;\r\n    padding: 16px;\r\n    text-decoration: none;\r\n  }\r\n  ol, ul, dl {\r\n     margin-top: 0px!important;\r\n     margin-bottom: 0px!important;\r\n  }\r\n  ::v-deep .sender-td {\r\n    max-width: 250px;\r\n  }\r\n  .disabled-icon {\r\n    pointer-events: none;\r\n    cursor: not-allowed;\r\n\r\n    .fa {\r\n      color: #6c757d;\r\n      opacity: 0.5;\r\n    }\r\n  }\r\n\r\n  ::v-deep .small-dropdown {\r\n    ul {\r\n      min-width: 10px!important;\r\n      li {\r\n        width: 100%;\r\n        .dropdown-divider {\r\n          margin: 0;\r\n        }\r\n        .dropdown-item {\r\n          font-size: 0.76563rem;\r\n          line-height: 1.5;\r\n          padding: 8px 20px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .drp-actions ::v-deep {\r\n    .dropdown-menu {\r\n      min-width: 50%;\r\n      height: auto;\r\n      .cls-icon-trash {\r\n        color: #DC3545;\r\n        margin-right: 5px;\r\n      }\r\n      .dropdown-item {\r\n        padding: 6px 15px;\r\n        font-size: 12px;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n"]}]}