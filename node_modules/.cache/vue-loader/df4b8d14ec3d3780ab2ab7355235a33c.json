{"remainingRequest":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\reports\\ReportMarketplacePicker.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Project\\CBPO\\plat-mw-web\\src\\components\\page\\reports\\ReportMarketplacePicker.vue","mtime":1639556629293},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1620898435163},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626076743241},{"path":"C:\\Project\\CBPO\\plat-mw-web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1620898436811}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport _ from 'lodash'\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport vToasted from '@/shared/notification'\r\nimport VueTagsInput from '@johmun/vue-tags-input'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport * as moment from 'moment/moment'\r\nimport { MarketPlacesResult } from '@/constants/Report'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport PermissionsMixin from '@/components/common/PermissionsMixin'\r\n\r\nexport default {\r\n  name: 'MWReportMarketplacePicker',\r\n  data() {\r\n    return {\r\n      MarketPlacesResult,\r\n      listUniqGoogleShoppingMarketplace: [],\r\n      fields: [\r\n        // A column that needs custom formatting\r\n        { key: 'marketplace', label: 'Marketplace' },\r\n        { key: 'file_in_use', label: 'File in Use' },\r\n        { key: 'date_started', label: 'Date Started' },\r\n        { key: 'all_seller_mode', label: 'All Seller Mode' },\r\n        { key: 'action', label: '' }\r\n      ],\r\n      allSellerModeOptions: [\r\n        { value: 'none', text: 'None' },\r\n        { value: 'authorized_only', text: 'Authorized Only' },\r\n        { value: 'rogue_only', text: 'Rogue Only' },\r\n        { value: 'both', text: 'Both' }\r\n      ],\r\n      marketplaces: {\r\n        amazon_com: false,\r\n        amazon_ca: false,\r\n        amazon_co_uk: false,\r\n        amazon_de: false,\r\n        amazon_fr: false,\r\n        amazon_it: false,\r\n        amazon_es: false,\r\n        amazon_nl: false,\r\n        amazon_co_jp: false,\r\n        amazon_in: false,\r\n        amazon_com_au: false,\r\n        amazon_sg: false,\r\n        amazon_ae: false,\r\n        amazon_com_tr: false,\r\n        amazon_com_mx: false,\r\n        amazon_com_br: false,\r\n        google_shopping: false\r\n      },\r\n      marketplaceItems: [],\r\n      removedMarketplace: [],\r\n      parsedData: {}\r\n    }\r\n  },\r\n  mixins: [vToasted, PermissionsMixin],\r\n  props: {\r\n    reportDoc: Object,\r\n    isValidMarketplace: Boolean\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      planConfig: `mw/${TYPE.GET_PLAN_CONFIG}`\r\n    }),\r\n    listUniqAmazonMarketplace() {\r\n      if (_.isEmpty(this.planConfig)) return []\r\n      let listAmazon = this.planConfig.allowed_amazon_marketplaces.map(item => {\r\n        return {\r\n          value: item,\r\n          text: _.upperFirst(item)\r\n        }\r\n      })\r\n      return _.sortBy(listAmazon, ['value'])\r\n    },\r\n    listUniqAllMarketplace() {\r\n      return _.concat(this.listUniqAmazonMarketplace, this.listUniqGoogleShoppingMarketplace)\r\n    },\r\n    amazonMarketPlaceList() {\r\n      return this.listUniqAmazonMarketplace.filter(\r\n        (item) =>\r\n          !this.marketplaceItems.find(\r\n            (mkItem) => mkItem.marketplace.value === item.value\r\n          )\r\n      )\r\n    },\r\n    googleShoppingMarketplaceList() {\r\n      return this.listUniqGoogleShoppingMarketplace.filter(\r\n        (item) =>\r\n          !this.marketplaceItems.find(\r\n            (mkItem) => mkItem.marketplace.value === item.value\r\n          )\r\n      )\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions({}),\r\n    /* eslint-disable */\r\n    insertMarketplace(marketplace) {\r\n      const alreadyExist = _.find(this.marketplaceItems, function (o) {\r\n        return o.marketplace.value === marketplace\r\n      })\r\n      if (!alreadyExist) {\r\n        const marketplaceDoc = _.find(this.listUniqAllMarketplace, {\r\n          value: marketplace\r\n        })\r\n        this.marketplaceItems.push({\r\n          marketplace: marketplaceDoc,\r\n          file_in_use: '',\r\n          date_started: '',\r\n          all_seller_mode: 'none',\r\n          action: false\r\n        })\r\n      }\r\n      this.autoEnableWhenSelectMarketplace(marketplace, true)\r\n    },\r\n    autoEnableWhenSelectMarketplace(marketplace, action) {\r\n      this.marketplaces[marketplace.replace(/[.]/g, '_')] = action\r\n    },\r\n    buildMarketplaceInfo(fileInUse, dateStarted, all_seller_mode) {\r\n      return {\r\n        file_in_use: fileInUse,\r\n        date_started: dateStarted\r\n          ? moment(dateStarted).format('MM/DD/YYYY')\r\n          : '',\r\n        all_seller_mode: all_seller_mode\r\n      }\r\n    },\r\n    removeMarketplace(marketplace) {\r\n      this.marketplaceItems = _.remove(this.marketplaceItems, function (o) {\r\n        return o.marketplace.value !== marketplace\r\n      })\r\n      this.autoEnableWhenSelectMarketplace(marketplace, false)\r\n    },\r\n    isAmazonMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'amazon')\r\n    },\r\n    getMarketplaceField(marketplace) {\r\n      return `marketplace_${marketplace.replace(/[.]/g, '_')}`\r\n    },\r\n    convertMarketplaceKeyToField(marketplace) {\r\n      return marketplace.replace(/[_]/g, '.')\r\n    },\r\n    findMarketplaceFromListUnique(marketplace) {\r\n      return _.find(this.listUniqAllMarketplace, (data) => {\r\n        if (this.isAmazonMarketplace(marketplace)) {\r\n          return data.value === this.convertMarketplaceKeyToField(marketplace)\r\n        } else if (this.isGoogleShoppingMarketplace(marketplace)) {\r\n          return data.value === MarketPlacesResult.GOOGLE_SHOPPING\r\n        }\r\n      })\r\n    },\r\n    isAmazonMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'amazon')\r\n    },\r\n    isGoogleShoppingMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'google')\r\n    },\r\n    syncMarketplaceItems(doc) {\r\n      if (!doc.marketplaces) {\r\n        return\r\n      }\r\n      const marketplaceKeys = _.keys(doc.marketplaces)\r\n      const values = _.values(MarketPlacesResult)\r\n      _.forEach(marketplaceKeys, (marketplaceKey) => {\r\n        const marketplaceField = _.includes(marketplaceKey, 'amazon')\r\n          ? this.convertMarketplaceKeyToField(marketplaceKey)\r\n          : marketplaceKey\r\n        if (\r\n          doc.marketplaces[marketplaceKey] &&\r\n          _.includes(values, marketplaceField)\r\n        ) {\r\n          this.marketplaces[marketplaceKey] = true\r\n          const marketplaceField = this.getMarketplaceField(marketplaceKey)\r\n          const marketplaceInfo = doc[marketplaceField]\r\n          if (marketplaceInfo) {\r\n            const {\r\n              file_in_use,\r\n              date_started,\r\n              all_seller_mode\r\n            } = marketplaceInfo\r\n            this.marketplaceItems.push({\r\n              marketplace: this.findMarketplaceFromListUnique(marketplaceKey),\r\n              file_in_use: file_in_use,\r\n              date_started: date_started,\r\n              action: '',\r\n              all_seller_mode: all_seller_mode || 'none'\r\n            })\r\n          } else {\r\n            this.marketplaceItems.push({\r\n              marketplace: this.findMarketplaceFromListUnique(marketplaceKey),\r\n              file_in_use: '',\r\n              date_started: '',\r\n              action: '',\r\n              all_seller_mode: all_seller_mode || 'none'\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    convertData() {\r\n      _.forEach(this.marketplaceItems, (marketplaceItem) => {\r\n        const marketplaceInfo = this.getMarketplaceField(\r\n          marketplaceItem.marketplace.value\r\n        )\r\n        const {\r\n          file_in_use,\r\n          date_started,\r\n          all_seller_mode\r\n        } = marketplaceItem\r\n        _.assign(this.parsedData, {\r\n          [marketplaceInfo]: this.buildMarketplaceInfo(\r\n            file_in_use,\r\n            date_started,\r\n            all_seller_mode\r\n          )\r\n        })\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    const marketplaceValues = _.values(MarketPlacesResult)\r\n    _.forEach(marketplaceValues, (marketplaceValue) => {\r\n      if (_.includes(marketplaceValue, 'google')) {\r\n        this.listUniqGoogleShoppingMarketplace.push({\r\n          value: marketplaceValue,\r\n          text: 'Google Shopping'\r\n        })\r\n      }\r\n    })\r\n    if (this.reportDoc) {\r\n      this.syncMarketplaceItems(this.reportDoc)\r\n      // this.$watch('reportDoc', (val) =>\r\n      //   {\r\n      //     this.marketplaceItems = []\r\n      //     this.syncMarketplaceItems(val)\r\n      //   }\r\n      // )\r\n    }\r\n  },\r\n  components: {\r\n    VueTagsInput,\r\n    Datepicker\r\n  },\r\n  watch: {\r\n    marketplaceItems: {\r\n      deep: true,\r\n      handler(val) {\r\n        this.convertData()\r\n        this.$emit('marketplaceChange', {\r\n          parsedData: this.parsedData,\r\n          marketplaces: this.marketplaces\r\n        })\r\n      }\r\n    },\r\n    reportDoc: {\r\n      handler(val) {\r\n        this.marketplaceItems = []\r\n        this.syncMarketplaceItems(val)\r\n      }\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["ReportMarketplacePicker.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReportMarketplacePicker.vue","sourceRoot":"src/components/page/reports","sourcesContent":["<template>\r\n  <b-form-group>\r\n    <b-table\r\n      class=\"table-marketplace\"\r\n      show-empty\r\n      :fields=\"fields\"\r\n      :items=\"marketplaceItems\"\r\n      striped\r\n      bordered\r\n      responsive=\"sm\"\r\n      hover\r\n      collapsed\r\n      fixed\r\n      style=\"overflow: visible !important\"\r\n    >\r\n      <!-- A custom formatted data column cell -->\r\n      <template v-slot:empty>\r\n        <div class=\"text-center\">No Marketplace</div>\r\n      </template>\r\n      <template v-slot:cell(marketplace)=\"row\" class=\"pl-0\">\r\n        <b-form-input\r\n          type=\"text\"\r\n          disabled\r\n          class=\"bg-white\"\r\n          :value=\"row.item.marketplace.text\"\r\n        ></b-form-input>\r\n      </template>\r\n      <template v-slot:cell(file_in_use)=\"row\">\r\n        <b-form-input\r\n          type=\"text\"\r\n          required\r\n          v-model.trim=\"row.item.file_in_use\"\r\n        ></b-form-input>\r\n      </template>\r\n      <template v-slot:cell(date_started)=\"row\" class=\"pr-0\">\r\n        <Datepicker\r\n          v-model=\"row.item.date_started\"\r\n          bootstrap-styling\r\n          format=\"MM/dd/yyyy\"\r\n          typeable\r\n          placeholder=\"Select a date\"\r\n        >\r\n        </Datepicker>\r\n      </template>\r\n      <template v-slot:cell(all_seller_mode)=\"row\" class=\"pr-0\">\r\n        <b-form-select\r\n          v-model=\"row.item.all_seller_mode\"\r\n          :options=\"allSellerModeOptions\"\r\n        ></b-form-select>\r\n      </template>\r\n      <template v-slot:cell(action)=\"row\">\r\n        <b-button\r\n          variant=\"danger\"\r\n          @click=\"removeMarketplace(row.item.marketplace.value)\"\r\n          size=\"md\"\r\n          class=\"white text-center w-auto text-nowrap\"\r\n          ><i class=\"fa fa-minus\"> </i> Remove</b-button\r\n        >\r\n      </template>\r\n    </b-table>\r\n    <div class=\"w-100 add-marketplace p-2 d-flex justify-content-between\">\r\n      <div class=\"mw-error\"  v-if=\"isValidMarketplace && marketplaceItems.length === 0\">\r\n        Please input at least one marketplace\r\n      </div>\r\n      <b-dropdown id=\"dropdown-1\" variant=\"primary\" size=\"md\" class=\"ml-auto\" :disabled=\"amazonMarketPlaceList.length === 0 && googleShoppingMarketplaceList.length === 0\">\r\n        <template v-slot:button-content>\r\n          <i class=\"fa fa-plus\"></i> Add\r\n        </template>\r\n        <template v-if=\"planConfig.allowed_amazon_marketplaces.length || planConfig.plan_max_of_reports_with_amazon > 0\">\r\n          <b-dropdown-item @click=\"insertMarketplace(item.value)\" v-for=\"item in amazonMarketPlaceList\"\r\n            v-bind:key=\"item.value\"\r\n            class=\"mt-2\">\r\n            {{ item.text }}\r\n          </b-dropdown-item>\r\n        </template>\r\n        <b-dropdown-divider v-if=\"planConfig.allowed_amazon_marketplaces.length && planConfig.plan_max_of_reports_with_google_shopping > 0\"></b-dropdown-divider>\r\n        <template v-if=\"planConfig.plan_max_of_reports_with_google_shopping > 0\">\r\n          <b-dropdown-item\r\n            @click=\"insertMarketplace(item.value)\"\r\n            v-for=\"item in googleShoppingMarketplaceList\"\r\n            v-bind:key=\"item.value\"\r\n            class=\"mt-2\">\r\n            {{ item.text }}\r\n          </b-dropdown-item>\r\n        </template>\r\n      </b-dropdown>\r\n    </div>\r\n  </b-form-group>\r\n</template>\r\n<script>\r\nimport _ from 'lodash'\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport vToasted from '@/shared/notification'\r\nimport VueTagsInput from '@johmun/vue-tags-input'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport * as moment from 'moment/moment'\r\nimport { MarketPlacesResult } from '@/constants/Report'\r\nimport * as TYPE from '@/actionTypes.js'\r\nimport PermissionsMixin from '@/components/common/PermissionsMixin'\r\n\r\nexport default {\r\n  name: 'MWReportMarketplacePicker',\r\n  data() {\r\n    return {\r\n      MarketPlacesResult,\r\n      listUniqGoogleShoppingMarketplace: [],\r\n      fields: [\r\n        // A column that needs custom formatting\r\n        { key: 'marketplace', label: 'Marketplace' },\r\n        { key: 'file_in_use', label: 'File in Use' },\r\n        { key: 'date_started', label: 'Date Started' },\r\n        { key: 'all_seller_mode', label: 'All Seller Mode' },\r\n        { key: 'action', label: '' }\r\n      ],\r\n      allSellerModeOptions: [\r\n        { value: 'none', text: 'None' },\r\n        { value: 'authorized_only', text: 'Authorized Only' },\r\n        { value: 'rogue_only', text: 'Rogue Only' },\r\n        { value: 'both', text: 'Both' }\r\n      ],\r\n      marketplaces: {\r\n        amazon_com: false,\r\n        amazon_ca: false,\r\n        amazon_co_uk: false,\r\n        amazon_de: false,\r\n        amazon_fr: false,\r\n        amazon_it: false,\r\n        amazon_es: false,\r\n        amazon_nl: false,\r\n        amazon_co_jp: false,\r\n        amazon_in: false,\r\n        amazon_com_au: false,\r\n        amazon_sg: false,\r\n        amazon_ae: false,\r\n        amazon_com_tr: false,\r\n        amazon_com_mx: false,\r\n        amazon_com_br: false,\r\n        google_shopping: false\r\n      },\r\n      marketplaceItems: [],\r\n      removedMarketplace: [],\r\n      parsedData: {}\r\n    }\r\n  },\r\n  mixins: [vToasted, PermissionsMixin],\r\n  props: {\r\n    reportDoc: Object,\r\n    isValidMarketplace: Boolean\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      planConfig: `mw/${TYPE.GET_PLAN_CONFIG}`\r\n    }),\r\n    listUniqAmazonMarketplace() {\r\n      if (_.isEmpty(this.planConfig)) return []\r\n      let listAmazon = this.planConfig.allowed_amazon_marketplaces.map(item => {\r\n        return {\r\n          value: item,\r\n          text: _.upperFirst(item)\r\n        }\r\n      })\r\n      return _.sortBy(listAmazon, ['value'])\r\n    },\r\n    listUniqAllMarketplace() {\r\n      return _.concat(this.listUniqAmazonMarketplace, this.listUniqGoogleShoppingMarketplace)\r\n    },\r\n    amazonMarketPlaceList() {\r\n      return this.listUniqAmazonMarketplace.filter(\r\n        (item) =>\r\n          !this.marketplaceItems.find(\r\n            (mkItem) => mkItem.marketplace.value === item.value\r\n          )\r\n      )\r\n    },\r\n    googleShoppingMarketplaceList() {\r\n      return this.listUniqGoogleShoppingMarketplace.filter(\r\n        (item) =>\r\n          !this.marketplaceItems.find(\r\n            (mkItem) => mkItem.marketplace.value === item.value\r\n          )\r\n      )\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions({}),\r\n    /* eslint-disable */\r\n    insertMarketplace(marketplace) {\r\n      const alreadyExist = _.find(this.marketplaceItems, function (o) {\r\n        return o.marketplace.value === marketplace\r\n      })\r\n      if (!alreadyExist) {\r\n        const marketplaceDoc = _.find(this.listUniqAllMarketplace, {\r\n          value: marketplace\r\n        })\r\n        this.marketplaceItems.push({\r\n          marketplace: marketplaceDoc,\r\n          file_in_use: '',\r\n          date_started: '',\r\n          all_seller_mode: 'none',\r\n          action: false\r\n        })\r\n      }\r\n      this.autoEnableWhenSelectMarketplace(marketplace, true)\r\n    },\r\n    autoEnableWhenSelectMarketplace(marketplace, action) {\r\n      this.marketplaces[marketplace.replace(/[.]/g, '_')] = action\r\n    },\r\n    buildMarketplaceInfo(fileInUse, dateStarted, all_seller_mode) {\r\n      return {\r\n        file_in_use: fileInUse,\r\n        date_started: dateStarted\r\n          ? moment(dateStarted).format('MM/DD/YYYY')\r\n          : '',\r\n        all_seller_mode: all_seller_mode\r\n      }\r\n    },\r\n    removeMarketplace(marketplace) {\r\n      this.marketplaceItems = _.remove(this.marketplaceItems, function (o) {\r\n        return o.marketplace.value !== marketplace\r\n      })\r\n      this.autoEnableWhenSelectMarketplace(marketplace, false)\r\n    },\r\n    isAmazonMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'amazon')\r\n    },\r\n    getMarketplaceField(marketplace) {\r\n      return `marketplace_${marketplace.replace(/[.]/g, '_')}`\r\n    },\r\n    convertMarketplaceKeyToField(marketplace) {\r\n      return marketplace.replace(/[_]/g, '.')\r\n    },\r\n    findMarketplaceFromListUnique(marketplace) {\r\n      return _.find(this.listUniqAllMarketplace, (data) => {\r\n        if (this.isAmazonMarketplace(marketplace)) {\r\n          return data.value === this.convertMarketplaceKeyToField(marketplace)\r\n        } else if (this.isGoogleShoppingMarketplace(marketplace)) {\r\n          return data.value === MarketPlacesResult.GOOGLE_SHOPPING\r\n        }\r\n      })\r\n    },\r\n    isAmazonMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'amazon')\r\n    },\r\n    isGoogleShoppingMarketplace(marketplace) {\r\n      return _.includes(marketplace, 'google')\r\n    },\r\n    syncMarketplaceItems(doc) {\r\n      if (!doc.marketplaces) {\r\n        return\r\n      }\r\n      const marketplaceKeys = _.keys(doc.marketplaces)\r\n      const values = _.values(MarketPlacesResult)\r\n      _.forEach(marketplaceKeys, (marketplaceKey) => {\r\n        const marketplaceField = _.includes(marketplaceKey, 'amazon')\r\n          ? this.convertMarketplaceKeyToField(marketplaceKey)\r\n          : marketplaceKey\r\n        if (\r\n          doc.marketplaces[marketplaceKey] &&\r\n          _.includes(values, marketplaceField)\r\n        ) {\r\n          this.marketplaces[marketplaceKey] = true\r\n          const marketplaceField = this.getMarketplaceField(marketplaceKey)\r\n          const marketplaceInfo = doc[marketplaceField]\r\n          if (marketplaceInfo) {\r\n            const {\r\n              file_in_use,\r\n              date_started,\r\n              all_seller_mode\r\n            } = marketplaceInfo\r\n            this.marketplaceItems.push({\r\n              marketplace: this.findMarketplaceFromListUnique(marketplaceKey),\r\n              file_in_use: file_in_use,\r\n              date_started: date_started,\r\n              action: '',\r\n              all_seller_mode: all_seller_mode || 'none'\r\n            })\r\n          } else {\r\n            this.marketplaceItems.push({\r\n              marketplace: this.findMarketplaceFromListUnique(marketplaceKey),\r\n              file_in_use: '',\r\n              date_started: '',\r\n              action: '',\r\n              all_seller_mode: all_seller_mode || 'none'\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    convertData() {\r\n      _.forEach(this.marketplaceItems, (marketplaceItem) => {\r\n        const marketplaceInfo = this.getMarketplaceField(\r\n          marketplaceItem.marketplace.value\r\n        )\r\n        const {\r\n          file_in_use,\r\n          date_started,\r\n          all_seller_mode\r\n        } = marketplaceItem\r\n        _.assign(this.parsedData, {\r\n          [marketplaceInfo]: this.buildMarketplaceInfo(\r\n            file_in_use,\r\n            date_started,\r\n            all_seller_mode\r\n          )\r\n        })\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    const marketplaceValues = _.values(MarketPlacesResult)\r\n    _.forEach(marketplaceValues, (marketplaceValue) => {\r\n      if (_.includes(marketplaceValue, 'google')) {\r\n        this.listUniqGoogleShoppingMarketplace.push({\r\n          value: marketplaceValue,\r\n          text: 'Google Shopping'\r\n        })\r\n      }\r\n    })\r\n    if (this.reportDoc) {\r\n      this.syncMarketplaceItems(this.reportDoc)\r\n      // this.$watch('reportDoc', (val) =>\r\n      //   {\r\n      //     this.marketplaceItems = []\r\n      //     this.syncMarketplaceItems(val)\r\n      //   }\r\n      // )\r\n    }\r\n  },\r\n  components: {\r\n    VueTagsInput,\r\n    Datepicker\r\n  },\r\n  watch: {\r\n    marketplaceItems: {\r\n      deep: true,\r\n      handler(val) {\r\n        this.convertData()\r\n        this.$emit('marketplaceChange', {\r\n          parsedData: this.parsedData,\r\n          marketplaces: this.marketplaces\r\n        })\r\n      }\r\n    },\r\n    reportDoc: {\r\n      handler(val) {\r\n        this.marketplaceItems = []\r\n        this.syncMarketplaceItems(val)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.table-marketplace {\r\n  &::v-deep {\r\n    overflow: visible;\r\n    margin-bottom: 0px;\r\n    tbody tr td {\r\n      background: white;\r\n    }\r\n    tbody tr td:nth-child(5) {\r\n      text-align: center;\r\n    }\r\n    tfoot tr {\r\n      th {\r\n        &:not(:last-child) {\r\n          border-right: none !important;\r\n        }\r\n        &:not(:first-child) {\r\n          border-left: none !important;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n::v-deep .add-marketplace {\r\n  text-align: right;\r\n  border: 1px solid #c8ced3;\r\n  border-top: none;\r\n}\r\n::v-deep .vdp-datepicker__calendar {\r\n  position: absolute !important;\r\n}\r\n::v-deep ul {\r\n  max-height: 350px;\r\n  overflow: auto;\r\n}\r\n</style>\r\n"]}]}