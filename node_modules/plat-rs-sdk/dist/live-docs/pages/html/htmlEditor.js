const htmlEditorPage = Vue.component('htmlEditorPage', {
  template: `
  <div class="html-editor-demo">
    <p class="text-description"></p>
    <div id="html-editor-demo"></div>
  </div>
  `,
  data() {
    return {
      template: '<cbpo-element-html-editor :builder="true" config-ref="config"></cbpo-element-html-editor>',
      config: {
        dataSource: 'dataSource',
        builder: {
          enabled: false
        },
        columns: [
          {
            name: 'seller_name'
          },
          {
            name: 'seller_price',
            format: {
              type: 'text',
              common: {
                prefix: '$ '
              }
            }
          }
        ],
        grouping: {
          columns: [{name: 'seller_name'}],
          aggregations: [
            {column: 'sku', alias: 'sku', aggregation: 'count'},
            {column: 'upc/ean', alias: 'upc/ean', aggregation: 'count'},
            {column: 'asin', alias: 'asin', aggregation: 'count'},
            {column: 'title', alias: 'title', aggregation: 'concat'},
            {column: 'seller_price', alias: 'seller_price', aggregation: 'sum'},
            {column: 'map_price', alias: 'map_price', aggregation: 'sum'},
            {column: 'diff', alias: 'diff', aggregation: 'sum'},
            {column: 'diff_percent', alias: 'diff_percent', aggregation: 'avg'},
            {column: 'link', alias: 'link', aggregation: 'count'},
            {column: 'screenshot', alias: 'screenshot', aggregation: 'count'},
            {column: 'captured_at', alias: 'captured_at', aggregation: 'count'},
            {column: 'fba', alias: 'fba', aggregation: 'count'},
            {column: 'prime', alias: 'prime', aggregation: 'count'},
            {column: 'condition', alias: 'condition', aggregation: 'count'},
            {column: 'rating', alias: 'rating', aggregation: 'count'},
            {column: 'growth_value', alias: 'growth_value', aggregation: 'count'}
          ]
        },
        content: `[solidgauge classCss="m-auto" width="300" height="200" current="200" min="0" max="500" value1="150" type_current="numeric" type_min="numeric" type_max="numeric" type_value1="numeric"][/solidgauge]`
      }
    }
  },
  mixins: [configMixins, renderMixins],
  mounted() {
    $('.text-description').html('You can add value of columns into html editor by follow this syntax: {{:column-name}} then toggle builder mode too see value change')
  },
  methods: {
    initSDK(enabled) {
      this.config.builder.enabled = enabled
      window.dataSource = this.dataSource
      window.config = this.config
      this.render('#html-editor-demo', this.template, 'http://ds-api.qa.channelprecision.com/v1/', this.VUE_DEMO_TOKEN)
    }
  },
  watch: {
    enabled: {
      immediate: true,
      handler(val) {
        this.$nextTick(() => {
          this.initSDK(val)
        })
      }
    }
  }
})
