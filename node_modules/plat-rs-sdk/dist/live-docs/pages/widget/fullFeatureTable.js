const sdkFeatureTablePage = Vue.component('sdkFeatureTablePage', {
  template: `
    <div class="full-feature-table-demo">
      <h5>Example: </h5>
      <div id="full-feature-table-demo">
      </div>
      <div class="mt-2">
        <sdk-export-code :templates="getTemplate"/>
      </div>
    </div>
  `,
  data() {
    let dataSource = 'idreportingsdk'
    return {
      dataSource: dataSource,
      baseURL: 'http://ds-api.qa.channelprecision.com/v1/',
      template: '<cbpo-widget class="p-0" config-ref="config"></cbpo-widget>',
      config: {
        widget: {
          title: {
            text: `Last year is [[format expression="DATE_END_OF(DATE_LAST(1,'year'), 'year')" type="temporal" format="YYYY"][/format]] and current is [2020]`,
            enabled: true
          }
        },
        columnManager: {
          enabled: true
        },
        filter: {
          builder: {
            enabled: true,
            readable: {
              enabled: true
            }
          }
        },
        elements: [
          {
            type: 'cbpo-element-table',
            config: {
              dataSource: dataSource,
              widget: {
                title: {
                  enabled: false
                }
              },
              globalControlOptions: {
                aggregation: {
                  enabled: true
                },
                globalGrouping: {
                  enabled: true,
                  config: {
                    value: false
                  }
                },
                grouping: {
                  enabled: true
                },
                editColumn: {
                  enabled: true
                },
                editColumnLabel: {
                  enabled: true
                },
                editColumnFormat: {
                  enabled: true
                },
                editBin: {
                  enabled: true
                }
              },
              rowActions: {
                enabled: true,
                inline: 1, // number of inline item, max inline items are 2, else -> dropdown
                display: 'always', // always | onhover
                position: 'left',
                colWidth: 150,
                controls: [
                  {
                    display: true,
                    props: { size: 'sm', variant: 'primary' },
                    style: {},
                    icon: 'fa-gear',
                    label: 'Action 1',
                    event: function(dataRow) {
                      console.log('action 1', dataRow)
                    }
                  },
                  {
                    display: true,
                    props: { size: 'sm', variant: 'primary' },
                    style: {},
                    icon: 'fa-home',
                    label: 'Action 2',
                    event: function(dataRow) {
                      console.log('action 2', dataRow)
                    }
                  },
                  {
                    display: true,
                    props: { size: 'sm', variant: 'primary' },
                    style: {},
                    icon: 'fa-home',
                    label: 'Action 3',
                    event: function(dataRow) {
                      console.log('action 3', dataRow)
                    }
                  }
                ]
              },
              bulkActions: {
                enabled: true,
                controls: [
                  {
                    display: true,
                    props: { size: 'sm', variant: 'primary' },
                    style: {},
                    icon: 'fa-gear',
                    label: 'Action 1',
                    event: function(dataRow) {
                      console.log('bulk action 1', dataRow)
                    }
                  },
                  {
                    display: true,
                    props: { size: 'sm', variant: 'primary' },
                    style: {},
                    icon: 'fa-home',
                    label: 'Action 3',
                    event: function(dataRow) {
                      console.log('bulk action 3', dataRow)
                    }
                  }
                ]
              },
              pagination: {
                type: 'buttons',
                limit: 10
              }
            }
          }
        ],
        calculatedColumn: {
          enabled: true
        }
      }
    }
  },
  mixins: [configMixins, renderMixins],
  computed: {
    getTemplate() {
      return [
        {
          name: 'Full Features Table',
          tag: this.template,
          config: this.config
        }
      ]
    }
  },
  methods: {
    async initSDK() {
      let columns = await columnService.getColumns(this.baseURL, this.VUE_DEMO_TOKEN, '', { dataSource: this.dataSource })
      this.config.elements[0].config.columns = _.cloneDeep(columns.columns)
      window.config = this.config
      this.render('#full-feature-table-demo', this.template, this.baseURL, this.VUE_DEMO_TOKEN, '')
    }
  },
  mounted() {
    this.initSDK()
  }
})
